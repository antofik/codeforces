
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="11ah0b89edhbc3ea162170045e94ba4e"/>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="http://worker.codeforces.ru/static/images/codeforces-vk-square-ru.png"/>
    <meta property="og:title" content="Задачи - Codeforces"/>
    <meta property="og:site_name" content="Codeforces"/>
    
    <meta name="cc" content="tdc21u1souz6"/>
    
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Задачи - Codeforces</title>
        <meta name="description" content="Codeforces. Соревнования и олимпиады по информатике и программированию, сообщество программистов" />
        <meta name="keywords" content="программирование информатика контест олимпиада алгоритмы c++ java графы vkcup" />
    <meta name="robots" content="index, follow" />

    <link href="http://worker.codeforces.ru/static/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

    <HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--CombineResourcesFilter-->
    
<LINK href="http://worker.codeforces.ru/static/favicon.png" rel="shortcut icon" type="image/png">
    
<LINK href="http://worker.codeforces.ru/static/css/prettify.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/clear.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/style.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/ttypography.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/problem-statement.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/second-level-menu.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/roundbox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/datatable.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/topic.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/table-form.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.jgrowl.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/facebox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.wysiwyg.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/codeforces.datepick.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/colorbox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.drafts.css" rel="stylesheet" type="text/css">
    
<LINK href="http://worker.codeforces.ru/static/markitup/skins/markitup/style.css" rel="stylesheet" type="text/css">
    
<LINK href="http://worker.codeforces.ru/static/markitup/sets/markdown/style.css" rel="stylesheet" type="text/css">

    
<SCRIPT charset="utf-8" src="//yandex.st/share/share.js" type="text/javascript"></SCRIPT>
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/sidebar-menu.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/community.css" rel="stylesheet" type="text/css">

    <!--[if IE]>
        <style>
            #sidebar {
                padding-left: 1em;
                margin: 1em 1em 1em 0;
            }
        </style>
    <![endif]-->
    
    
<SCRIPT src="http://worker.codeforces.ru/static/js/prettify/prettify.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery-1.8.3.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/sockjs-0.2.1.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/vertxbus-1.2.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.easing.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.lavalamp.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.jgrowl.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/facebox.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.wysiwyg.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.colorpicker.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.table.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.image.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.link.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.autocomplete.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.datepick.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.ie6blocker.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.colorbox-min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.ba-bbq.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.drafts.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/codeforces.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/markitup/jquery.markitup.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/markitup/sets/markdown/set.js" type="text/javascript"></SCRIPT>
    <!--/CombineResourcesFilter-->
</HEAD>
</HTML>

        <script type="text/javascript" src="http://worker.codeforces.ru/static/js/jquery.datepick-ru.js"></script>
        <script src="http://vk.com/js/api/openapi.js" type="text/javascript"></script>
</head>
<body><span style='display:none;' class='csrf-token' data-csrf='11ah0b89edhbc3ea162170045e94ba4e'>&nbsp;</span>
<!-- Codeforces javascripts. -->
<script type="text/javascript">
    VK.init({apiId: 1961905});
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>

    <script type="text/javascript">
        $(document).ready(function() {
    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    $(".second-level-menu-list").lavaLamp({
        fx: "backout",
        speed: 1000
    });


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


        });
    </script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<div id="body">
<div style="width: 950px; margin: 0 auto;">
    <div id="header" style="position:relative;">
        <div style="float:left;">
                <a href="/"><img src="http://worker.codeforces.ru/static/images/codeforces-logo-with-upper-beta.png"/></a>
                        <div style="position:absolute;left:97px;top:40px;">
                            <a href="http://vk.com" class="logo-href">При поддержке <img
                                    style="position:relative;top:5px;" src="http://worker.codeforces.ru/static/images/vkontakte-tiny-ru.png"/></a>
                        </div>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="http://worker.codeforces.ru/static/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="http://worker.codeforces.ru/static/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <div style="text-align: center;font-size: 18px;margin-bottom: 0.5em;"
         class="caption">Codeforces Round #165 (Div. 1)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Волшебные ларцы</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Эмускальд — известный иллюзионист. Для своего коронного номера он использует набор волшебных ларцов. Суть фокуса — в том, чтобы поместить ларцы внутрь других ларцов.</p><p>Сверху каждый волшебный ларец выглядит как квадрат со стороной равной <span class="tex-span">2<sup class="upper-index"><i>k</i></sup></span> (<span class="tex-span"><i>k</i></span> — целое, <span class="tex-span"><i>k</i> ≥ 0</span>) единиц. Ларец <span class="tex-span"><i>v</i></span> можно положить в ларец <span class="tex-span"><i>u</i></span>, если длина стороны ларца <span class="tex-span"><i>v</i></span> строго меньше, чем длина стороны ларца <span class="tex-span"><i>u</i></span>. В частности, Эмускальд может положить 4 ларца со сторонами <span class="tex-span">2<sup class="upper-index"><i>k</i> - 1</sup></span> в один ларец со стороной <span class="tex-span">2<sup class="upper-index"><i>k</i></sup></span>. Вид вложенных друг в друга ларцов показан на следующем рисунке:</p><p><center> <img class="tex-graphics" src="http://codeforces.ru/renderer/358c80356b9bc14fd41ba3beba8de2765097c7a1.png" /> </center></p><p>Эмускальд собирается в мировое турне. Ему надо упаковать свои волшебные ларцы для путешествия. Он решил, что лучше всего будет уложить их все в другой ларец, но мастерить волшебные ларцы достаточно дорого. Помогите ему найти наименьший волшебный ларец, в который можно поместить все его ларцы.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>Первая строка входных данных содержит целое число <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup></span>), количество различных размеров ларцов в распоряжении Эмускальда. В следующих <span class="tex-span"><i>n</i></span> строках записано по два целых числа <span class="tex-span"><i>k</i><sub class="lower-index"><i>i</i></sub></span> и <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">0 ≤ <i>k</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>, <span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>), что означает, что у Эмускальда есть <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> ларцов со стороной <span class="tex-span">2<sup class="upper-index"><i>k</i><sub class="lower-index"><i>i</i></sub></sup></span>. Гарантируется, что все <span class="tex-span"><i>k</i><sub class="lower-index"><i>i</i></sub></span> различны.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите единственное целое число <span class="tex-span"><i>p</i></span>, такое что длина стороны наименьшего ларца, который может вместить в себя все ларцы Эмускальда, равна <span class="tex-span">2<sup class="upper-index"><i>p</i></sup></span>.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>2<br />0 3<br />1 5<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>3<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>1<br />0 4<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>1<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>2<br />1 10<br />2 2<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>3<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p><span class="tex-font-style-bf">Пояснение рисунка</span>. Если у нас есть 3 ларца со стороной 2 и 5 ларцов со стороной 1, то мы можем уместить их все в ларце со стороной 4, например, так, как показано на рисунке.</p><p>Во втором примере мы можем уложить все четыре маленьких ларца в ларец со стороной 2.</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Теплица</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Эмускальд — страстный садовод. В его владении находится самая длинная теплица в мире — ее длина практически бесконечна.</p><p>За многие годы Эмускальд вырастил <span class="tex-span"><i>n</i></span> растений в своей теплице, каждое растение принадлежит одному из <span class="tex-span"><i>m</i></span> различных видов, пронумерованных от 1 до <span class="tex-span"><i>m</i></span>. Теплица Эмускальда очень узкая и ее можно рассматривать как бесконечную прямую, где каждое растение занимает одну точку на этой прямой.</p><p>Эмускальд обнаружил, что для каждого вида растений есть своя оптимальная температура. Теперь юноша хочет расставить <span class="tex-span"><i>m</i> - 1</span> заслонок, которые разделили бы теплицу на <span class="tex-span"><i>m</i></span> отделений, пронумерованных от 1 до <span class="tex-span"><i>m</i></span> слева направо, так чтобы в каждом отделении росли все растения одного конкретного вида. Он может ставить заслонки так, как хочет, но в итоге каждое растение <span class="tex-span"><i>i</i></span>-го вида должно произрастать в <span class="tex-span"><i>i</i></span>-ом слева отделении теплицы.</p><p>Конечно, не всегда возможно расставить заслонки именно так, и Эмускальду придется пересадить некоторые свои растения. Он может пересадить каждое растение с изначального места в любое место в теплице (в <span class="tex-font-style-bf">любой</span> вещественной координате), если там еще нет другого растения. Так как пересадка неблагоприятно сказывается на растениях, помогите Эмускальду найти минимальное количество растений, которое он должен пересадить, чтобы расставить заслонки требуемым образом.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке входных данных записаны через пробел два целых числа <span class="tex-span"><i>n</i></span> и <span class="tex-span"><i>m</i></span> (<span class="tex-span">1 ≤ <i>n</i>, <i>m</i> ≤ 5000</span>, <span class="tex-span"><i>n</i> ≥ <i>m</i></span>) — количество растений и количество различных видов. Каждая из последующих <span class="tex-span"><i>n</i></span> строк содержит по два числа через пробел: одно целое число <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>s</i><sub class="lower-index"><i>i</i></sub> ≤ <i>m</i></span>) и одно вещественное число <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">0 ≤ <i>x</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>), вид и положение <span class="tex-span"><i>i</i></span>-го растения. Каждое <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> будет задано с не более 6 цифрами после десятичной точки.</p><p>Гарантируется, что все <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> различны; в теплице есть как минимум по одному растению каждого вида; растения заданы во входных данных в порядке «слева-направо», то есть в порядке возрастания их координат <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span">(<i>x</i><sub class="lower-index"><i>i</i></sub> &lt; <i>x</i><sub class="lower-index"><i>i</i> + 1</sub>, 1 ≤ <i>i</i> &lt; <i>n</i>)</span>.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите единственное целое число — минимальное количество растений, которые надо пересадить.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>3 2<br />2 1<br />1 2.0<br />1 3.100<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>1<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>3 3<br />1 5.0<br />2 5.5<br />3 6.0<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>0<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>6 3<br />1 14.284235<br />2 17.921382<br />1 20.328172<br />3 20.842331<br />1 25.790145<br />1 27.204125<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом тесте Эмускальд может пересадить первое растение справа от последнего растения, так что ответ равен 1.</p><p>Во втором тесте все виды уже растут в правильном порядке, так что ничего пересаживать не надо.</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Неисправный Поток</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Эмускальд считает себя мастером алгоритмов по нахождению потока. Он только что завершил самую искусную из всех своих программ: она вычисляет максимальный поток в неориентированном графе. Граф состоит из <span class="tex-span"><i>n</i></span> вершин и <span class="tex-span"><i>m</i></span> ребер. Вершины пронумерованы от 1 до <span class="tex-span"><i>n</i></span>. Вершины <span class="tex-span">1</span> и <span class="tex-span"><i>n</i></span> — исток и сток, соответственно.</p><p>Однако, его алгоритм максимального потока, похоже, немного неисправен: для каждого ребра он находит только величину потока, протекающего по этому ребру, но не направление, в котором течет поток. Помогите ему для каждого ребра найти направление, в котором должен протекать поток по этому ребру, чтобы в итоге получился корректный максимальный поток.</p><p>Более формально: дан неориентированный граф, в котором для каждого неориентированного ребра (<span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span>) задана величина <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span>. Вы должны ориентировать все ребра так, чтобы выполнялись следующие условия:</p><p><ol> <li> для каждой вершины <span class="tex-span"><i>v</i></span> <span class="tex-span">(1 &lt; <i>v</i> &lt; <i>n</i>)</span>, сумма <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> входящих ребер равняется сумме <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> исходящих ребер; </li><li> вершина номер <span class="tex-span">1</span> не имеет входящих ребер; </li><li> полученный ориентированный граф <span class="tex-font-style-bf">не имеет циклов</span>. </li></ol></p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>Первая строка входных данных содержит два целых числа через пробел <span class="tex-span"><i>n</i></span> и <span class="tex-span"><i>m</i></span> (<span class="tex-span">2 ≤ <i>n</i> ≤ 2·10<sup class="upper-index">5</sup></span>, <span class="tex-span"><i>n</i> - 1 ≤ <i>m</i> ≤ 2·10<sup class="upper-index">5</sup></span>), количество вершин и ребер в графе. Каждая из следующих <span class="tex-span"><i>m</i></span> строк содержит три целых числа <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> и <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span>, <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub> ≠ <i>b</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span">1 ≤ <i>c</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">4</sup></span>) через пробел, которые обозначают неориентированное ребро от <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> до <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span>, по которому протекает в некотором направлении <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> единиц потока.</p><p>Гарантируется, что не существует двух ребер, соединяющих одни и те же вершины; данный граф связный; решение всегда существует.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите <span class="tex-span"><i>m</i></span> строк, в каждой строке должно быть по целому числу <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span>, равному 0, если направление <span class="tex-span"><i>i</i></span>-го ребра равняется <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub> → <i>b</i><sub class="lower-index"><i>i</i></sub></span> (поток протекает от вершины <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> к вершине <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span>), и равному 1 в противном случае. Считайте, что ребра пронумерованы от 1 до <span class="tex-span"><i>m</i></span> в том порядке, в котором они заданы во входных данных.</p><p>Если существует несколько решений, выведите любое из них.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>3 3<br />3 2 10<br />1 2 10<br />3 1 5<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>1<br />0<br />1<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>4 5<br />1 2 10<br />1 3 10<br />2 3 5<br />4 2 15<br />3 4 5<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>0<br />0<br />1<br />1<br />0<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом тестовом примере 10 единиц потока проходят по пути <img align="middle" class="tex-formula" src="http://codeforces.ru/renderer/609340f155794c4e9eebcd9cdfa23c73cf982f28.png" />, а 5 единиц потока проходят прямо от истока к стоку: <img align="middle" class="tex-formula" src="http://codeforces.ru/renderer/04481aced8a9d501ae5d785ab654c542ff5497a1.png" />.</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Максимальный водопад</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Эмускальда наняли на разработку искусственного водопада в соответствии с последними тенденциями в ландшафтной архитектуре. Современный искусственный водопад состоит из нескольких горизонтальных панелей, прикрепленных к широкой плоской стене. Вода течет вниз, начиная от верха стены, от панели к панели, пока не достигнет нижней части стены.</p><p>Стена имеет высоту <span class="tex-span"><i>t</i></span>. К ней прикреплены <span class="tex-span"><i>n</i></span> панелей. Каждая панель представляет собой горизонтальный отрезок на высоте <span class="tex-span"><i>h</i><sub class="lower-index"><i>i</i></sub></span>, который начинается с <span class="tex-span"><i>l</i><sub class="lower-index"><i>i</i></sub></span> и заканчивается в <span class="tex-span"><i>r</i><sub class="lower-index"><i>i</i></sub></span>. Панель номер <span class="tex-span"><i>i</i></span> соединяет точки стены <span class="tex-span">(<i>l</i><sub class="lower-index"><i>i</i></sub>, <i>h</i><sub class="lower-index"><i>i</i></sub>)</span> и <span class="tex-span">(<i>r</i><sub class="lower-index"><i>i</i></sub>, <i>h</i><sub class="lower-index"><i>i</i></sub>)</span>. Верхняя часть стены считается панелью, соединяющей точки <span class="tex-span">(  -  10<sup class="upper-index">9</sup>,  <i>t</i>)</span> и <span class="tex-span">(10<sup class="upper-index">9</sup>,  <i>t</i>)</span>. Аналогично, нижняя часть стены соединяет точки <span class="tex-span">(  -  10<sup class="upper-index">9</sup>,  0)</span> и <span class="tex-span">(10<sup class="upper-index">9</sup>,  0)</span>. Никакие две панели не имеют общую точку.</p><p>Эмускальд знает, что для того, чтобы водопад выглядел эффектно, он может течь с панели <span class="tex-span"><i>i</i></span> на панель <span class="tex-span"><i>j</i></span> (<img align="middle" class="tex-formula" src="http://codeforces.ru/renderer/c59da485d3a4e463f0157335ace916b7c377dcd8.png" />), только если выполнены следующие условия:</p><p><ol> <li> <span class="tex-span"><i>max</i>(<i>l</i><sub class="lower-index"><i>i</i></sub>, <i>l</i><sub class="lower-index"><i>j</i></sub>) &lt; <i>min</i>(<i>r</i><sub class="lower-index"><i>i</i></sub>, <i>r</i><sub class="lower-index"><i>j</i></sub>)</span> (горизонтальные проекции панелей перекрываются); </li><li> <span class="tex-span"><i>h</i><sub class="lower-index"><i>j</i></sub> &lt; <i>h</i><sub class="lower-index"><i>i</i></sub></span> (панель <span class="tex-span"><i>j</i></span> ниже панели <span class="tex-span"><i>i</i></span>); </li><li> нет такой панели <span class="tex-span"><i>k</i></span> (<span class="tex-span"><i>h</i><sub class="lower-index"><i>j</i></sub> &lt; <i>h</i><sub class="lower-index"><i>k</i></sub> &lt; <i>h</i><sub class="lower-index"><i>i</i></sub></span>), что первые два условия выполняются для пар панелей <span class="tex-span">(<i>i</i>, <i>k</i>)</span> и <span class="tex-span">(<i>k</i>, <i>j</i>)</span>. </li></ol></p><p>Тогда <span class="tex-font-style-bf">поток</span> по <img align="middle" class="tex-formula" src="http://codeforces.ru/renderer/c59da485d3a4e463f0157335ace916b7c377dcd8.png" /> равняется <span class="tex-span"><i>min</i>(<i>r</i><sub class="lower-index"><i>i</i></sub>, <i>r</i><sub class="lower-index"><i>j</i></sub>) - <i>max</i>(<i>l</i><sub class="lower-index"><i>i</i></sub>, <i>l</i><sub class="lower-index"><i>j</i></sub>)</span>, длине пересечения их горизонтальных проекций.</p><p>Эмускальд решил, что в его водопаде вода будет течь по одному пути сверху вниз. Если вода падает на какую-то панель (исключая низ стены), то далее вода должна падать <span class="tex-font-style-bf">ровно на одну</span> панель ниже нее. Общий поток воды в таком водопаде определяется как минимум величин пересечения горизонтальных проекций между двумя соседними панелями на пути водопада. Более формально:</p><p><ol> <li> водопад состоит из одного пути панелей <img align="middle" class="tex-formula" src="http://codeforces.ru/renderer/19e243d0761d715c71c322f6d06337878267eae8.png" />; </li><li> поток водопада равняется минимальному потоку на пути <img align="middle" class="tex-formula" src="http://codeforces.ru/renderer/19e243d0761d715c71c322f6d06337878267eae8.png" />. </li></ol></p><p>Для того, чтобы сделать действительно грандиозный водопад, Эмускальд должен максимизировать этот поток воды, но на стене слишком много панелей, и он с трудом планирует свое детище. Ниже приведен пример одного из водопадов, который хочет установить Эмускальд:</p><p><center> <img class="tex-graphics" src="http://codeforces.ru/renderer/daaaf132f66865bc12dc7b2cdd83b1be50a0a97a.png" /> </center></p><p>Помогите Эмускальду поддержать свою репутацию и найдите значение максимально возможного потока воды в некотором водопаде.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>Первая строка входных данных состоит из двух целых чисел <span class="tex-span"><i>n</i></span> и <span class="tex-span"><i>t</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup></span>, <span class="tex-span">2 ≤ <i>t</i> ≤ 10<sup class="upper-index">9</sup></span>), записанных через пробел — количество панелей, не считая верхнюю и нижнюю панели, и высота стены. Каждая из последующих <span class="tex-span"><i>n</i></span> строк содержит по три целых числа через пробел <span class="tex-span"><i>h</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>l</i><sub class="lower-index"><i>i</i></sub></span> и <span class="tex-span"><i>r</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">0 &lt; <i>h</i><sub class="lower-index"><i>i</i></sub> &lt; <i>t</i></span>, <span class="tex-span"> - 10<sup class="upper-index">9</sup> ≤ <i>l</i><sub class="lower-index"><i>i</i></sub> &lt; <i>r</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>) — высота, левый и правый концы отрезка <span class="tex-span"><i>i</i></span>-ой панели.</p><p>Гарантируется, что никакие две панели не имеют общих точек.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите единственное целое число — максимально возможную величину потока воды в искомом водопаде.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>5 6<br />4 1 6<br />3 2 7<br />5 9 11<br />3 10 15<br />1 13 16<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>4<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>6 5<br />4 2 8<br />3 1 2<br />2 2 3<br />2 6 12<br />1 0 7<br />1 8 11<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>Первый тест соответствует картинке.</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Теория струн</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Эмускальд — музыкант-новатор, он всегда пытается выйти за рамки творения музыки. Теперь он придумал революционный музыкальный инструмент — прямоугольную арфу.</p><p>Прямоугольная арфа является прямоугольником <span class="tex-span"><i>n</i> × <i>m</i></span> единиц, она состоит из <span class="tex-span"><i>n</i></span> рядов и <span class="tex-span"><i>m</i></span> столбцов. Ряды пронумерованы от 1 до <span class="tex-span"><i>n</i></span> сверху вниз. Аналогично, столбцы пронумерованы от 1 до <span class="tex-span"><i>m</i></span> слева направо. Крепления для струн расположены равномерно по каждой стороне, по одному креплению на единице длины. Таким образом, существует по <span class="tex-span"><i>n</i></span> креплений на левой и правой сторонах арфы и по <span class="tex-span"><i>m</i></span> креплений на верхней и нижней сторонах. Арфа имеет ровно <span class="tex-span"><i>n</i> + <i>m</i></span> различных струн, каждая струна соединяет два разных крепления, расположенных на разных сторонах арфы.</p><p>Эмускальд приказал своему ученику изготовить первую в мире прямоугольную арфу. Однако, он не упомянул, что никакие две струны не могут пересекаться (если струны пересекаются, то играть на арфе невозможно). Две струны пересекаются, если отрезки, соединяющие их крепления, пересекаются. Чтобы исправить арфу, Эмускальд может выполнять операции двух типов:</p><p><ol> <li> выбрать два различных столбца и поменять их крепления на каждой стороне арфы, не меняя сцепления каждой струны; </li><li> выбрать два различных ряда и поменять их крепления на каждой стороне арфы, не меняя сцепления каждой струны. </li></ol></p><p>В следующем примере он может починить арфу, поменяв местами два столбца:</p><p><center> <img class="tex-graphics" src="http://codeforces.ru/renderer/f864ba9ec1015f04fef8e57087480b90cb7ea5a4.png" /> </center></p><p>Помогите Эмускальду завершить свое детище и найдите перестановки, показывающие, как надо расположить ряды и колонки арфы. В противном случае сообщите, что сделать это невозможно. Юноша может снимать и натягивать струны на крепления, так что физическое расположение струн не имеет значения.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>Первая строка входных данных содержит два целых числа <span class="tex-span"><i>n</i></span> и <span class="tex-span"><i>m</i></span> (<span class="tex-span">1 ≤ <i>n</i>, <i>m</i> ≤ 10<sup class="upper-index">5</sup></span>), разделенных пробелами, высота и ширина арфы в единицах. Каждая из следующих <span class="tex-span"><i>n</i> + <i>m</i></span> строк содержит четыре токена через пробел, описывающих одну струну: два символа <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span>, и два целых числа <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>q</i><sub class="lower-index"><i>i</i></sub></span>. Пара <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> и <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span> описывает первое крепление, а пара <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> и <span class="tex-span"><i>q</i><sub class="lower-index"><i>i</i></sub></span> описывает второе крепление струны.</p><p>Пара <span class="tex-span"><i>s</i></span>, <span class="tex-span"><i>x</i></span> описывает положение одного крепления следующим образом: <ol> <li> <span class="tex-span"><i>s</i></span> равняется одному из символов «<span class="tex-font-style-tt">L</span>», «<span class="tex-font-style-tt">T</span>», «<span class="tex-font-style-tt">R</span>» или «<span class="tex-font-style-tt">B</span>» (без кавычек), и означает, что крепление находится на левой, верхней, правой или нижней границе арфы соответственно; </li><li> <span class="tex-span"><i>x</i></span> равняется номеру ряда, если крепление находится на левой или правой границе арфы, и номеру столбца, если крепление находится на верхней или нижней границе арфы. </li></ol></p><p>Гарантируется, что никакие две струны не присоединены к одному и тому же креплению.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Если можно переставить ряды и столбцы так, чтобы исправить арфу, в первой строке выведите <span class="tex-span"><i>n</i></span> целых чисел — старые номера рядов, теперь размещенные сверху вниз в исправленной арфе. Во второй строке выведите <span class="tex-span"><i>m</i></span> целых чисел, разделенных пробелом — старые номера столбцов, теперь расположенные слева направо в исправленной арфе.</p><p>Если же невозможно переставить ряды и столбцы так, чтобы исправить арфу, выведите «<span class="tex-font-style-tt">No solution</span>» (без кавычек).</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>3 4<br />L T 1 3<br />L B 2 2<br />L B 3 3<br />T R 1 2<br />T B 2 1<br />T R 4 1<br />B R 4 3<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>1 2 3 <br />3 2 1 4 <br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>3 3<br />L T 1 1<br />T R 3 1<br />R B 3 3<br />B L 1 3<br />L R 2 2<br />T B 2 2<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>No solution<br /></pre></div></div></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>

    <br style="clear:both;"/>

    <div id="footer">
        <div><a href="http://codeforces.ru/">Codeforces</a> (c) Copyright 2010-2013 Михаил Мирзаянов</div>
        <div>Соревнования по программированию 2.0</div>

    </div>
</div>
</div>
</body>
</html>                                       
