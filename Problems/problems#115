
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="4h2hah457cdbdb5a5heh9g6c43ah6g43"/>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="http://worker.codeforces.ru/static/images/codeforces-vk-square-ru.png"/>
    <meta property="og:title" content="Задачи - Codeforces"/>
    <meta property="og:site_name" content="Codeforces"/>
    
    <meta name="cc" content="12accud97gzw4"/>
    
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Задачи - Codeforces</title>
        <meta name="description" content="Codeforces. Соревнования и олимпиады по информатике и программированию, сообщество программистов" />
        <meta name="keywords" content="программирование информатика контест олимпиада алгоритмы c++ java графы vkcup" />
    <meta name="robots" content="index, follow" />

    <link href="http://worker.codeforces.ru/static/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

    <HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--CombineResourcesFilter-->
    
<LINK href="http://worker.codeforces.ru/static/favicon.png" rel="shortcut icon" type="image/png">
    
<LINK href="http://worker.codeforces.ru/static/css/prettify.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/clear.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/style.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/ttypography.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/problem-statement.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/second-level-menu.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/roundbox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/datatable.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/topic.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/table-form.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.jgrowl.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/facebox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.wysiwyg.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/codeforces.datepick.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/colorbox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.drafts.css" rel="stylesheet" type="text/css">
    
<LINK href="http://worker.codeforces.ru/static/markitup/skins/markitup/style.css" rel="stylesheet" type="text/css">
    
<LINK href="http://worker.codeforces.ru/static/markitup/sets/markdown/style.css" rel="stylesheet" type="text/css">

    
<SCRIPT charset="utf-8" src="//yandex.st/share/share.js" type="text/javascript"></SCRIPT>
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/sidebar-menu.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/community.css" rel="stylesheet" type="text/css">

    <!--[if IE]>
        <style>
            #sidebar {
                padding-left: 1em;
                margin: 1em 1em 1em 0;
            }
        </style>
    <![endif]-->
    
    
<SCRIPT src="http://worker.codeforces.ru/static/js/prettify/prettify.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery-1.8.3.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/sockjs-0.2.1.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/vertxbus-1.2.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.easing.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.lavalamp.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.jgrowl.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/facebox.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.wysiwyg.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.colorpicker.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.table.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.image.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.link.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.autocomplete.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.datepick.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.ie6blocker.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.colorbox-min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.ba-bbq.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.drafts.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/codeforces.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/markitup/jquery.markitup.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/markitup/sets/markdown/set.js" type="text/javascript"></SCRIPT>
    <!--/CombineResourcesFilter-->
</HEAD>
</HTML>

        <script type="text/javascript" src="http://worker.codeforces.ru/static/js/jquery.datepick-ru.js"></script>
        <script src="http://vk.com/js/api/openapi.js" type="text/javascript"></script>
</head>
<body><span style='display:none;' class='csrf-token' data-csrf='4h2hah457cdbdb5a5heh9g6c43ah6g43'>&nbsp;</span>
<!-- Codeforces javascripts. -->
<script type="text/javascript">
    VK.init({apiId: 1961905});
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>

    <script type="text/javascript">
        $(document).ready(function() {
    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    $(".second-level-menu-list").lavaLamp({
        fx: "backout",
        speed: 1000
    });


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


        });
    </script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<div id="body">
<div style="width: 950px; margin: 0 auto;">
    <div id="header" style="position:relative;">
        <div style="float:left;">
                <a href="/"><img src="http://worker.codeforces.ru/static/images/codeforces-logo-with-upper-beta.png"/></a>
                        <div style="position:absolute;left:97px;top:40px;">
                            <a href="http://vk.com" class="logo-href">При поддержке <img
                                    style="position:relative;top:5px;" src="http://worker.codeforces.ru/static/images/vkontakte-tiny-ru.png"/></a>
                        </div>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="http://worker.codeforces.ru/static/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="http://worker.codeforces.ru/static/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <div style="text-align: center;font-size: 18px;margin-bottom: 0.5em;"
         class="caption">Codeforces Beta Round #87 (Div. 1 Only)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Праздник</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>3 seconds</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 megabytes</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>В компании работает <span class="tex-span"><i>n</i></span> сотрудников, пронумерованных от <span class="tex-span">1</span> до <span class="tex-span"><i>n</i></span>. У каждого сотрудника либо нет руководителя, либо есть ровно один непосредственный руководитель — некоторый другой сотрудник с другим номером. Сотрудник <span class="tex-span"><i>A</i></span> называется <span class="tex-font-style-it">начальником</span> другого сотрудника <span class="tex-span"><i>B</i></span>, если выполняется хотя бы одно из двух условий:</p><p><ul> <li> Сотрудник <span class="tex-span"><i>A</i></span> — непосредственный руководитель сотрудника <span class="tex-span"><i>B</i></span>. </li><li> У сотрудника <span class="tex-span"><i>B</i></span> есть непосредственный руководитель, сотрудник <span class="tex-span"><i>C</i></span>, такой, что <span class="tex-span"><i>A</i></span> является начальником сотрудника <span class="tex-span"><i>C</i></span>. </li></ul></p><p>В структуре компании нет циклов. То есть никакой сотрудник не является начальником своего непосредственного руководителя.</p><p>Сегодня компания собирается организовать праздник. Для этого необходимо разделить всех <span class="tex-span"><i>n</i></span> сотрудников на несколько групп: каждый человек должен относиться ровно к одной группе. Более того, в каждой группе не должно быть таких двух сотрудников <span class="tex-span"><i>A</i></span> и <span class="tex-span"><i>B</i></span>, что <span class="tex-span"><i>A</i></span> является начальником <span class="tex-span"><i>B</i></span>.</p><p>Ваша задача — найти наименьшее возможное количество таких групп.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>Первая строка содержит целое число <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 2000</span>) — количество сотрудников.</p><p>Следующие <span class="tex-span"><i>n</i></span> строк содержат целые числа <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>p</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span> или <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub> = </span>-1). Каждое <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span> обозначает непосредственного руководителя <span class="tex-span"><i>i</i></span>-го сотрудника. Если <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span> равно -1, то <span class="tex-span"><i>i</i></span>-ый сотрудник не имеет непосредственного руководителя.</p><p>Гарантируется, что никакой сотрудник не является своим собственным непосредственным руководителем (<span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub> ≠ <i>i</i></span>). Также гарантируется, что структура компании не содержит циклов.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите единственное целое число — минимальное количество групп, на которые можно разделить всех сотрудников.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>5<br />-1<br />1<br />2<br />1<br />-1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>3<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом примере достаточно трех групп: <ul> <li> Сотрудник 1 </li><li> Сотрудники 2 и 4 </li><li> Сотрудники 3 и 5 </li></ul></p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Газонокосилка</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>3 seconds</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 megabytes</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>У вас есть сад, в котором растет трава и сорняки. Ваш сад представляет собой клетчатое поле размером <span class="tex-span"><i>n</i> × <i>m</i></span>. Строки пронумерованы от <span class="tex-span">1</span> до <span class="tex-span"><i>n</i></span> сверху вниз, а столбцы — от <span class="tex-span">1</span> до <span class="tex-span"><i>m</i></span> слева направо. Каждая клетка обозначается парой <span class="tex-span">(<i>r</i>, <i>c</i>)</span>, где <span class="tex-span"><i>r</i></span> — номер строки, в которой расположены клетка, а <span class="tex-span"><i>c</i></span> — номер столбца. Каждая клетка содержит либо траву, либо сорняк. Например, сад размера <span class="tex-span">4 × 5</span> может выглядеть следующим образом (пустые клетки обозначают траву):</p><p><center> <img class="tex-graphics" src="http://codeforces.ru/renderer/807d304e4e07e9de31dfaac5953fbe422cd02650.png" /> </center></p><p>У вас есть газонокосилка, и вы хотите скосить все сорняки. Изначально вы и ваша газонокосилка находитесь в левом верхнем углу сада, то есть в клетке <span class="tex-span">(1, 1)</span>. В каждый момент времени вы смотрите либо направо, либо налево. Изначально вы смотрите направо. </p><p>За один ход вы можете сделать одно из двух:</p><p>1) Пойти на одну клетку в ту сторону, куда вы смотрите.</p><p><ul></ul></p><p> <li> если вы смотрите направо: пойти из клетки <span class="tex-span">(<i>r</i>, <i>c</i>)</span> в клетку <span class="tex-span">(<i>r</i>, <i>c</i> + 1)</span></li></p><p> <center> <img class="tex-graphics" src="http://codeforces.ru/renderer/dd3197cfc87f21b8b8a55b604e229277977738dc.png" /> </center></p><p> <li> если вы смотрите налево: пойти из клетки <span class="tex-span">(<i>r</i>, <i>c</i>)</span> в клетку <span class="tex-span">(<i>r</i>, <i>c</i> - 1)</span></li></p><p> <center> <img class="tex-graphics" src="http://codeforces.ru/renderer/63eb7c27b5840df3b6e4d0f4f1195eb40ca6744f.png" /> </center></p><p> 2) Пойти на одну клетку вниз (то есть из клетки <span class="tex-span">(<i>r</i>, <i>c</i>)</span> в клетку <span class="tex-span">(<i>r</i> + 1, <i>c</i>)</span>) и развернуться в другую сторону.</p><p><ul></ul></p><p> <li> если вы смотрели направо, вы будете смотреть налево</li></p><p> <center> <img class="tex-graphics" src="http://codeforces.ru/renderer/9500b99d45b22c90ea35774539358f0e205d3922.png" /> </center></p><p> <li> если вы смотрели налево, вы будете смотреть направо</li></p><p> <center> <img class="tex-graphics" src="http://codeforces.ru/renderer/b3b0592c87c6f44adca86acaad35a3d3f0bf023c.png" /> </center> </p><p>Вы не можете выходить за пределы поля. Чтобы скосить сорняк, вы должны оказаться в одной клетке с ним (при этом не имеет значения, в какую сторону вы смотрите). На это действие ход не тратится.</p><p>Какое наименьшее количество ходов потребуется, чтобы скосить все сорняки?</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке содержится два целых числа <span class="tex-span"><i>n</i></span> и <span class="tex-span"><i>m</i></span> (<span class="tex-span">1 ≤ <i>n</i>, <i>m</i> ≤ 150</span>) — количество строк и столбцов соответственно. Далее следует <span class="tex-span"><i>n</i></span> строк по <span class="tex-span"><i>m</i></span> символов в каждой — описание сада. «<span class="tex-font-style-tt">G</span>» обозначает, что данная клетка содержит траву. «<span class="tex-font-style-tt">W</span>» обозначает, что данная клетка содержит сорняк.</p><p>Гарантируется, что верхняя левая клетка поля содержит траву.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите одно целое число — минимальное количество ходов, которое требуется, чтобы скосить все сорняки.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>4 5<br />GWGGW<br />GGWGG<br />GWGGG<br />WGGGG<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>11<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>3 3<br />GWW<br />WWW<br />WWG<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>7<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>1 1<br />G<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>0<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом примере начальное состояние поля выглядит следующим образом:</p><p><center> <img class="tex-graphics" src="http://codeforces.ru/renderer/e41da06982349197f45165815dcaf45a1f9ecab0.png" /> </center></p><p>Одно из возможных решений:</p><p><center> <img class="tex-graphics" src="http://codeforces.ru/renderer/80557ed0dff1561a7eaa9738a588d645df2d5bdf.png" /> </center></p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Водопроводчик</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>3 seconds</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 megabytes</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Маленький Джон мечтает стать водопроводчиком. Сегодня он нарисовал клетчатое поле размером <span class="tex-span"><i>n</i> × <i>m</i></span>, состоящее из <span class="tex-span"><i>n</i></span> строк и <span class="tex-span"><i>m</i></span> столбцов.</p><p>В каждой клетке Джон хочет нарисовать фрагмент трубы. Он умеет рисовать фрагменты четырех типов, которые нумеруются от <span class="tex-span">1</span> до <span class="tex-span">4</span> как показано на картинке:</p><p><center> <img class="tex-graphics" src="http://codeforces.ru/renderer/0f4f565f8c683816abd75ee35a19a507c2368ac9.png" /> </center></p><p>Каждый фрагмент трубы имеет два конца, они обозначены стрелками на картинке. Например, концы фрагмента номер <span class="tex-span">1</span> направлены влево и вверх.</p><p>Маленький Джон считает, что система труб протекает, если хотя бы один конец одного фрагмента не подсоединен ни к другому концу, ни к краю поля. Ниже приведены примеры двух систем труб размера <span class="tex-span">1 × 2</span>. Система труб в левом примере протекает, в правом — не протекает.</p><p><center> <img class="tex-graphics" src="http://codeforces.ru/renderer/e35b414a742729fa5ead9cf10d76d0bf280f7fdf.png" /> </center></p><p>Маленький Джон уже начал рисовать трубы. Вам дано поле, каждая клетка которого либо содержит один из четырех фрагментов трубы, либо пуста. Найдите количество способов нарисовать <span class="tex-font-style-bf">во всех</span> пустых клетках фрагменты трубы так, чтобы получившаяся система труб не протекала. Выведите это число по модулю <span class="tex-span">1000003</span> (<span class="tex-span">10<sup class="upper-index">6</sup> + 3</span>).</p><p>Учтите, что повороты и отражения поля не разрешаются. То есть если два способа равны только после поворота или отражения, то эти способы следует считать различными.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке через пробел записаны два целых числа <span class="tex-span"><i>n</i></span> и <span class="tex-span"><i>m</i></span> (<span class="tex-span">1 ≤ <i>n</i>, <i>m</i>, <i>n</i>·<i>m</i> ≤ 5·10<sup class="upper-index">5</sup></span>) — количество строк и столбцов соответственно. Далее следует <span class="tex-span"><i>n</i></span> строк по <span class="tex-span"><i>m</i></span> символов — описание поля. Один символ описывает одну клетку: <ul> <li> «<span class="tex-font-style-tt">1</span>» - «<span class="tex-font-style-tt">4</span>» — фрагмент трубы одного из четырех типов, описанных выше </li><li> «<span class="tex-font-style-tt">.</span>» — пустая клетка </li></ul></p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите одно число — количество способов завершить рисунок так, чтобы система труб не имела протечек, по модулю <span class="tex-span">1000003</span> (<span class="tex-span">10<sup class="upper-index">6</sup> + 3</span>). Если это сделать невозможно, выведите <span class="tex-span">0</span>.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>2 2<br />13<br />..<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>3 1<br />1<br />4<br />.<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>0<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>2 2<br />3.<br />.1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>1<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом примере начальная конфигурация труб выглядит следующим образом: <center> <img class="tex-graphics" src="http://codeforces.ru/renderer/ddef4e4702db9a39fb3bed42d7183c65c1447634.png" /> </center></p><p>Два способа завершить рисунок:</p><p><center> <img class="tex-graphics" src="http://codeforces.ru/renderer/df663469295eb5486d551e83edc37d729b8652e0.png" /> </center></p><p><center> <img class="tex-graphics" src="http://codeforces.ru/renderer/27cd36f4390e6e78ab9712ec043c8055bf7faab4.png" /> </center></p><p>Во втором примере начальная конфигурация сразу протекает, поэтому невозможно завершить рисунок так, чтобы получившаяся система труб не протекала.</p><p>В последнем примере возможна одна система труб без протечек:</p><p><center> <img class="tex-graphics" src="http://codeforces.ru/renderer/3adc4ffb888ce9654b31522ea6eb9ebf170eca95.png" /> </center></p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Арифметическое выражение</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 seconds</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 megabytes</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Определим <span class="tex-font-style-it">арифметическое выражение</span> (АВ) следующим образом. <ul> <li> Каждое неотрицательное целое число является АВ. Целые числа могут иметь лидирующие нули (например, <span class="tex-span">0000</span> и <span class="tex-span">0010</span> считаются допустимыми целыми числами). </li><li> Если <span class="tex-span"><i>X</i></span> и <span class="tex-span"><i>Y</i></span> являются АВ, то «<span class="tex-span">(<i>X</i>) + (<i>Y</i>)</span>», «<span class="tex-span">(<i>X</i>) - (<i>Y</i>)</span>», «<span class="tex-span">(<i>X</i>) * (<i>Y</i>)</span>», и «<span class="tex-span">(<i>X</i>) / (<i>Y</i>)</span>» (без кавычек) тоже являются АВ. </li><li> Если <span class="tex-span"><i>X</i></span> является АВ, то «<span class="tex-span"> - (<i>X</i>)</span>» и «<span class="tex-span"> + (<i>X</i>)</span>» (без кавычек) тоже являются АВ.</li></ul></p><p>Дана строка, состоящая из цифр («<span class="tex-font-style-tt">0</span>» - «<span class="tex-font-style-tt">9</span>») и символов «<span class="tex-font-style-tt">-</span>», «<span class="tex-font-style-tt">+</span>», «<span class="tex-font-style-tt">*</span>», и «<span class="tex-font-style-tt">/</span>». Ваша задача — посчитать количество арифметических выражений, таких, что после удаления из него всех скобок (символов «<span class="tex-font-style-tt">(</span>» и «<span class="tex-font-style-tt">)</span>»), это выражение становится эквивалентным данной строке. Так как ответ может быть очень большим, выведите его по модулю <span class="tex-span">1000003</span> (<span class="tex-span">10<sup class="upper-index">6</sup> + 3</span>).</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>Первая строка — <span class="tex-font-style-it">непустая</span> строка из цифр («<span class="tex-font-style-tt">0</span>» - «<span class="tex-font-style-tt">9</span>») и символов «<span class="tex-font-style-tt">-</span>», «<span class="tex-font-style-tt">+</span>», «<span class="tex-font-style-tt">*</span>», и/или «<span class="tex-font-style-tt">/</span>». Длина строки не превосходит <span class="tex-span">2000</span> символов. Строка не содержит пробелов.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите одно целое число — количество различных арифметических выражений, которые после удаления из них скобок становятся посимвольно равными данной строке, по модулю <span class="tex-span">1000003</span> (<span class="tex-span">10<sup class="upper-index">6</sup> + 3</span>).</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>1+2*3<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>03+-30+40<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>3<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>5//4<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>0<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>5/0<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>1<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>100728<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом примере возможны два арифметических выражения:<pre><span class="tex-span">((1) + (2)) * (3)</span><br /><span class="tex-span">(1) + ((2) * (3))</span></pre></p><p>Во втором примере возможны три арифметических выражения:<pre><span class="tex-span">(03) + (( - (30)) + (40))</span><br /><span class="tex-span">(03) + ( - ((30) + (40)))</span><br /><span class="tex-span">((03) + ( - (30))) + (40)</span></pre></p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Гонки в Линейном Королевстве</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>5 seconds</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 megabytes</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Вы — организатор гонок, и вы хотите провести серию заездов в Линейном Королевстве.</p><p>В Линейном Королевстве <span class="tex-span"><i>n</i></span> дорог, пронумерованных от <span class="tex-span">1</span> до <span class="tex-span"><i>n</i></span>. Дороги идут одна за другой слева направо, в порядке возрастания номера. Вам поступило несколько предложений проведения заездов. Для каждого заезда известно, на каких дорогах предлагается его проводить — некоторый набор <span class="tex-font-style-bf">последовательных</span> дорог Королевства. Также известно ваше вознаграждение, в случае если вы решите провести данный заезд. Все заезды предлагается проводить в разное время, то есть одна и та же дорога может использоваться в нескольких заездах.</p><p>К несчастью, некоторые дороги в плохом состоянии, и их нужно чинить. Для каждой дороги известна стоимость ее ремонта. Заезд можно проводить только если отремонтированы все дороги, на которых проходит гонка. Ваша задача — отремонтировать такой набор дорог (возможно, все, или ни одной), чтобы ваша прибыль была как можно больше. Прибыль считается как сумма вознаграждений, полученных за проведение заездов, минус сумма денег, потраченных на ремонт дорог. Заметьте, что вы можете не чинить дороги вообще и получить нулевую прибыль.</p><p>Найдите максимальную возможную прибыль.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке через пробел записано два целых числа <span class="tex-span"><i>n</i></span> и <span class="tex-span"><i>m</i></span> (<span class="tex-span">1 ≤ <i>n</i>, <i>m</i> ≤ 2·10<sup class="upper-index">5</sup></span>) — количество дорог и предложенных заездов соответственно.</p><p>Далее следует <span class="tex-span"><i>n</i></span> строк. Каждая строка содержит одно целое неотрицательное число, не превосходящее <span class="tex-span">10<sup class="upper-index">9</sup></span> — стоимость починки очередной дороги. Стоимости починки даны в порядке начиная с дороги номер <span class="tex-span">1</span> заканчивая дорогой номер <span class="tex-span"><i>n</i></span>.</p><p>Далее следует <span class="tex-span"><i>m</i></span> строк по три числа в каждой: <span class="tex-span"><i>lb</i></span>, <span class="tex-span"><i>ub</i></span>, и <span class="tex-span"><i>p</i></span> (<span class="tex-span">1 ≤ <i>lb</i> ≤ <i>ub</i> ≤ <i>n</i>, 1 ≤ <i>p</i> ≤ 10<sup class="upper-index">9</sup></span>). Каждая строка описывает очередной заезд: предлагается использовать дороги с <span class="tex-span"><i>lb</i></span> по <span class="tex-span"><i>ub</i></span> включительно, и вознаграждение будет составлять <span class="tex-span"><i>p</i></span>.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите одно целое число — максимальную возможную прибыль, которую вы можете получить.</p><p>Пожалуйста, не используйте спецификатор <span class="tex-font-style-tt">%lld</span> для чтения и записи 64-битных целых чисел в C++. Рекомендуется использовать потоки <span class="tex-font-style-tt">cin</span>, <span class="tex-font-style-tt">cout</span> (также вы можете использовать спецификатор <span class="tex-font-style-tt">%I64d</span>).</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>7 4<br />3<br />2<br />3<br />2<br />1<br />2<br />3<br />1 2 5<br />2 3 5<br />3 5 3<br />7 7 5<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>4<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>2 1<br />0<br />3<br />1 2 5<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>3 1<br />10<br />10<br />10<br />1 3 10<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>0<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом примере выгодно чинить дороги <span class="tex-span">1</span>, <span class="tex-span">2</span>, <span class="tex-span">3</span> и <span class="tex-span">7</span>. Три заезда приносят доход <span class="tex-span">15</span>. Ремонт стоит <span class="tex-span">11</span>, значит прибыль равна <span class="tex-span">4</span>.</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>

    <br style="clear:both;"/>

    <div id="footer">
        <div><a href="http://codeforces.ru/">Codeforces</a> (c) Copyright 2010-2013 Михаил Мирзаянов</div>
        <div>Соревнования по программированию 2.0</div>

    </div>
</div>
</div>
</body>
</html>                                       
