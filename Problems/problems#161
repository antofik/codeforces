
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="g1a661h95ce6eg6g0h58h0d29cce7400"/>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="http://worker.codeforces.ru/static/images/codeforces-vk-square-ru.png"/>
    <meta property="og:title" content="Задачи - Codeforces"/>
    <meta property="og:site_name" content="Codeforces"/>
    
    <meta name="cc" content="15njfssoayy0e"/>
    
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Задачи - Codeforces</title>
        <meta name="description" content="Codeforces. Соревнования и олимпиады по информатике и программированию, сообщество программистов" />
        <meta name="keywords" content="программирование информатика контест олимпиада алгоритмы c++ java графы vkcup" />
    <meta name="robots" content="index, follow" />

    <link href="http://worker.codeforces.ru/static/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

    <HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--CombineResourcesFilter-->
    
<LINK href="http://worker.codeforces.ru/static/favicon.png" rel="shortcut icon" type="image/png">
    
<LINK href="http://worker.codeforces.ru/static/css/prettify.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/clear.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/style.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/ttypography.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/problem-statement.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/second-level-menu.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/roundbox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/datatable.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/topic.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/table-form.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.jgrowl.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/facebox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.wysiwyg.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/codeforces.datepick.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/colorbox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.drafts.css" rel="stylesheet" type="text/css">
    
<LINK href="http://worker.codeforces.ru/static/markitup/skins/markitup/style.css" rel="stylesheet" type="text/css">
    
<LINK href="http://worker.codeforces.ru/static/markitup/sets/markdown/style.css" rel="stylesheet" type="text/css">

    
<SCRIPT charset="utf-8" src="//yandex.st/share/share.js" type="text/javascript"></SCRIPT>
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/sidebar-menu.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/community.css" rel="stylesheet" type="text/css">

    <!--[if IE]>
        <style>
            #sidebar {
                padding-left: 1em;
                margin: 1em 1em 1em 0;
            }
        </style>
    <![endif]-->
    
    
<SCRIPT src="http://worker.codeforces.ru/static/js/prettify/prettify.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery-1.8.3.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/sockjs-0.2.1.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/vertxbus-1.2.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.easing.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.lavalamp.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.jgrowl.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/facebox.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.wysiwyg.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.colorpicker.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.table.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.image.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.link.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.autocomplete.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.datepick.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.ie6blocker.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.colorbox-min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.ba-bbq.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.drafts.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/codeforces.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/markitup/jquery.markitup.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/markitup/sets/markdown/set.js" type="text/javascript"></SCRIPT>
    <!--/CombineResourcesFilter-->
</HEAD>
</HTML>

        <script type="text/javascript" src="http://worker.codeforces.ru/static/js/jquery.datepick-ru.js"></script>
        <script src="http://vk.com/js/api/openapi.js" type="text/javascript"></script>
</head>
<body><span style='display:none;' class='csrf-token' data-csrf='g1a661h95ce6eg6g0h58h0d29cce7400'>&nbsp;</span>
<!-- Codeforces javascripts. -->
<script type="text/javascript">
    VK.init({apiId: 1961905});
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>

    <script type="text/javascript">
        $(document).ready(function() {
    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    $(".second-level-menu-list").lavaLamp({
        fx: "backout",
        speed: 1000
    });


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


        });
    </script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<div id="body">
<div style="width: 950px; margin: 0 auto;">
    <div id="header" style="position:relative;">
        <div style="float:left;">
            <div style="padding-top:1em;">
<a href="http://codeforces.ru/vkcup2012"><img src="http://stat.codeforces.ru/images/vkcup2012-2.png"/>
</a>
</div>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="http://worker.codeforces.ru/static/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="http://worker.codeforces.ru/static/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <div style="text-align: center;font-size: 18px;margin-bottom: 0.5em;"
         class="caption">VK Cup 2012 &#1056;&#1072;&#1091;&#1085;&#1076; 1</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Оденьте их скорее!</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>3 seconds</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 megabytes</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>В Двумерном королевстве наступили тяжелые времена... Сегодня утром Трехмерное королевство объявило войну Двумерному и в ходе этого (возможно, вооруженного) конфликта решится, кому же все-таки принадлежит прямая.</p><p>В Двумерном королевстве есть постоянная армия, состоящая из <span class="tex-span"><i>n</i></span> человек. Каждый боец прошел специальную регистрацию и указал желаемый размер бронежилета: <span class="tex-span"><i>i</i></span>-ый боец указал размер <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>. Известно, что бойцы люди неприхотливые, поэтому штаб считает, что им комфортно носить любые бронежилеты с размерами от <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub> - <i>x</i></span> до <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub> + <i>y</i></span> включительно (числа <span class="tex-span"><i>x</i>, <i>y</i> ≥ 0</span> заданы). </p><p>В распоряжении армии Двумерного королевства есть <span class="tex-span"><i>m</i></span> бронежилетов, размер <span class="tex-span"><i>j</i></span>-го бронежилета равен <span class="tex-span"><i>b</i><sub class="lower-index"><i>j</i></sub></span>. Помогите мобилизовать армию Двумерного королевства — оденьте наибольшее возможное количество бойцов армии в бронежилеты. Каждый бронежилет разрешается использовать только один раз. <span class="tex-span"><i>i</i></span>-ый боец может надеть <span class="tex-span"><i>j</i></span>-ый бронежилет, если <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub> - <i>x</i> ≤ <i>b</i><sub class="lower-index"><i>j</i></sub> ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> + <i>y</i></span>.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке входных данных записаны четыре целых числа <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>m</i></span>, <span class="tex-span"><i>x</i></span> и <span class="tex-span"><i>y</i></span> (<span class="tex-span">1 ≤ <i>n</i>, <i>m</i> ≤ 10<sup class="upper-index">5</sup></span>, <span class="tex-span">0 ≤ <i>x</i>, <i>y</i> ≤ 10<sup class="upper-index">9</sup></span>) — количество бойцов, количество бронежилетов и два числа, характеризующие неприхотливость бойцов, соответственно.</p><p>Во второй строке записаны в неубывающем порядке <span class="tex-span"><i>n</i></span> разделенных единичными пробелами целых чисел <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub></span> (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>) — желаемые размеры бронежилетов. </p><p>В третьей строке записаны в неубывающем порядке <span class="tex-span"><i>m</i></span> разделенных единичными пробелами целых чисел <span class="tex-span"><i>b</i><sub class="lower-index">1</sub>, <i>b</i><sub class="lower-index">2</sub>, ..., <i>b</i><sub class="lower-index"><i>m</i></sub></span> (<span class="tex-span">1 ≤ <i>b</i><sub class="lower-index"><i>j</i></sub> ≤ 10<sup class="upper-index">9</sup></span>) — размеры имеющихся в наличии бронежилетов.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>В первой строке выведите единственное целое число <span class="tex-span"><i>k</i></span> — максимальное количество одетых в бронежилеты бойцов. </p><p>В следующих <span class="tex-span"><i>k</i></span> строках выведите <span class="tex-span"><i>k</i></span> пар, по одной паре в строке в формате «<span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span>» (без кавычек). Пара (<span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span>) означает, что боец с номером <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span> должен быть одет в бронежилет номер <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span>. Бойцы и бронежилеты нумеруются, начиная с единицы, в том порядке, в котором они заданы во входных данных. Все номера бойцов в парах должны быть попарно различны, все номера бронежилетов в парах также должны быть попарно различны. Пары можно выводить в любом порядке. </p><p>Если существует несколько оптимальных ответов, разрешается вывести любой.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>5 3 0 0<br />1 2 3 3 4<br />1 3 5<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2<br />1 1<br />3 2<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>3 3 2 2<br />1 5 9<br />3 5 7<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>3<br />1 1<br />2 2<br />3 3<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом примере требуется точное совпадение размеров бронежилетов: первый боец получает первый бронежилет (размер 1), а третий — второй бронежилет (размер 3). В этом примере возможен другой ответ, в котором второй бронежилет достается не третьему, а четвертому бойцу.</p><p>Во втором примере размер бронежилета должен отличаться от пожеланий бойца не больше чем на 2 размера, и одеть можно всех бойцов.</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Скидки</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>3 seconds</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 megabytes</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Как-то раз Поликарп по пути домой заглянул в супермаркет. Оказалось, что в супермаркете проходит акция по продаже табуреток. Условия акции таковы: если в корзинке с купленными товарами есть хотя бы одна табуретка, то на минимальный по стоимости товар из корзинки предоставляется скидка <span class="tex-span">50%</span> (то есть он становится дешевле в два раза). Если товаров минимальной стоимости несколько, скидка предоставляется только на один из них!</p><p>У Поликарпа есть <span class="tex-span"><i>k</i></span> корзинок, и он хочет скупить все табуретки и карандаши из супермаркета. Помогите ему распределить табуретки и карандаши по корзинкам так, чтобы суммарная стоимость товаров (с учетом скидок) была как можно меньше.</p><p>Поликарп обязан использовать все <span class="tex-span"><i>k</i></span> корзинок для покупки товаров, ни одна корзинка не должна остаться пустой. В каждой корзинке может быть произвольное количество табуреток и/или карандашей.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке входных данных записано два целых числа <span class="tex-span"><i>n</i></span> и <span class="tex-span"><i>k</i></span> (<span class="tex-span">1 ≤ <i>k</i> ≤ <i>n</i> ≤ 10<sup class="upper-index">3</sup></span>) — количество товаров в супермаркете и количество корзинок у Поликарпа, соответственно. В следующих <span class="tex-span"><i>n</i></span> строках заданы описания товаров в виде «<span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span>» (без кавычек), где <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>c</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>) — целое число, обозначающее стоимость <span class="tex-span"><i>i</i></span>-го товара, <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>t</i><sub class="lower-index"><i>i</i></sub> ≤ 2</span>) — целое число, обозначающее тип <span class="tex-span"><i>i</i></span>-го товара (<span class="tex-span">1</span> — табуретка, <span class="tex-span">2</span> — карандаш). Числа в строках разделяются одним пробелом.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>В первую строку выведите единственное вещественное число <span class="tex-font-style-bf">с ровно одним </span> знаком после запятой — минимальную суммарную стоимость товаров с учетом скидок.</p><p>В следующих <span class="tex-span"><i>k</i></span> строках выведите описания товаров в корзинках. В <span class="tex-span"><i>i</i></span>-й строке выведите описание <span class="tex-span"><i>i</i></span>-й корзинки в формате «<span class="tex-span"><i>t</i></span> <span class="tex-span"><i>b</i><sub class="lower-index">1</sub></span> <span class="tex-span"><i>b</i><sub class="lower-index">2</sub></span> <span class="tex-span">...</span> <span class="tex-span"><i>b</i><sub class="lower-index"><i>t</i></sub></span>» (без кавычек), где <span class="tex-span"><i>t</i></span> — количество товаров в <span class="tex-span"><i>i</i></span>-й корзинке, а последовательность <span class="tex-span"><i>b</i><sub class="lower-index">1</sub>, <i>b</i><sub class="lower-index">2</sub>, ..., <i>b</i><sub class="lower-index"><i>t</i></sub></span> (<span class="tex-span">1 ≤ <i>b</i><sub class="lower-index"><i>j</i></sub> ≤ <i>n</i></span>) — номера товаров, которые следует положить в эту корзинку в оптимальном распределении. Все номера товаров во всех корзинках должны быть попарно различны, каждый товар должен находиться ровно в одной корзинке. Товары в корзинках и сами корзинки можно выводить в любом порядке. Товары нумеруются от <span class="tex-span">1</span> до <span class="tex-span"><i>n</i></span> в том порядке, в котором они заданы во входных данных. </p><p>Если существует несколько оптимальных распределений, разрешается вывести любое.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>3 2<br />2 1<br />3 2<br />3 1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>5.5<br />2 1 2<br />1 3<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>4 3<br />4 1<br />1 2<br />2 2<br />3 2<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>8.0<br />1 1<br />2 4 2<br />1 3<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом примере в первую корзинку следует положить 1-ый и 2-ой товар, а во вторую — 3-ий товар. Тогда в каждой корзинке будет табуретка, и на товар минимальной стоимости предоставляется скидка <span class="tex-span">50%</span>. Суммарная стоимость товаров составит: <span class="tex-span">2·0.5 + (3 + 3·0.5) = 1 + 4.5 = 5.5</span>.</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Абракадабра</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>3 seconds</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 megabytes</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Поликарп исследует строку, которую он называет <span class="tex-font-style-it">абракадабра</span>. Эта строка строится по следующему алгоритму: <ul> <li> На первом шаге строка состоит из одного символа «<span class="tex-font-style-tt">a</span>». </li><li> На <span class="tex-span"><i>k</i></span>-oм шаге Поликарп соединяет две копии строки, полученной на <span class="tex-span"><i>k</i> - 1</span> шаге, а между ними вставляет <span class="tex-span"><i>k</i></span>-й символ алфавита. Поликарп использует алфавит, состоящий из строчных латинских букв и цифр (всего 36 символов). Символы алфавита нумеруются следующим образом: 1-й символ — «<span class="tex-font-style-tt">a</span>», 2-й — «<span class="tex-font-style-tt">b</span>», ..., 26-й — «<span class="tex-font-style-tt">z</span>», 27-й — «<span class="tex-font-style-tt">0</span>», 28-й — «<span class="tex-font-style-tt">1</span>», ..., 36-й — «<span class="tex-font-style-tt">9</span>». </li></ul></p><p>Рассмотрим алгоритм подробнее. На втором шаге Поликарп соединит две строки «<span class="tex-font-style-tt">a</span>», вставив посередине символ «<span class="tex-font-style-tt">b</span>», и получит строку «<span class="tex-font-style-tt">aba</span>». На третьем шаге получится строка «<span class="tex-font-style-tt">abacaba</span>», а на четвертом — «<span class="tex-font-style-tt">abacabadabacaba</span>». Таким образом, строка, полученная на <span class="tex-span"><i>k</i></span>-ом шаге, будет состоять из <span class="tex-span">2<sup class="upper-index"><i>k</i></sup> - 1</span> символов. </p><p>Поликарп записал строку, полученную после 30 шагов данного алгоритма, и выбрал из нее две непустые подстроки. Ваша задача состоит в том, чтобы найти длину наибольшей общей подстроки двух подстрок, выбранных Поликарпом.</p><p>Подстрокой <span class="tex-span"><i>s</i>[<i>i</i>... <i>j</i>]</span> (<span class="tex-span">1 ≤ <i>i</i> ≤ <i>j</i> ≤ |<i>s</i>|</span>) строки <span class="tex-span"><i>s</i></span> = <span class="tex-span"><i>s</i><sub class="lower-index">1</sub><i>s</i><sub class="lower-index">2</sub>... <i>s</i><sub class="lower-index">|<i>s</i>|</sub></span> называется строка, равная <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub><i>s</i><sub class="lower-index"><i>i</i> + 1</sub>... <i>s</i><sub class="lower-index"><i>j</i></sub></span>. Например, подстрока <span class="tex-span"><i>s</i>[2...4]</span> строки <span class="tex-span"><i>s</i></span> = «<span class="tex-font-style-tt">abacaba</span>» равна «<span class="tex-font-style-tt">bac</span>». Сама строка является своей подстрокой.</p><p>Наибольшей общей подстрокой двух строк <span class="tex-span"><i>s</i></span> и <span class="tex-span"><i>t</i></span> называется самая длинная строка, которая является подстрокой как <span class="tex-span"><i>s</i></span>, так и <span class="tex-span"><i>t</i></span>. Например, наибольшей общей подстрокой «<span class="tex-font-style-tt">contest</span>» и «<span class="tex-font-style-tt">systemtesting</span>» является строка «<span class="tex-font-style-tt">test</span>». Общих подстрок наибольшей длины может существовать несколько.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>Входные данные состоят из одной строки, которая содержит четыре целых числа <span class="tex-span"><i>l</i><sub class="lower-index">1</sub></span>, <span class="tex-span"><i>r</i><sub class="lower-index">1</sub></span>, <span class="tex-span"><i>l</i><sub class="lower-index">2</sub></span>, <span class="tex-span"><i>r</i><sub class="lower-index">2</sub></span> (<span class="tex-span">1 ≤ <i>l</i><sub class="lower-index"><i>i</i></sub> ≤ <i>r</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>, <span class="tex-span"><i>i</i> = 1, 2</span>). Числа разделены единичными пробелами. Значения <span class="tex-span"><i>l</i><sub class="lower-index"><i>i</i></sub></span> и <span class="tex-span"><i>r</i><sub class="lower-index"><i>i</i></sub></span> задают индексы первого и последнего символов <span class="tex-span"><i>i</i></span>-ой выбранной подстроки, соответственно (<span class="tex-span"><i>i</i> = 1, 2</span>). Символы строки <span class="tex-font-style-it">абракадабра</span> нумеруются с <span class="tex-span">1</span>.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите единственное число — длину наибольшей общей подстроки заданных подстрок. Если общих подстрок нет, выведите 0.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>3 6 1 4<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>1 1 4 4<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>0<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом тесте первая подстрока равна «<span class="tex-font-style-tt">acab</span>», вторая — «<span class="tex-font-style-tt">abac</span>». У этих двух подстрок есть две наибольшие общие подстроки «<span class="tex-font-style-tt">ac</span>» и «<span class="tex-font-style-tt">ab</span>», нас же интересует только их длина — 2.</p><p>Во втором тесте первая подстрока равна «<span class="tex-font-style-tt">a</span>», вторая — «<span class="tex-font-style-tt">c</span>». У этих двух подстрок нет ни одного общего символа, поэтому длина наибольшей общей подстроки — 0.</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Расстояние в дереве</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>3 seconds</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>512 megabytes</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p><span class="tex-font-style-it">Деревом</span> называется связный граф, не содержащий циклов.</p><p><span class="tex-font-style-it">Расстоянием</span> между двумя вершинами дерева называется длина (в ребрах) кратчайшего пути между этими вершинами.</p><p>Дано дерево из <span class="tex-span"><i>n</i></span> вершин и положительное число <span class="tex-span"><i>k</i></span>. Посчитайте количество различных пар вершин дерева, расстояние между которыми равно <span class="tex-span"><i>k</i></span>. Обратите внимание, что пары (<span class="tex-span"><i>v</i></span>, <span class="tex-span"><i>u</i></span>) и (<span class="tex-span"><i>u</i></span>, <span class="tex-span"><i>v</i></span>) считаются одной и той же парой.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке записаны два целых числа <span class="tex-span"><i>n</i></span> и <span class="tex-span"><i>k</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 50000</span>, <span class="tex-span">1 ≤ <i>k</i> ≤ 500</span>) — количество вершин дерева и требуемое расстояние между вершинами.</p><p>В следующих <span class="tex-span"><i>n</i> - 1</span> строках записаны ребра дерева в формате «<span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span>» (без кавычек) (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span>, <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub> ≠ <i>b</i><sub class="lower-index"><i>i</i></sub></span>), где <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> и <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> — вершины дерева, соединенные <span class="tex-span"><i>i</i></span>-м ребром. Все заданные ребра различны.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите единственное целое число — количество различных пар вершин дерева, расстояние между которыми равно <span class="tex-span"><i>k</i></span>.</p><p>Пожалуйста, не используйте спецификатор <span class="tex-font-style-tt">%lld</span> для чтения или записи 64-х битовых чисел на С++. Рекомендуется использовать потоки <span class="tex-font-style-tt">cin</span>, <span class="tex-font-style-tt">cout</span> или спецификатор <span class="tex-font-style-tt">%I64d</span>.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>5 2<br />1 2<br />2 3<br />3 4<br />2 5<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>4<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>5 3<br />1 2<br />2 3<br />3 4<br />4 5<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом примере парами вершин, расстояние между которыми равно 2, будут пары (1, 3), (1, 5), (3, 5) и (2, 4).</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Медвежатник Поликарп</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>3 seconds</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 megabytes</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>У Поликарпа есть <span class="tex-span"><i>t</i></span> сейфов. Паролем от каждого сейфа является квадратная матрица из десятичных цифр '<span class="tex-font-style-tt">0</span>' ... '<span class="tex-font-style-tt">9</span>' (размеры паролей сейфов могут различаться). Увы, Поликарп забыл все пароли, и теперь ему предстоит их восстановить. </p><p>Поликарп любит простые числа, поэтому, когда он выбирал матрицы-пароли, он в каждую строку каждой матрицы вписал по простому числу. К своему удивлению, он обнаружил, что все матрицы получились симметричными (то есть после транспонирования остаются неизменными). Сейчас, годы спустя, к своей досаде Поликарп осознал, что он помнит только простые числа <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span>, записанные в первых строках матриц-паролей.</p><p>Для каждого сейфа найдите количество матриц, которые могут быть паролем к нему.</p><p>Количество цифр в <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span> определяет количество строк и столбцов <span class="tex-span"><i>i</i></span>-ой матрицы. Одно простое число может содержаться сразу в нескольких строках матрицы-пароля или в нескольких матрицах. Простые числа, записанные не в первой строке матрицы, могут иметь ведущие нули. </p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке входных данных записано целое число <span class="tex-span"><i>t</i></span> (<span class="tex-span">1 ≤ <i>t</i> ≤ 30</span>) — количество сейфов. Далее в <span class="tex-span"><i>t</i></span> строках записаны целые числа <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">10 ≤ <i>p</i><sub class="lower-index"><i>i</i></sub> ≤ 99999</span>), <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span> — простое число, записанное в первой строке матрицы-пароля для <span class="tex-span"><i>i</i></span>-ого сейфа. Все <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span> не содержат ведущих нулей.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите <span class="tex-span"><i>t</i></span> чисел, <span class="tex-span"><i>i</i></span>-ое из которых является количеством матриц, которые могут быть паролем к <span class="tex-span"><i>i</i></span>-ому сейфу. Числа выводите на отдельных строках.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>4<br />11<br />239<br />401<br />9001<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>4<br />28<br />61<br />2834<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>Пример возможной матрицы-пароля для второго сейфа: <pre><br />239<br />307<br />977<br /></pre></p><p>Пример возможной матрицы-пароля для четвертого сейфа: <pre><br />9001<br />0002<br />0002<br />1223 <br /></pre></p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>

    <br style="clear:both;"/>

    <div id="footer">
        <div><a href="http://codeforces.ru/">Codeforces</a> (c) Copyright 2010-2013 Михаил Мирзаянов</div>
        <div>Соревнования по программированию 2.0</div>

    </div>
</div>
</div>
</body>
</html>                                       
