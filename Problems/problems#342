
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="2752585ce22059f9853hgheh4df08f8b"/>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="http://worker.codeforces.ru/static/images/codeforces-vk-square-ru.png"/>
    <meta property="og:title" content="Задачи - Codeforces"/>
    <meta property="og:site_name" content="Codeforces"/>
    
    <meta name="cc" content="13620s6w21tj4"/>
    
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Задачи - Codeforces</title>
        <meta name="description" content="Codeforces. Соревнования и олимпиады по информатике и программированию, сообщество программистов" />
        <meta name="keywords" content="программирование информатика контест олимпиада алгоритмы c++ java графы vkcup" />
    <meta name="robots" content="index, follow" />

    <link href="http://worker.codeforces.ru/static/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

    <HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--CombineResourcesFilter-->
    
<LINK href="http://worker.codeforces.ru/static/favicon.png" rel="shortcut icon" type="image/png">
    
<LINK href="http://worker.codeforces.ru/static/css/prettify.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/clear.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/style.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/ttypography.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/problem-statement.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/second-level-menu.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/roundbox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/datatable.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/topic.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/table-form.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.jgrowl.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/facebox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.wysiwyg.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/codeforces.datepick.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/colorbox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.drafts.css" rel="stylesheet" type="text/css">
    
<LINK href="http://worker.codeforces.ru/static/markitup/skins/markitup/style.css" rel="stylesheet" type="text/css">
    
<LINK href="http://worker.codeforces.ru/static/markitup/sets/markdown/style.css" rel="stylesheet" type="text/css">

    
<SCRIPT charset="utf-8" src="//yandex.st/share/share.js" type="text/javascript"></SCRIPT>
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/sidebar-menu.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/community.css" rel="stylesheet" type="text/css">

    <!--[if IE]>
        <style>
            #sidebar {
                padding-left: 1em;
                margin: 1em 1em 1em 0;
            }
        </style>
    <![endif]-->
    
    
<SCRIPT src="http://worker.codeforces.ru/static/js/prettify/prettify.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery-1.8.3.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/sockjs-0.2.1.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/vertxbus-1.2.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.easing.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.lavalamp.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.jgrowl.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/facebox.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.wysiwyg.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.colorpicker.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.table.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.image.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.link.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.autocomplete.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.datepick.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.ie6blocker.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.colorbox-min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.ba-bbq.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.drafts.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/codeforces.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/markitup/jquery.markitup.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/markitup/sets/markdown/set.js" type="text/javascript"></SCRIPT>
    <!--/CombineResourcesFilter-->
</HEAD>
</HTML>

        <script type="text/javascript" src="http://worker.codeforces.ru/static/js/jquery.datepick-ru.js"></script>
        <script src="http://vk.com/js/api/openapi.js" type="text/javascript"></script>
</head>
<body><span style='display:none;' class='csrf-token' data-csrf='2752585ce22059f9853hgheh4df08f8b'>&nbsp;</span>
<!-- Codeforces javascripts. -->
<script type="text/javascript">
    VK.init({apiId: 1961905});
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>

    <script type="text/javascript">
        $(document).ready(function() {
    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    $(".second-level-menu-list").lavaLamp({
        fx: "backout",
        speed: 1000
    });


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


        });
    </script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<div id="body">
<div style="width: 950px; margin: 0 auto;">
    <div id="header" style="position:relative;">
        <div style="float:left;">
                <a href="/"><img src="http://worker.codeforces.ru/static/images/codeforces-logo-with-upper-beta.png"/></a>
                        <div style="position:absolute;left:97px;top:40px;">
                            <a href="http://vk.com" class="logo-href">При поддержке <img
                                    style="position:relative;top:5px;" src="http://worker.codeforces.ru/static/images/vkontakte-tiny-ru.png"/></a>
                        </div>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="http://worker.codeforces.ru/static/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="http://worker.codeforces.ru/static/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <div style="text-align: center;font-size: 18px;margin-bottom: 0.5em;"
         class="caption">Codeforces Round #199 (Div. 2)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Ксюша и делители</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>У математика Ксюши есть последовательность, состоящая из <span class="tex-span"><i>n</i></span> (<span class="tex-span"><i>n</i></span> делится на 3) целых положительных чисел, каждое из которых не больше 7. Она хочет разбить эту последовательность на тройки, так, чтобы для каждой тройки <span class="tex-span"><i>a</i>, <i>b</i>, <i>c</i></span> выполнялись условия:</p><p><ul> <li> <span class="tex-span"><i>a</i> &lt; <i>b</i> &lt; <i>c</i></span>; </li><li> <span class="tex-span"><i>a</i></span> делит <span class="tex-span"><i>b</i></span>, <span class="tex-span"><i>b</i></span> делит <span class="tex-span"><i>c</i></span>. </li></ul></p><p>Конечно, Ксюша хочет, чтобы каждый элемент последовательности принадлежал ровно одной тройке. Отсюда следует, что, если требуемое разбиение существует, то в нем <img align="middle" class="tex-formula" src="http://codeforces.ru/renderer/4de0f387b35d0865b1f96d528b2f1b06fb6f1903.png" /> троек.</p><p>Помогите Ксюше, найдите требуемое разбиение или сообщите, что такого не существует.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке записано целое число <span class="tex-span"><i>n</i></span> <span class="tex-span">(3 ≤ <i>n</i> ≤ 99999)</span> — количество элементов в последовательности. В следующей строке записаны <span class="tex-span"><i>n</i></span> целых положительных чисел, каждое из которых не больше 7.</p><p>Гарантируется, что <span class="tex-span"><i>n</i></span> делится на 3.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Если требуемое разбиение существует, выведите <img align="middle" class="tex-formula" src="http://codeforces.ru/renderer/4de0f387b35d0865b1f96d528b2f1b06fb6f1903.png" /> троек. Каждую тройку выводите как значения элементов, которые в нее входят. Значения выводите в порядке возрастания. Тройки и числа в тройках разделяйте пробельными символами. Если существует несколько решений, разрешается вывести любое.</p><p>Если решения не существует, выведите -1.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>6<br />1 1 1 2 2 2<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>-1<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>6<br />2 2 1 1 4 6<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>1 2 4<br />1 2 6<br /></pre></div></div></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Ксюша и шпионы</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Перед грозным детективом Ксюшей выстроились в ряд <span class="tex-span"><i>n</i></span> <span class="tex-span">(<i>n</i> ≥ 2)</span> иностранных шпионов. Будем считать, что шпионы пронумерованы от 1 до <span class="tex-span"><i>n</i></span> слева направо. </p><p>У шпиона номер <span class="tex-span"><i>s</i></span> хранится важная записка. Он должен передать ее шпиону номер <span class="tex-span"><i>f</i></span>. Допрос шпионов проходит в несколько этапов. В течение одного этапа шпион, у которого сейчас хранится важная записка, может передать записку одному из своих соседей в ряду. Другими словами, если этот шпион имеет номер <span class="tex-span"><i>x</i></span>, он может передать записку одному из шпионов <span class="tex-span"><i>x</i> - 1</span> или <span class="tex-span"><i>x</i> + 1</span> (если <span class="tex-span"><i>x</i> = 1</span> или <span class="tex-span"><i>x</i> = <i>n</i></span>, то у шпиона только один сосед). Также в течение этапа шпион может сохранить записку у себя и никому ее не передавать.</p><p>Но не все так просто, в течение <span class="tex-span"><i>m</i></span> этапов Ксюша пристально наблюдает за некоторыми шпионами. А именно, в течение этапа номер <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span> (этапы нумеруются, начиная с 1) Ксюша наблюдает за шпионами с номерами <span class="tex-span"><i>l</i><sub class="lower-index"><i>i</i></sub>, <i>l</i><sub class="lower-index"><i>i</i></sub> + 1, <i>l</i><sub class="lower-index"><i>i</i></sub> + 2, ..., <i>r</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span">(1 ≤ <i>l</i><sub class="lower-index"><i>i</i></sub> ≤ <i>r</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>)</span>. Конечно, если в течение какого-то этапа за шпионом наблюдают, он не может ни передавать записку, ни принимать ее от другого шпиона. Иначе Ксюша сразу раскроет хитрый заговор шпионов. Тем не менее, если шпион на текущем этапе сохраняет записку у себя, даже если Ксюша наблюдает за ним, она ничего не обнаружит.</p><p>Вам заданы <span class="tex-span"><i>s</i></span> и <span class="tex-span"><i>f</i></span>, а также в какие моменты и за кем следит Ксюша. Определите, как нужно действовать шпионам, чтобы передать записку от шпиона <span class="tex-span"><i>s</i></span> до шпиона <span class="tex-span"><i>f</i></span> как можно быстрее (за минимальное количество этапов).</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке записаны четыре целых числа <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>m</i></span>, <span class="tex-span"><i>s</i></span> и <span class="tex-span"><i>f</i></span> <span class="tex-span">(1 ≤ <i>n</i>, <i>m</i> ≤ 10<sup class="upper-index">5</sup>; 1 ≤ <i>s</i>, <i>f</i> ≤ <i>n</i>; <i>s</i> ≠ <i>f</i>; <i>n</i> ≥ 2)</span>. В каждой из следующих <span class="tex-span"><i>m</i></span> строк записаны три целых числа <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub>, <i>l</i><sub class="lower-index"><i>i</i></sub>, <i>r</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span">(1 ≤ <i>t</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup>, 1 ≤ <i>l</i><sub class="lower-index"><i>i</i></sub> ≤ <i>r</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>)</span>. Гарантируется, что <span class="tex-span"><i>t</i><sub class="lower-index">1</sub> &lt; <i>t</i><sub class="lower-index">2</sub> &lt; <i>t</i><sub class="lower-index">3</sub> &lt; ... &lt; <i>t</i><sub class="lower-index"><i>m</i></sub></span>.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите <span class="tex-span"><i>k</i></span> символов в одну строку: <span class="tex-span"><i>i</i></span>-ый символ в строке должен обозначать действие шпионов на этапе номер <span class="tex-span"><i>i</i></span>. Если на этапе номер <span class="tex-span"><i>i</i></span> шпион, у которого находится записка, должен передать ее шпиону с меньшим номером, <span class="tex-span"><i>i</i></span>-ый символ должен быть равен «<span class="tex-font-style-tt">L</span>». Если на этапе номер <span class="tex-span"><i>i</i></span> шпион, у которого находится записка, должен передать ее шпиону с большим номером, <span class="tex-span"><i>i</i></span>-ый символ должен быть равен «<span class="tex-font-style-tt">R</span>». Если шпион должен оставить записку у себя на <span class="tex-span"><i>i</i></span>-ом этапе, <span class="tex-span"><i>i</i></span>-ый символ должен быть равен «<span class="tex-font-style-tt">X</span>».</p><p>В результате применения выведенной последовательности действий шпион <span class="tex-span"><i>s</i></span> должен передать записку шпиону <span class="tex-span"><i>f</i></span>. Количество выведенных символов <span class="tex-span"><i>k</i></span> должно быть как можно меньше. Ксюша не должна обнаружить, что шпионы передают записку.</p><p>Если существует несколько оптимальных ответов, разрешается вывести любой. Гарантируется, что ответ существует.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>3 5 1 3<br />1 1 2<br />2 2 3<br />3 3 3<br />4 1 1<br />10 1 3<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>XXRR<br /></pre></div></div></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Шкаф и шарики</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>У девочки Ксюши есть шкаф, который спереди выглядит как арка, составленная из полуокружности радиуса <span class="tex-span"><i>r</i></span> (верх шкафа) и двух стенок высоты <span class="tex-span"><i>h</i></span> (боковые стороны шкафа). Шкаф имеет глубину <span class="tex-span"><i>r</i></span>, то есть сбоку он выглядит как прямоугольник с основанием <span class="tex-span"><i>r</i></span> и высотой <span class="tex-span"><i>h</i> + <i>r</i></span>. На рисунке ниже изображено, как выглядит этот шкаф (слева — вид спереди, справа — вид сбоку).</p><p><center> <img class="tex-graphics" src="http://codeforces.ru/renderer/0d3a8ee208fe4f3ad9899a205032d363d083f939.png" /> </center></p><p>На день рождения Ксюше подарили очень много шариков. Ксюша не любит беспорядок, поэтому она хочет сложить шарики в шкаф. По счастливой случайности каждый шарик — это сфера, радиус который в точности равен <img align="middle" class="tex-formula" src="http://codeforces.ru/renderer/a4fcadf5554db1a524f8d91fc4f6fb6d9fa61718.png" />. Помогите Ксюше определить, какое максимальное количество шариков она может положить в свой шкаф. </p><p>Считается, что шарик положен в шкаф, если никакую часть шарика нельзя увидеть, посмотрев на шкаф сбоку (справа или слева). В шкафу шарики могут касаться друг друга. Сжимать шарики или как-то по другому их деформировать запрещается. Можете считать, что толщина стенок шкафа пренебрежимо мала.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке записано два целых числа <span class="tex-span"><i>r</i>, <i>h</i></span> <span class="tex-span">(1 ≤ <i>r</i>, <i>h</i> ≤ 10<sup class="upper-index">7</sup>)</span>.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите единственное целое число — максимальное количество шариков, которое поместится в шкаф.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>1 1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>3<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>1 2<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>5<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>2 1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2<br /></pre></div></div></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Ксюша и доминошки</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Ксюша очень любит пазлы, особенно ей нравятся пазлы, состоящие из доминошек. Посмотрите на рисунок, изображающий один из таких пазлов.</p><p><center> <img class="tex-graphics" src="http://codeforces.ru/renderer/a6560894a63126fb43e521f1e985f235713ed3e7.png" /> </center></p><p>Пазл представляет собой таблицу размера <span class="tex-span">3 × <i>n</i></span> клеток с запрещенными клетками (черные квадраты), на которой лежат доминошки (цветные прямоугольники на рисунке). Пазл считается <span class="tex-font-style-it">корректным</span>, если выполняются следующие условия:</p><p><ul> <li> каждая доминошка занимает ровно две не запрещенные клетки таблицы; </li><li> никакие две доминошки не занимают одну и ту же клетку таблицы; </li><li> ровно одна не запрещенная клетка таблицы не занята никакой доминошкой (на рисунке отмечена кружочком). </li></ul></p><p>Чтобы решить пазл нужно за несколько ходов переместить пустую клетку из начального положения в некоторое заданное. Ходом считается перемещение доминошки на пустую клетку, так чтобы пазл оставался корректным. <span class="tex-font-style-bf">Горизонтальные доминошки могут быть перемещены только по горизонтали, а вертикальные только по вертикали. Поворачивать доминошки не разрешается.</span> На рисунке изображен возможный ход.</p><p>У Ксюши есть таблица размера <span class="tex-span">3 × <i>n</i></span> клеток с запрещенными клетками и помеченной кружочком клеткой. Также у Ксюши есть очень много одинаковых доминошек. Теперь Ксюша интересуется, сколько различных корректных пазлов она сможет составить, размещая доминошки на имеющейся таблице. Дополнительно Ксюша хочет, чтобы помеченная кружочком клетка была пустой в полученном пазле и чтобы в пазле существовал хотя бы один ход.</p><p>Помогите Ксюше, посчитайте описанное количество пазлов. Так как описанное количество может быть достаточно большим, выведите его остаток от деления на число <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup> + 7)</span>.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке записано целое число <span class="tex-span"><i>n</i></span> <span class="tex-span">(3 ≤ <i>n</i> ≤ 10<sup class="upper-index">4</sup>)</span> — размер пазла. В каждой из следующих трех строк записаны по <span class="tex-span"><i>n</i></span> символов — описание имеющейся таблицы. Символ номер <span class="tex-span"><i>j</i></span> строки номер <span class="tex-span"><i>i</i></span> равен «<span class="tex-font-style-tt">X</span>», если соответствующая клетка запрещенная; равен «<span class="tex-font-style-tt">.</span>», если соответствующая клетка не запрещенная, равен «<span class="tex-font-style-tt">O</span>», если соответствующая клетка помечена кружочком.</p><p>Гарантируется, что в таблице ровно одна клетка помечена кружочком. Гарантируется, что все клетки заданной таблицы, имеющие хотя бы одну общую точку с помеченной клеткой не заблокированы.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите единственное целое число — ответ на задачу по модулю <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup> + 7)</span>.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>5<br />....X<br />.O...<br />...X.<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>1<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>5<br />.....<br />.O...<br />.....<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>3<br />...<br />...<br />..O<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>4<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>Два пазла считаются различными, если существует пара клеток, занятых в одном из них одной доминошкой, а в другом — нет.</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Ксюша и дерево</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>5 секунд</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>У программиста Ксюши есть дерево, состоящее из <span class="tex-span"><i>n</i></span> вершин. Будем считать, что вершины дерева пронумерованы от 1 до <span class="tex-span"><i>n</i></span>. Также будем считать, что первоначально вершина номер 1 покрашена в красный цвет, а остальные вершины покрашены в синий цвет.</p><p><span class="tex-font-style-it">Расстоянием</span> между двумя вершинами дерева <span class="tex-span"><i>v</i></span> и <span class="tex-span"><i>u</i></span> будем называть количество ребер в кратчайшем пути между <span class="tex-span"><i>v</i></span> и <span class="tex-span"><i>u</i></span>.</p><p>Ксюше нужно научиться быстро выполнять запросы двух видов:</p><p><ol> <li> покрасить заданную синюю вершину в красный цвет; </li><li> посчитать, какая красная вершина ближе всего к заданной и вывести кратчайшее расстояние до ближайшей красной вершины. </li></ol></p><p>Ваша задача — написать программу, которая будет выполнять описанные запросы.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке записаны два целых числа <span class="tex-span"><i>n</i></span> и <span class="tex-span"><i>m</i></span> <span class="tex-span">(2 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup>, 1 ≤ <i>m</i> ≤ 10<sup class="upper-index">5</sup>)</span> — количество вершин в дереве и количество запросов. В следующих <span class="tex-span"><i>n</i> - 1</span> строках заданы ребра дерева, в <span class="tex-span"><i>i</i></span>-ой строке записана пара целых чисел <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span">(1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>, <i>a</i><sub class="lower-index"><i>i</i></sub> ≠ <i>b</i><sub class="lower-index"><i>i</i></sub>)</span> — очередное ребро дерева.</p><p>В следующих <span class="tex-span"><i>m</i></span> строках заданы запросы. Каждый запрос задан как пара целых чисел <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub>, <i>v</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span">(1 ≤ <i>t</i><sub class="lower-index"><i>i</i></sub> ≤ 2, 1 ≤ <i>v</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>)</span>. Если <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub> = 1</span>, то в ответ на запрос нужно покрасить синюю вершину <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span> в красный цвет. Если <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub> = 2</span>, то в ответ на запрос нужно вывести кратчайшее расстояние от некоторой красной вершины до вершины <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span>.</p><p>Гарантируется, что заданный граф является деревом и что запросы корректны.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Для каждого запроса второго типа выведите ответ на отдельной строке.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>5 4<br />1 2<br />2 3<br />2 4<br />4 5<br />2 1<br />2 5<br />1 2<br />2 5<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>0<br />3<br />2<br /></pre></div></div></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>

    <br style="clear:both;"/>

    <div id="footer">
        <div><a href="http://codeforces.ru/">Codeforces</a> (c) Copyright 2010-2013 Михаил Мирзаянов</div>
        <div>Соревнования по программированию 2.0</div>

    </div>
</div>
</div>
</body>
</html>                                       
