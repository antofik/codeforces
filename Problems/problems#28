
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="9acg74g3654da673cd2e2ahc5h0c5g58"/>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="http://worker.codeforces.ru/static/images/codeforces-vk-square-ru.png"/>
    <meta property="og:title" content="Задачи - Codeforces"/>
    <meta property="og:site_name" content="Codeforces"/>
    
    <meta name="cc" content="1rru5rm6htglw"/>
    
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Задачи - Codeforces</title>
        <meta name="description" content="Codeforces. Соревнования и олимпиады по информатике и программированию, сообщество программистов" />
        <meta name="keywords" content="программирование информатика контест олимпиада алгоритмы c++ java графы vkcup" />
    <meta name="robots" content="index, follow" />

    <link href="http://worker.codeforces.ru/static/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

    <HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--CombineResourcesFilter-->
    
<LINK href="http://worker.codeforces.ru/static/favicon.png" rel="shortcut icon" type="image/png">
    
<LINK href="http://worker.codeforces.ru/static/css/prettify.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/clear.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/style.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/ttypography.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/problem-statement.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/second-level-menu.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/roundbox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/datatable.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/topic.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/table-form.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.jgrowl.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/facebox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.wysiwyg.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/codeforces.datepick.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/colorbox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.drafts.css" rel="stylesheet" type="text/css">
    
<LINK href="http://worker.codeforces.ru/static/markitup/skins/markitup/style.css" rel="stylesheet" type="text/css">
    
<LINK href="http://worker.codeforces.ru/static/markitup/sets/markdown/style.css" rel="stylesheet" type="text/css">

    
<SCRIPT charset="utf-8" src="//yandex.st/share/share.js" type="text/javascript"></SCRIPT>
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/sidebar-menu.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/community.css" rel="stylesheet" type="text/css">

    <!--[if IE]>
        <style>
            #sidebar {
                padding-left: 1em;
                margin: 1em 1em 1em 0;
            }
        </style>
    <![endif]-->
    
    
<SCRIPT src="http://worker.codeforces.ru/static/js/prettify/prettify.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery-1.8.3.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/sockjs-0.2.1.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/vertxbus-1.2.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.easing.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.lavalamp.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.jgrowl.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/facebox.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.wysiwyg.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.colorpicker.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.table.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.image.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.link.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.autocomplete.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.datepick.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.ie6blocker.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.colorbox-min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.ba-bbq.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.drafts.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/codeforces.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/markitup/jquery.markitup.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/markitup/sets/markdown/set.js" type="text/javascript"></SCRIPT>
    <!--/CombineResourcesFilter-->
</HEAD>
</HTML>

        <script type="text/javascript" src="http://worker.codeforces.ru/static/js/jquery.datepick-ru.js"></script>
        <script src="http://vk.com/js/api/openapi.js" type="text/javascript"></script>
</head>
<body><span style='display:none;' class='csrf-token' data-csrf='9acg74g3654da673cd2e2ahc5h0c5g58'>&nbsp;</span>
<!-- Codeforces javascripts. -->
<script type="text/javascript">
    VK.init({apiId: 1961905});
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>

    <script type="text/javascript">
        $(document).ready(function() {
    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    $(".second-level-menu-list").lavaLamp({
        fx: "backout",
        speed: 1000
    });


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


        });
    </script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<div id="body">
<div style="width: 950px; margin: 0 auto;">
    <div id="header" style="position:relative;">
        <div style="float:left;">
                <a href="/"><img src="http://worker.codeforces.ru/static/images/codeforces-logo-with-upper-beta.png"/></a>
                        <div style="position:absolute;left:97px;top:40px;">
                            <a href="http://vk.com" class="logo-href">При поддержке <img
                                    style="position:relative;top:5px;" src="http://worker.codeforces.ru/static/images/vkontakte-tiny-ru.png"/></a>
                        </div>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="http://worker.codeforces.ru/static/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="http://worker.codeforces.ru/static/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <div style="text-align: center;font-size: 18px;margin-bottom: 0.5em;"
         class="caption">Codeforces Beta Round #28 (Codeforces format)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Задача Бендера</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 seconds</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 megabytes</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Робот Бендер решил сделать Фраю подарок на день рождения. Он вбил <span class="tex-span"><i>n</i></span> гвоздей и в определенном порядке пронумеровал их. Робот решил сделать из имеющихся у него железных прутьев картину, представляющую собой замкнутую ломаную, вершинами которой являются гвозди в заданном порядке, а отрезки ломаной параллельны осям координат. Самопересечения допускаются. Бендер может взять подходящий прут, согнуть его ровно один раз в любом месте под углом 90 градусов и прикрепить местом сгиба к еще не занятому гвоздю, а два конца прикрепить к двум соседним. Гвоздь считается незанятым, если к нему не прикреплен ни один прут (ни конец, ни место сгиба). Никакой прут нельзя использовать дважды. Вы можете использовать не все прутья.</p><p>Помогите Бендеру решить эту непростую задачу.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке даны два натуральных числа <span class="tex-span"><i>n</i></span> и <span class="tex-span"><i>m</i></span> (<span class="tex-span">4 ≤ <i>n</i> ≤ 500, 2 ≤ <i>m</i> ≤ 500</span>, <span class="tex-span"><i>n</i></span> четно) — количество гвоздей и прутьев соответственно. В следующих <span class="tex-span"><i>n</i></span> строках даны координаты гвоздей в том порядке, в котором они соединяются ломаной. В <span class="tex-span">(<i>n</i> + 2)</span>-ой строке заданы <span class="tex-span"><i>m</i></span> чисел — длины прутьев. Все координаты — целые числа, не превосходящие по модулю <span class="tex-span">10<sup class="upper-index">4</sup></span>. Длины прутьев — целые числа от <span class="tex-span">1</span> до <span class="tex-span">200 000</span>. Никакой прут нельзя использовать дважды. Гарантируется, что все отрезки заданной ломаной параллельны осям координат и никакие 3 подряд идущих гвоздя не лежат на одной прямой.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Если задача Бендера неразрешима, выведите <span class="tex-font-style-tt">NO</span>. Иначе в первой строке выведите <span class="tex-font-style-tt">YES</span>, а во второй строке выведите <span class="tex-span"><i>n</i></span> чисел — <span class="tex-span"><i>i</i></span>-ое число — номер прута, место сгиба которого прикреплена к <span class="tex-span"><i>i</i></span>-ому гвоздю, или <span class="tex-font-style-tt">-1</span>, если нет такого прута.</p><p>Если решений несколько, выведите любое.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>4 2<br />0 0<br />0 2<br />2 2<br />2 0<br />4 4<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>YES<br />1 -1 2 -1 <br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>6 3<br />0 0<br />1 0<br />1 1<br />2 1<br />2 2<br />0 2<br />3 2 3<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>YES<br />1 -1 2 -1 3 -1 <br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>6 3<br />0 0<br />1 0<br />1 1<br />2 1<br />2 2<br />0 2<br />2 2 3<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>NO<br /></pre></div></div></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. pSort</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 seconds</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 megabytes</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Однажды <span class="tex-span"><i>n</i></span> ячеек одного массива решили поиграть в некоторую игру. Сначала каждая ячейка записала в себя свой порядковый номер (считая с <span class="tex-span">1</span>), а затем каждая ячейка назвала свое любимое число. На своем ходе <span class="tex-span"><i>i</i></span>-ая ячейка могла поменять местами свое содержимое и содержимое <span class="tex-span"><i>j</i></span>-ой ячейки, если <span class="tex-span">|<i>i</i> - <i>j</i>| = <i>d</i><sub class="lower-index"><i>i</i></sub></span>, где <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span> — любимое число <span class="tex-span"><i>i</i></span>-ой ячейки. «Игроки» ходят в любом порядке, в каком захотят. Количество ходов не ограничено.</p><p>Вам дана перестановка чисел от <span class="tex-span">1</span> до <span class="tex-span"><i>n</i></span> и любимые числа ячеек. Ваша задача ответить: может ли игра зайти в такое положение.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке дано натуральное число <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 100</span>) — количество ячеек в массиве. Во второй строке задано <span class="tex-span"><i>n</i></span> различных целых чисел от <span class="tex-span">1</span> до <span class="tex-span"><i>n</i></span> — заданная перестановка. В третьей строке задано <span class="tex-span"><i>n</i></span> целых чисел от <span class="tex-span">1</span> до <span class="tex-span"><i>n</i></span> — любимые числа ячеек.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Если игра могла зайти в заданное положение выведите <span class="tex-font-style-tt">YES</span>, иначе выведите <span class="tex-font-style-tt">NO</span>.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>5<br />5 4 3 2 1<br />1 1 1 1 1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>YES<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>7<br />4 3 5 1 2 7 6<br />4 6 6 1 6 6 1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>NO<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>7<br />4 2 5 1 3 7 6<br />4 6 6 1 6 6 1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>YES<br /></pre></div></div></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Очереди к умывальникам</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 seconds</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 megabytes</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>В одном общежитии одного университета живет <span class="tex-span"><i>n</i></span> студентов. Так как у всех пары начинаются в одно и то же время, расстояние до университета для всех одинаково и, как ни странно, все ходят на все пары, все <span class="tex-span"><i>n</i></span> студентов просыпаются одновременно.</p><p>Также на этаже находится <span class="tex-span"><i>m</i></span> комнат с умывальниками и в <span class="tex-span"><i>i</i></span>-ой комнате — <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> умывальников. Утром, как только все просыпаются, каждый студент равновероятно и независимо от других выбирает одну из <span class="tex-span"><i>m</i></span> комнат, в которую он пойдет умываться. После того, как студенты распределились по комнатам, внутри каждой комнаты студенты делятся на максимально равные очереди, по одной к каждому умывальнику. Т. е. они делятся на очереди так, чтобы размер самой длинной очереди был как можно меньше. Ваша задача выяснить математическое ожидание длины максимальной из очередей по всем комнатам, чтобы администрация могла улучшить общежитие и помочь студентам не опаздывать на пары. </p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке заданы два целых положительных числа <span class="tex-span"><i>n</i></span> и <span class="tex-span"><i>m</i></span> (<span class="tex-span">1 ≤ <i>n</i>, <i>m</i> ≤ 50</span>) — количество студентов и комнат с умывальниками соответственно. Во второй строке задано <span class="tex-span"><i>m</i></span> чисел: <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ... , <i>a</i><sub class="lower-index"><i>m</i></sub></span> (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> ≤ 50</span>). <span class="tex-span"><i>i</i></span>-ое число означает количество умывальников в <span class="tex-span"><i>i</i></span>-ой комнате.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите единственное число: математическое ожидание длины максимальной очереди. Ваш ответ должен иметь относительную или абсолютную погрешность меньше чем <span class="tex-span">10<sup class="upper-index"> - 9</sup></span>.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>1 1<br />2<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>1.00000000000000000000<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>2 2<br />1 1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>1.50000000000000000000<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>2 3<br />1 1 1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>1.33333333333333350000<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>7 5<br />1 1 2 3 1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2.50216960000000070000<br /></pre></div></div></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Не бойтесь, ДравДэ добрый</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 seconds</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 megabytes</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Колонна из <span class="tex-span"><i>n</i></span> грузовиков, направляющаяся из города «Z» в город «З» подошла к туннелю, известному, как туннель Ужаса. Страшные слухи ходили среди водителей грузовиков о монстре ДравДэ, который охотится в этом туннеле. Некоторые водители боялись ехать первыми, некоторые последними, но рассмотрим более общий случай. Каждый грузовик характеризуется четырьмя числами: <ul> <li> <span class="tex-span"><i>v</i></span> — ценность этого грузовика, его пассажиров и груза </li><li> <span class="tex-span"><i>c</i></span> — количество пассажиров в грузовике, считая водителя </li><li> <span class="tex-span"><i>l</i></span> — суммарное количество человек, которое должно ехать впереди этого грузовика, чтобы водитель смог побороть страх («если монстр появится спереди, то он съест сначала их») </li><li> <span class="tex-span"><i>r</i></span> — суммарное количество человек, которое должно ехать позади этого грузовика, чтобы водитель смог побороть страх («если монстр появится сзади, то он съест сначала их»). </li></ul></p><p>Так как дорога узкая, то от появления ДравДэ сбоку никак не спастись. Более того, нельзя даже перестроить колонну. Относительный порядок машин изменить невозможно, но можно любую машину убрать из колонны, оставив её перед туннелем на неопределенный срок. Ваша задача, как начальника колонны, состоит в том, чтобы убрать некоторые грузовики так, чтобы оставшаяся колонна могла ехать и сумма ценностей проехавших грузовиков была максимальна.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке входного файла задано целое число <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup></span>) — количество грузовиков в колонне. В следующих <span class="tex-span"><i>n</i></span> строках содержится по четыре числа. Числа в <span class="tex-span"><i>i</i></span>-той строке: <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub>, <i>c</i><sub class="lower-index"><i>i</i></sub>, <i>l</i><sub class="lower-index"><i>i</i></sub>, <i>r</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>v</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">4</sup>, 1 ≤ <i>c</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">5</sup>, 0 ≤ <i>l</i><sub class="lower-index"><i>i</i></sub>, <i>r</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">5</sup></span>) — описывают <span class="tex-span"><i>i</i></span>-й грузовик. Грузовики нумеруются с 1, считая от головы колонны.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>В первой строке выведите число <span class="tex-span"><i>k</i></span> — количество грузовиков, которые проедут через туннель. Во второй строке выведите <span class="tex-span"><i>k</i></span> чисел — номера этих грузовиков в порядке возрастания. Не забудьте, что относительный порядок грузовиков менять нельзя. Если решений несколько, выведите любое.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>5<br />1 1 0 3<br />1 1 1 2<br />1 1 2 1<br />1 1 3 0<br />2 1 3 0<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>4<br />1 2 3 5 <br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>5<br />1 1 0 3<br />10 1 2 1<br />2 2 1 1<br />10 1 1 2<br />3 1 3 0<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>3<br />1 3 5 <br /></pre></div></div></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. ДравДэ спасает мир</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 seconds</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 megabytes</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>О ужас! Империя галактических куриц пытается захватить прекрасный город «З», они построили огромный куриный инкубатор, производящий миллионы куриц-воинов в день, и огородили его забором. Огромный инкубатор имеет вид многоугольника с внутренностью на плоскости <span class="tex-span"><i>Oxy</i></span> с <span class="tex-span"><i>n</i></span> вершинами. Естественно, ДравДэ не сидит на месте, он хочет разрушить империю куриц. И конечно же начнет он с инкубатора. </p><p>ДравДэ находится строго вне территории инкубатора в точке <span class="tex-span"><i>A</i>(<i>x</i><sub class="lower-index"><i>a</i></sub>, <i>y</i><sub class="lower-index"><i>a</i></sub>)</span> и хочет попасть внутрь и поубивать всех куриц, работающих там. Но не всё так просто! Дело в том что ДравДэ недавно катался на роликах и сломал обе ноги, и попасть на территорию инкубатора ему поможет его реактивный самолет ЛЕВАП-41. </p><p>ЛЕВАП-41 летает со скоростью <span class="tex-span"><i>V</i>(<i>x</i><sub class="lower-index"><i>v</i></sub>, <i>y</i><sub class="lower-index"><i>v</i></sub>, <i>z</i><sub class="lower-index"><i>v</i></sub>)</span>. ДравДэ может сесть на него в точке <span class="tex-span"><i>A</i></span>, пролететь некоторое время, а потом десантироваться. ДравДэ очень тяжелый и поэтому летит вертикально вниз со скоростью <span class="tex-span"><i>F</i><sub class="lower-index"><i>down</i></sub></span>, но в любой точке своего свободного полёта ДравДэ может открыть парашют и с этого момента ДравДэ будет лететь со скоростью ветра <span class="tex-span"><i>U</i>(<i>x</i><sub class="lower-index"><i>u</i></sub>, <i>y</i><sub class="lower-index"><i>u</i></sub>, <i>z</i><sub class="lower-index"><i>u</i></sub>)</span> до тех пор пока не приземлится. К сожалению, ДравДэ не силен в математике. Помогите бедному спасателю мира так выбрать план десантирования, чтобы приземлиться на территорию инкубатора. В первую очередь ДравДэ хочет минимизировать время своего полета на самолете, а во вторую — время своего свободного полета до открытия парашюта.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке задано число <span class="tex-span"><i>n</i></span> (<span class="tex-span">3 ≤ <i>n</i> ≤ 10<sup class="upper-index">4</sup></span>) — количество вершин в заборе инкубатора. Далее <span class="tex-span"><i>n</i></span> строк содержащих координаты вершин забора (два целых числа <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub>, <i>y</i><sub class="lower-index"><i>i</i></sub></span>) в порядке обхода по или против часовой стрелки. Гарантируется, что забор не содержит самокасаний и самопересечений.</p><p>В следующих четырех строках заданы координаты точки <span class="tex-span"><i>A</i>(<i>x</i><sub class="lower-index"><i>a</i></sub>, <i>y</i><sub class="lower-index"><i>a</i></sub>)</span>, скорости <span class="tex-span"><i>V</i>(<i>x</i><sub class="lower-index"><i>v</i></sub>, <i>y</i><sub class="lower-index"><i>v</i></sub>, <i>z</i><sub class="lower-index"><i>v</i></sub>)</span>, <span class="tex-span"><i>F</i><sub class="lower-index"><i>down</i></sub></span> и скорость <span class="tex-span"><i>U</i>(<i>x</i><sub class="lower-index"><i>u</i></sub>, <i>y</i><sub class="lower-index"><i>u</i></sub>, <i>z</i><sub class="lower-index"><i>u</i></sub>)</span>. Все числа во входных данных целые и по модулю не превосходят <span class="tex-span">10<sup class="upper-index">4</sup></span>. Гарантируется, что <span class="tex-span"><i>z</i><sub class="lower-index"><i>v</i></sub> &gt; 0</span> и <span class="tex-span"><i>F</i><sub class="lower-index"><i>down</i></sub>, <i>z</i><sub class="lower-index"><i>u</i></sub> &lt; 0</span>, а точка <span class="tex-span"><i>A</i></span> находится строго снаружи инкубатора.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>В первую строку выведите два числа <span class="tex-span"><i>t</i><sub class="lower-index">1</sub>, <i>t</i><sub class="lower-index">2</sub></span> такие, что если ДравДэ десантируется во время <span class="tex-span"><i>t</i><sub class="lower-index">1</sub></span>, считая от начала полёта, и потом откроет парашют через время <span class="tex-span"><i>t</i><sub class="lower-index">2</sub></span> после десантирования, он попадет на территорию инкубатора (попадание на границу территории считается попаданием на территорию). Если ДравДэ не должен открывать парашют, то второе число должно быть равно длительности полёта. Если ДравДэ никак не может попасть на территорию инкубатора, выведите <span class="tex-font-style-tt">-1 -1</span>. Если решений несколько, выведите минимальное по <span class="tex-span"><i>t</i><sub class="lower-index">1</sub></span>, а при равенстве <span class="tex-span"><i>t</i><sub class="lower-index">1</sub></span> — минимальное по <span class="tex-span"><i>t</i><sub class="lower-index">2</sub></span>. Ваш ответ должен иметь относительную или абсолютную погрешность меньше чем <span class="tex-span">10<sup class="upper-index"> - 6</sup></span>.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>4<br />0 0<br />1 0<br />1 1<br />0 1<br />0 -1<br />1 0 1<br />-1<br />0 1 -1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>1.00000000 0.00000000<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>4<br />0 0<br />0 1<br />1 1<br />1 0<br />0 -1<br />-1 -1 1<br />-1<br />0 1 -1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>-1.00000000 -1.00000000<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>4<br />0 0<br />1 0<br />1 1<br />0 1<br />0 -1<br />1 1 1<br />-1<br />1 1 -1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>0.50000000 0.00000000<br /></pre></div></div></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>

    <br style="clear:both;"/>

    <div id="footer">
        <div><a href="http://codeforces.ru/">Codeforces</a> (c) Copyright 2010-2013 Михаил Мирзаянов</div>
        <div>Соревнования по программированию 2.0</div>

    </div>
</div>
</div>
</body>
</html>                                       
