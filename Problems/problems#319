
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="hdf4ea15d0h2ccd34b4ab88ff5729agd"/>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="http://worker.codeforces.ru/static/images/codeforces-vk-square-ru.png"/>
    <meta property="og:title" content="Задачи - Codeforces"/>
    <meta property="og:site_name" content="Codeforces"/>
    
    <meta name="cc" content="1saljbcppqodo"/>
    
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Задачи - Codeforces</title>
        <meta name="description" content="Codeforces. Соревнования и олимпиады по информатике и программированию, сообщество программистов" />
        <meta name="keywords" content="программирование информатика контест олимпиада алгоритмы c++ java графы vkcup" />
    <meta name="robots" content="index, follow" />

    <link href="http://worker.codeforces.ru/static/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

    <HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--CombineResourcesFilter-->
    
<LINK href="http://worker.codeforces.ru/static/favicon.png" rel="shortcut icon" type="image/png">
    
<LINK href="http://worker.codeforces.ru/static/css/prettify.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/clear.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/style.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/ttypography.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/problem-statement.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/second-level-menu.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/roundbox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/datatable.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/topic.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/table-form.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.jgrowl.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/facebox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.wysiwyg.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/codeforces.datepick.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/colorbox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.drafts.css" rel="stylesheet" type="text/css">
    
<LINK href="http://worker.codeforces.ru/static/markitup/skins/markitup/style.css" rel="stylesheet" type="text/css">
    
<LINK href="http://worker.codeforces.ru/static/markitup/sets/markdown/style.css" rel="stylesheet" type="text/css">

    
<SCRIPT charset="utf-8" src="//yandex.st/share/share.js" type="text/javascript"></SCRIPT>
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/sidebar-menu.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/community.css" rel="stylesheet" type="text/css">

    <!--[if IE]>
        <style>
            #sidebar {
                padding-left: 1em;
                margin: 1em 1em 1em 0;
            }
        </style>
    <![endif]-->
    
    
<SCRIPT src="http://worker.codeforces.ru/static/js/prettify/prettify.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery-1.8.3.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/sockjs-0.2.1.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/vertxbus-1.2.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.easing.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.lavalamp.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.jgrowl.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/facebox.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.wysiwyg.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.colorpicker.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.table.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.image.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.link.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.autocomplete.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.datepick.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.ie6blocker.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.colorbox-min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.ba-bbq.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.drafts.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/codeforces.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/markitup/jquery.markitup.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/markitup/sets/markdown/set.js" type="text/javascript"></SCRIPT>
    <!--/CombineResourcesFilter-->
</HEAD>
</HTML>

        <script type="text/javascript" src="http://worker.codeforces.ru/static/js/jquery.datepick-ru.js"></script>
        <script src="http://vk.com/js/api/openapi.js" type="text/javascript"></script>
</head>
<body><span style='display:none;' class='csrf-token' data-csrf='hdf4ea15d0h2ccd34b4ab88ff5729agd'>&nbsp;</span>
<!-- Codeforces javascripts. -->
<script type="text/javascript">
    VK.init({apiId: 1961905});
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>

    <script type="text/javascript">
        $(document).ready(function() {
    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    $(".second-level-menu-list").lavaLamp({
        fx: "backout",
        speed: 1000
    });


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


        });
    </script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<div id="body">
<div style="width: 950px; margin: 0 auto;">
    <div id="header" style="position:relative;">
        <div style="float:left;">
                <a href="/"><img src="http://worker.codeforces.ru/static/images/codeforces-logo-with-upper-beta.png"/></a>
                        <div style="position:absolute;left:97px;top:40px;">
                            <a href="http://vk.com" class="logo-href">При поддержке <img
                                    style="position:relative;top:5px;" src="http://worker.codeforces.ru/static/images/vkontakte-tiny-ru.png"/></a>
                        </div>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="http://worker.codeforces.ru/static/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="http://worker.codeforces.ru/static/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <div style="text-align: center;font-size: 18px;margin-bottom: 0.5em;"
         class="caption">Codeforces Round #189 (Div. 1)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Танцевальный клуб Малека</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>1 секунда</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>По традиции, каждый год перед международной олимпиадой по информатике все участники фан-клуба Наталии приглашаются в танц-клуб Малека для приятного времяпрепровождения. Танц-клуб Малека насчитывает <span class="tex-span">2<sup class="upper-index"><i>n</i></sup></span> участников и по совпадению, фан-клуб Наталии также насчитывает <span class="tex-span">2<sup class="upper-index"><i>n</i></sup></span> участников. Каждому участнику ТКМ приписывается уникальный номер <span class="tex-span"><i>i</i></span> от <span class="tex-span">0</span> до <span class="tex-span">2<sup class="upper-index"><i>n</i></sup> - 1</span>. То же самое верно для каждого участника ФКН.</p><p>Среди прочего, встречи традиционно включают парный танец, где каждый участник ТКМ танцует с участником ФКН. Пара в танце — это такая пара чисел <span class="tex-span">(<i>a</i>, <i>b</i>)</span>, что участник номер <span class="tex-span"><i>a</i></span> из ТКМ танцует с участником номер <span class="tex-span"><i>b</i></span> из ФКН.</p><p>Назовем сложностью распределения пар количество пар танцующих пар <span class="tex-span">(<i>a</i>, <i>b</i>)</span> и <span class="tex-span">(<i>c</i>, <i>d</i>)</span>, таких, что <span class="tex-span"><i>a</i> &lt; <i>c</i></span> и <span class="tex-span"><i>b</i> &gt; <i>d</i></span>.</p><p>Вам дано двоичное число <span class="tex-span"><i>x</i></span> длины <span class="tex-span"><i>n</i></span>. Мы знаем, что участник номер <span class="tex-span"><i>i</i></span> из ТКМ танцует с участником номер <img align="middle" class="tex-formula" src="http://codeforces.ru/renderer/064f62f758022f9f352d238ee5ed93ec9a92138b.png" /> из ФКН. Ваша задача — высчитать сложность такого распределения по модулю <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup> + 7)</span>.</p><p>Выражение <img align="middle" class="tex-formula" src="http://codeforces.ru/renderer/b364f2e04c665b78b924ec10666327a4ef4635bc.png" /> обозначает применение операции «XOR» к числам <span class="tex-span"><i>x</i></span> и <span class="tex-span"><i>y</i></span>. Данная операция существует во всех современных языках программирования. Например, в <span class="tex-font-style-it">C++</span> и <span class="tex-font-style-it">Java</span> она обозначается как «<span class="tex-font-style-tt">^</span>», в языке <span class="tex-font-style-it">Pascal</span> — как «<span class="tex-font-style-tt">xor</span>».</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке содержится двоичное число <span class="tex-span"><i>x</i></span> длины <span class="tex-span"><i>n</i></span>, <span class="tex-span">(1 ≤ <i>n</i> ≤ 100)</span>.</p><p>Это число может содержать ведущие нули.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите сложность данного распределения по модулю <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup> + 7)</span>.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>11<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>6<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>01<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>1<br /></pre></div></div></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Психи - в шеренгу!</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>1 секунда</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Дана шеренга из <span class="tex-span"><i>n</i></span> психов. Каждому психу дан идентификатор — уникальное целое число от <span class="tex-span">1</span> до <span class="tex-span"><i>n</i></span>. На каждом ходе каждый псих, имеющий идентификатор больше, чем у психа справа (если такой есть) убивает своего соседа справа в шеренге. Обратите внимание, что псих может убить и быть убитым на одном и том же ходе. </p><p>Вам дано исходное расположение психов в шеренге. Подсчитайте, сколько необходимо ходов до момента времени, после которого никто никого не будет убивать. Прочитайте пояснение к тестовому примеру, чтобы лучше понять условие.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке входных данных записано целое число <span class="tex-span"><i>n</i></span>, обозначающее количество психов, <span class="tex-span">(1 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup>)</span>. Во второй строке записан список из <span class="tex-span"><i>n</i></span> различных целых чисел от <span class="tex-span">1</span> до <span class="tex-span"><i>n</i></span>, включительно — идентификаторы психов в шеренге слева направо.</p><p>Числа в строках разделяются одиночными пробелами.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите количество ходов, после которых шеренга не будет меняться.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>10<br />10 9 7 8 6 5 3 4 2 1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>6<br />1 2 3 4 5 6<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>0<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом примере шеренга психов меняется так: [10 9 7 8 6 5 3 4 2 1] <span class="tex-span"> → </span> <span class="tex-font-style-bf">[10 8 4]</span> <span class="tex-span"> → </span> [10]. Итого, есть два хода.</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Калила и Димна на лесозаготовках</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Калила и Димна — два шакала. Они живут в огромных джунглях. Однажды шакалы решили устроиться на завод лесозаготовки и подработать. </p><p>Управляющий завода хочет, чтобы они отправились в джунгли и срубили <span class="tex-span"><i>n</i></span> деревьев высотой <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub></span>. Для этого Калила и Димна купили цепную пилу в магазине. Каждый раз, когда они используют пилу на дереве номер <span class="tex-span"><i>i</i></span>, они уменьшают высоту этого дерева на единицу. Каждый раз Калила и Димна должны заправить пилу для использования. Цена заправки зависит от того, какие деревья полностью спилены (дерево считается полностью спиленным, если его высота равна 0). Если максимальный идентификатор полностью срубленного дерева равняется <span class="tex-span"><i>i</i></span> (первоначально это дерево имело высоту <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>), то цена заправки пилы равняется <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span>. Если ни одно дерево не срублено полностью, то заправлять пилу запрещается. Изначально пила заправлена. Известно, что для каждого <span class="tex-span"><i>i</i></span> &lt; <span class="tex-span"><i>j</i></span>, <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub> &lt; <i>a</i><sub class="lower-index"><i>j</i></sub></span> и <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub> &gt; <i>b</i><sub class="lower-index"><i>j</i></sub></span>, а также <span class="tex-span"><i>b</i><sub class="lower-index"><i>n</i></sub> = 0</span> и <span class="tex-span"><i>a</i><sub class="lower-index">1</sub> = 1</span>. </p><p>Калила и Димна хотят полностью срубить все деревья с минимальными затратами. Они ждут Вашей помощи! Поможете?</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке записано целое число <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup></span>). Во второй строке записано <span class="tex-span"><i>n</i></span> целых чисел <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub></span> (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>). В третьей строке записано <span class="tex-span"><i>n</i></span> целых чисел <span class="tex-span"><i>b</i><sub class="lower-index">1</sub>, <i>b</i><sub class="lower-index">2</sub>, ..., <i>b</i><sub class="lower-index"><i>n</i></sub></span> (<span class="tex-span">0 ≤ <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>).</p><p>Гарантируется, что <span class="tex-span"><i>a</i><sub class="lower-index">1</sub> = 1</span>, <span class="tex-span"><i>b</i><sub class="lower-index"><i>n</i></sub> = 0</span>, <span class="tex-span"><i>a</i><sub class="lower-index">1</sub> &lt; <i>a</i><sub class="lower-index">2</sub> &lt; ... &lt; <i>a</i><sub class="lower-index"><i>n</i></sub></span> и <span class="tex-span"><i>b</i><sub class="lower-index">1</sub> &gt; <i>b</i><sub class="lower-index">2</sub> &gt; ... &gt; <i>b</i><sub class="lower-index"><i>n</i></sub></span>.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>В единственной строке должна быть записана минимальная стоимость вырубания всех деревьев.</p><p>Пожалуйста, не используйте спецификатор <span class="tex-font-style-tt">%lld</span> для чтения или записи 64-х битовых чисел на С++. Рекомендуется использовать потоки <span class="tex-font-style-tt">cin</span>, <span class="tex-font-style-tt">cout</span> или спецификатор <span class="tex-font-style-tt">%I64d</span>.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>5<br />1 2 3 4 5<br />5 4 3 2 0<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>25<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>6<br />1 2 3 10 20 30<br />6 5 4 3 2 0<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>138<br /></pre></div></div></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Вам знакомо это слово?</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>6 секунд</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p><span class="tex-font-style-it">Подстрока</span> строки — это непрерывная подпоследовательность символов данной строки. Таким образом, строка <span class="tex-font-style-tt">bca</span> является подстрокой строки <span class="tex-font-style-tt">abcabc</span>, а строка <span class="tex-font-style-tt">cc</span> — нет.</p><p><span class="tex-font-style-it">Повторяющийся блок</span> — это строка, полученная конкатенацией некоторой строки с собой же. Таким образом, строка <span class="tex-font-style-tt">abcabc</span> — это повторяющийся блок, а строки <span class="tex-font-style-tt">abcabd</span>, <span class="tex-font-style-tt">ababab</span> — нет.</p><p>Вам дана последовательность символов латинского алфавита (строка). За один ход Вы находите наикратчайшую подстроку, которая является повторяющимся блоком. Если таких подстрок несколько, выбираете ближайшую к левому краю строки. Пусть найденная подстрока имеет вид <span class="tex-span"><i>XX</i></span> (<span class="tex-span"><i>X</i></span> — некоторая строка), тогда Вы заменяете ее строкой <span class="tex-span"><i>X</i></span>, иными словами, Вы удаляете одну из подстрок <span class="tex-span"><i>X</i></span> в этой подстроке. Вы повторяете процесс до тех пор, пока в строке не остается повторяющихся блоков. </p><p>Как будет выглядеть результирующая строка? Посмотрите пояснения к тестовым примерам, чтобы лучше понять условие.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке дана строка, состоящая из строчных символов латинского алфавита, длины от <span class="tex-span">1</span> до <span class="tex-span">50000</span>, включительно.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите итоговую строку после применения операций.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>abccabc<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>abc<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>aaaabaaab<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>ab<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>birdbirdbirdistheword<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>birdistheword<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом примере строка превращается так: <span class="tex-font-style-tt">abccabc</span> <span class="tex-span"> → </span> <span class="tex-font-style-tt">abcabc</span> <span class="tex-span"> → </span> <span class="tex-font-style-tt">abc</span>.</p><p>Во втором примере строка превращается так: <span class="tex-font-style-tt">aaaabaaab</span> <span class="tex-span"> → </span> <span class="tex-font-style-tt">aaabaaab</span> <span class="tex-span"> → </span> <span class="tex-font-style-tt">aabaaab</span> <span class="tex-span"> → </span> <span class="tex-font-style-tt">abaaab</span> <span class="tex-span"> → </span> <span class="tex-font-style-tt">abaab</span> <span class="tex-span"> → </span> <span class="tex-font-style-tt">abab</span> <span class="tex-span"> → </span> <span class="tex-font-style-tt">ab</span>.</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Пинг-Понг</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>В этой задаче в каждый момент времени у Вас есть набор интервалов. Вам разрешено перейти от интервала <span class="tex-span">(<i>a</i>, <i>b</i>)</span> из набора к интервалу <span class="tex-span">(<i>c</i>, <i>d</i>)</span> из набора тогда и только тогда, когда <span class="tex-span"><i>c</i> &lt; <i>a</i> &lt; <i>d</i></span> <span class="tex-font-style-bf">или</span> <span class="tex-span"><i>c</i> &lt; <i>b</i> &lt; <i>d</i></span>. Считается, что путь от интервала <span class="tex-span"><i>I</i><sub class="lower-index">1</sub></span> к интервалу <span class="tex-span"><i>I</i><sub class="lower-index">2</sub></span> существует, если есть последовательность переходов, начинающихся с <span class="tex-span"><i>I</i><sub class="lower-index">1</sub></span>, таких, что можно добраться до <span class="tex-span"><i>I</i><sub class="lower-index">2</sub></span>.</p><p>Ваша программа должна обрабатывать запросы двух следующих типов:</p><p><ol> <li> «<span class="tex-font-style-tt">1 x y</span>» <span class="tex-span">(<i>x</i> &lt; <i>y</i>)</span> — добавьте новый интервал <span class="tex-span">(<i>x</i>, <i>y</i>)</span> в набор интервалов. Длина нового интервала гарантированно строго больше длин всех предыдущих интервалов. </li><li> «<span class="tex-font-style-tt">2 a b</span>» <span class="tex-span">(<i>a</i> ≠ <i>b</i>)</span> — ответьте на вопрос: есть ли путь от <span class="tex-span"><i>a</i></span>-го (один-индексация) добавленного интервала до <span class="tex-span"><i>b</i></span>-го (один-индексация) добавленного интервала? </li></ol></p><p>Выполните все запросы. Считайте, что изначально в вашем наборе нет ни одного интервала.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>Первая строка содержит целое число <span class="tex-span"><i>n</i></span> <span class="tex-span">(1 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup>)</span>, обозначающее количество запросов. Каждая из следующих строк содержит запрос в формате, описанном выше. Все числа во входных данных целые и не превосходят по модулю <span class="tex-span">10<sup class="upper-index">9</sup></span>.</p><p>Гарантируется, что все запросы корректные.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Для каждого запроса второго типа выведите «<span class="tex-font-style-tt">YES</span>» или «<span class="tex-font-style-tt">NO</span>» в отдельной строке в зависимости от ответа на вопрос.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>5<br />1 1 5<br />1 5 11<br />2 1 2<br />1 2 9<br />2 1 2<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>NO<br />YES<br /></pre></div></div></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>

    <br style="clear:both;"/>

    <div id="footer">
        <div><a href="http://codeforces.ru/">Codeforces</a> (c) Copyright 2010-2013 Михаил Мирзаянов</div>
        <div>Соревнования по программированию 2.0</div>

    </div>
</div>
</div>
</body>
</html>                                       
