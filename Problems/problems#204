
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="0cbe9d24cag0b84960464899035g3e97"/>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="http://worker.codeforces.ru/static/images/codeforces-vk-square-ru.png"/>
    <meta property="og:title" content="Задачи - Codeforces"/>
    <meta property="og:site_name" content="Codeforces"/>
    
    <meta name="cc" content="d91scrndseui"/>
    
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Задачи - Codeforces</title>
        <meta name="description" content="Codeforces. Соревнования и олимпиады по информатике и программированию, сообщество программистов" />
        <meta name="keywords" content="программирование информатика контест олимпиада алгоритмы c++ java графы vkcup" />
    <meta name="robots" content="index, follow" />

    <link href="http://worker.codeforces.ru/static/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

    <HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--CombineResourcesFilter-->
    
<LINK href="http://worker.codeforces.ru/static/favicon.png" rel="shortcut icon" type="image/png">
    
<LINK href="http://worker.codeforces.ru/static/css/prettify.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/clear.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/style.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/ttypography.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/problem-statement.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/second-level-menu.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/roundbox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/datatable.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/topic.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/table-form.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.jgrowl.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/facebox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.wysiwyg.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/codeforces.datepick.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/colorbox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.drafts.css" rel="stylesheet" type="text/css">
    
<LINK href="http://worker.codeforces.ru/static/markitup/skins/markitup/style.css" rel="stylesheet" type="text/css">
    
<LINK href="http://worker.codeforces.ru/static/markitup/sets/markdown/style.css" rel="stylesheet" type="text/css">

    
<SCRIPT charset="utf-8" src="//yandex.st/share/share.js" type="text/javascript"></SCRIPT>
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/sidebar-menu.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/community.css" rel="stylesheet" type="text/css">

    <!--[if IE]>
        <style>
            #sidebar {
                padding-left: 1em;
                margin: 1em 1em 1em 0;
            }
        </style>
    <![endif]-->
    
    
<SCRIPT src="http://worker.codeforces.ru/static/js/prettify/prettify.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery-1.8.3.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/sockjs-0.2.1.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/vertxbus-1.2.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.easing.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.lavalamp.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.jgrowl.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/facebox.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.wysiwyg.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.colorpicker.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.table.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.image.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.link.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.autocomplete.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.datepick.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.ie6blocker.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.colorbox-min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.ba-bbq.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.drafts.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/codeforces.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/markitup/jquery.markitup.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/markitup/sets/markdown/set.js" type="text/javascript"></SCRIPT>
    <!--/CombineResourcesFilter-->
</HEAD>
</HTML>

        <script type="text/javascript" src="http://worker.codeforces.ru/static/js/jquery.datepick-ru.js"></script>
        <script src="http://vk.com/js/api/openapi.js" type="text/javascript"></script>
</head>
<body><span style='display:none;' class='csrf-token' data-csrf='0cbe9d24cag0b84960464899035g3e97'>&nbsp;</span>
<!-- Codeforces javascripts. -->
<script type="text/javascript">
    VK.init({apiId: 1961905});
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>

    <script type="text/javascript">
        $(document).ready(function() {
    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    $(".second-level-menu-list").lavaLamp({
        fx: "backout",
        speed: 1000
    });


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


        });
    </script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<div id="body">
<div style="width: 950px; margin: 0 auto;">
    <div id="header" style="position:relative;">
        <div style="float:left;">
                <a href="/"><img src="http://worker.codeforces.ru/static/images/codeforces-logo-with-upper-beta.png"/></a>
                        <div style="position:absolute;left:97px;top:40px;">
                            <a href="http://vk.com" class="logo-href">При поддержке <img
                                    style="position:relative;top:5px;" src="http://worker.codeforces.ru/static/images/vkontakte-tiny-ru.png"/></a>
                        </div>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="http://worker.codeforces.ru/static/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="http://worker.codeforces.ru/static/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <div style="text-align: center;font-size: 18px;margin-bottom: 0.5em;"
         class="caption">Codeforces Round #129 (Div. 1)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Маленький Слоник и промежуток</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Маленький Слоник очень любит суммы на промежутках.</p><p>В этот раз у него есть пара целых чисел <span class="tex-span"><i>l</i></span> и <span class="tex-span"><i>r</i></span> <span class="tex-span">(<i>l</i> ≤ <i>r</i>)</span>. Маленькому Слонику нужно найти количество таких целых чисел <span class="tex-span"><i>x</i></span> <span class="tex-span">(<i>l</i> ≤ <i>x</i> ≤ <i>r</i>)</span>, что первая цифра числа <span class="tex-span"><i>x</i></span> равна последней (в десятичном представлении). Например, такие числа как <span class="tex-span">101</span>, <span class="tex-span">477474</span> или <span class="tex-span">9</span> он будет включать в ответ, в то время как <span class="tex-span">47</span>, <span class="tex-span">253</span> или <span class="tex-span">1020</span> — нет.</p><p>Помогите ему, посчитайте описанное количество чисел <span class="tex-span"><i>x</i></span> для заданной пары <span class="tex-span"><i>l</i></span> и <span class="tex-span"><i>r</i></span>.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В единственной строке задана пара целых чисел <span class="tex-span"><i>l</i></span> и <span class="tex-span"><i>r</i></span> <span class="tex-span">(1 ≤ <i>l</i> ≤ <i>r</i> ≤ 10<sup class="upper-index">18</sup>)</span> — границы промежутка.</p><p>Пожалуйста, не используйте спецификатор <span class="tex-font-style-tt">%lld</span> для чтения или записи 64-х битовых чисел на С++. Рекомендуется использовать потоки <span class="tex-font-style-tt">cin</span>, <span class="tex-font-style-tt">cout</span> или спецификатор <span class="tex-font-style-tt">%I64d</span>.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>В единственной строке выведите одно целое число — ответ на задачу.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>2 47<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>12<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>47 1024<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>98<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом примере в ответ входят следующие числа: <span class="tex-font-style-tt">2, 3, 4, 5, 6, 7, 8, 9, 11, 22, 33, 44</span>. </p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Маленький Слоник и карточки</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Маленький Слоник любит играть с цветными карточками.</p><p>У него есть <span class="tex-span"><i>n</i></span> карточек, каждая имеет ровно два цвета (цвет на передней стороне и цвет на задней стороне). Изначально все карточки лежат на столе передней стороной вверх. За один шаг Маленький Слоник может перевернуть на другую сторону любую карточку. Маленький Слоник считает набор карточек на столе веселым, если хотя бы половина карточек имеет одинаковый цвет (для каждой карточки рассматривается цвет стороны, которой она лежит вверх).</p><p>Помогите Маленькому Слонику найти минимальное количество шагов необходимых для превращения набора из <span class="tex-span"><i>n</i></span> карточек в веселый.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке задано единственное целое число <span class="tex-span"><i>n</i></span> <span class="tex-span">(1 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup>)</span> — количество карточек. Следующие <span class="tex-span"><i>n</i></span> строк содержат описание всех карточек, по одной карточке на строку. Карточки описываются парой целых положительных чисел, не превосходящих <span class="tex-span">10<sup class="upper-index">9</sup></span>, — цветами на обеих сторонах. Первое число в строке — это цвет на передней стороне карточки, второе — на задней. Цвет на передней стороне может совпадать с цветом на задней.</p><p>Числа в строках разделяются единичными пробелами.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>В единственной строке выведите единственное целое число — искомое минимальное количество шагов. Если превратить набор в веселый невозможно, выведите <span class="tex-font-style-tt">-1</span>.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>3<br />4 7<br />4 7<br />7 4<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>0<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>5<br />4 7<br />7 4<br />2 11<br />9 7<br />1 1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом примере изначально лежат три карточки из цветами <span class="tex-font-style-tt">4, 4, 7</span>. Так как две из трех карточек имеют одинаковый цвет <span class="tex-font-style-tt">4</span>, менять ничего не нужно, поэтому ответ — 0.</p><p>Во втором примере можно перевернуть первую и четвертую карточки. После этого три из пяти карточек будут иметь цвет <span class="tex-font-style-tt">7</span>.</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Маленький Слоник и Фурик и Рубик</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Маленький Слоник очень любит Фурика и Рубика, с которыми он познакомился в мегаполисе городского типа Кременчуге.</p><p>У Маленького Слоника есть две строки <span class="tex-span"><i>a</i></span> и <span class="tex-span"><i>b</i></span> одинаковой длины, состоящие только из прописных букв латинского алфавита. Маленький Слоник выбирает пару подстрок одинаковой длины — первую из строки <span class="tex-span"><i>a</i></span>, вторую из строки <span class="tex-span"><i>b</i></span>. Выбор происходит случайно равновероятно среди всех возможных пар. Обозначим подстроку строки <span class="tex-span"><i>a</i></span> через <span class="tex-span"><i>x</i></span>, а подстроку строки <span class="tex-span"><i>b</i></span> — через <span class="tex-span"><i>y</i></span>. Строку <span class="tex-span"><i>x</i></span> Маленький Слоник отдает Фурику, строку <span class="tex-span"><i>y</i></span> — Рубику.</p><p>Пусть <span class="tex-span"><i>f</i>(<i>x</i>, <i>y</i>)</span> — количество таких позиций <span class="tex-span"><i>i</i></span> (<span class="tex-span">1 ≤ <i>i</i> ≤ |<i>x</i>|</span>), что <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub> = <i>y</i><sub class="lower-index"><i>i</i></sub></span> (где <span class="tex-span">|<i>x</i>|</span> — длина строк <span class="tex-span"><i>x</i></span> и <span class="tex-span"><i>y</i></span>, а <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span> — <span class="tex-span"><i>i</i></span>-ые символы строк <span class="tex-span"><i>x</i></span> и <span class="tex-span"><i>y</i></span> соответственно). Помогите Фурику и Рубику найти математическое ожидание величины <span class="tex-span"><i>f</i>(<i>x</i>, <i>y</i>)</span>.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке задано единственное целое число <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 2·10<sup class="upper-index">5</sup></span>) — длина строк <span class="tex-span"><i>a</i></span> и <span class="tex-span"><i>b</i></span>. Во второй строке задана строка <span class="tex-span"><i>a</i></span>, в третьей — строка <span class="tex-span"><i>b</i></span>. Строки состоят только из прописных букв латинского алфавита. Длина обеих строк равна <span class="tex-span"><i>n</i></span>.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>В единственной строке выведите вещественное число — ответ на задачу. Ответ будет считаться правильным, если его относительная или абсолютная погрешность не будет превышать <span class="tex-span">10<sup class="upper-index"> - 6</sup></span>.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>2<br />AB<br />BA<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>0.400000000<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>3<br />AAB<br />CAA<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>0.642857143<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>Пусть задана строка <span class="tex-span"><i>a</i> = <i>a</i><sub class="lower-index">1</sub><i>a</i><sub class="lower-index">2</sub>... <i>a</i><sub class="lower-index">|<i>a</i>|</sub></span>, тогда обозначим через <span class="tex-span">|<i>a</i>|</span> длину строки, а через <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> — <span class="tex-span"><i>i</i></span>-й символ строки.</p><p>Подстрокой <span class="tex-span"><i>a</i>[<i>l</i>... <i>r</i>]</span> <span class="tex-span">(1 ≤ <i>l</i> ≤ <i>r</i> ≤ |<i>a</i>|)</span> строки <span class="tex-span"><i>a</i></span> называется строка <span class="tex-span"><i>a</i><sub class="lower-index"><i>l</i></sub><i>a</i><sub class="lower-index"><i>l</i> + 1</sub>... <i>a</i><sub class="lower-index"><i>r</i></sub></span>.</p><p>Строка <span class="tex-span"><i>a</i></span> является подстрокой строки <span class="tex-span"><i>b</i></span>, если существует такая пара целых чисел <span class="tex-span"><i>l</i></span> и <span class="tex-span"><i>r</i></span> <span class="tex-span">(1 ≤ <i>l</i> ≤ <i>r</i> ≤ |<i>b</i>|)</span>, что <span class="tex-span"><i>b</i>[<i>l</i>... <i>r</i>] = <i>a</i></span>.</p><p>Рассмотрим первый тестовый пример. В первом примере есть <span class="tex-span">5</span> возможных пар подстрок: <span class="tex-font-style-tt">(«A», «B»), («A», «A»), («B», «B»), («B», «A»), («AB», «BA»)</span>. Для второй и третьей пары знечение <span class="tex-span"><i>f</i>(<i>x</i>, <i>y</i>)</span> равно <span class="tex-span">1</span>, для остальных — <span class="tex-span">0</span>. Вероятность выбора каждой пары равна <img align="middle" class="tex-formula" src="http://codeforces.ru/renderer/215e7035e1b836a262740867b9bbd824fd3c66fe.png" />, поэтому ответ равен <img align="middle" class="tex-formula" src="http://codeforces.ru/renderer/215e7035e1b836a262740867b9bbd824fd3c66fe.png" /> <span class="tex-span">·</span> <span class="tex-span">0</span> <span class="tex-span"> + </span> <img align="middle" class="tex-formula" src="http://codeforces.ru/renderer/215e7035e1b836a262740867b9bbd824fd3c66fe.png" /> <span class="tex-span">·</span> <span class="tex-span">1</span> <span class="tex-span"> + </span> <img align="middle" class="tex-formula" src="http://codeforces.ru/renderer/215e7035e1b836a262740867b9bbd824fd3c66fe.png" /> <span class="tex-span">·</span> <span class="tex-span">1</span> <span class="tex-span"> + </span> <img align="middle" class="tex-formula" src="http://codeforces.ru/renderer/215e7035e1b836a262740867b9bbd824fd3c66fe.png" /> <span class="tex-span">·</span> <span class="tex-span">0</span> <span class="tex-span"> + </span> <img align="middle" class="tex-formula" src="http://codeforces.ru/renderer/215e7035e1b836a262740867b9bbd824fd3c66fe.png" /> <span class="tex-span">·</span> <span class="tex-span">0</span> <span class="tex-span"> = </span> <img align="middle" class="tex-formula" src="http://codeforces.ru/renderer/94b9256e0a6483c8977cf1cc752a60316429e3d1.png" /> <span class="tex-span"> = </span> <span class="tex-span">0.4</span>.</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Маленький Слоник и ретро строки</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Маленький Слоник нашел на чердаке старую потрепанную черно-белую строку <span class="tex-span"><i>s</i></span>.</p><p>Символы строки <span class="tex-span"><i>s</i></span> пронумерованы слева направо от <span class="tex-span">1</span> до <span class="tex-span">|<i>s</i>|</span>, где <span class="tex-span">|<i>s</i>|</span> — длина строки. Обозначим <span class="tex-span"><i>i</i></span>-тый символ строки <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span>. Так как строка черно-белая, каждый символ строки это либо буква «<span class="tex-font-style-tt">B</span>», либо буква «<span class="tex-font-style-tt">W</span>». К сожалению, строка очень старая и некоторые символы повреждены. На их позициях стоит буква «<span class="tex-font-style-tt">X</span>».</p><p>Маленький Слоник намерен восстановить строку и повесить ее себе на стену. Для этого нужно каждый символ «<span class="tex-font-style-tt">X</span>» заменить на «<span class="tex-font-style-tt">B</span>» или «<span class="tex-font-style-tt">W</span>». Чтобы строка хорошо смотрелась на стене, нужно чтобы она была <span class="tex-font-style-it">красивой</span>. Маленький Слоник считает строку красивой, если у нее есть две непересекающиеся подстроки, заданной длины <span class="tex-span"><i>k</i></span>, таких, что левая полностью состоит из символов «<span class="tex-font-style-tt">B</span>», а правая полностью состоит из символов «<span class="tex-font-style-tt">W</span>». Более формально, существует четыре целых числа <span class="tex-span"><i>a</i>, <i>b</i>, <i>c</i>, <i>d</i></span> <span class="tex-span">(1 ≤ <i>a</i> ≤ <i>b</i> &lt; <i>c</i> ≤ <i>d</i> ≤ |<i>s</i>|; <i>b</i> - <i>a</i> + 1 = <i>d</i> - <i>c</i> + 1 = <i>k</i>)</span> таких, что <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> = «<span class="tex-font-style-tt">B</span>» <span class="tex-span">(<i>a</i> ≤ <i>i</i> ≤ <i>b</i>)</span> и <span class="tex-span"><i>s</i><sub class="lower-index"><i>j</i></sub></span> = «<span class="tex-font-style-tt">W</span>» <span class="tex-span">(<i>c</i> ≤ <i>j</i> ≤ <i>d</i>)</span>. </p><p>Помогите Маленькому Слонику найти количество различных красивых строк, которые он может получить из строки <span class="tex-span"><i>s</i></span>. Две строки считаются различными, если существует такая позиция, в которой символ в первой строке отличается от соответствующего символа второй строки. Если в строке нет символов «<span class="tex-font-style-tt">X</span>» и она уже красивая — то ответ <span class="tex-font-style-tt">1</span>.</p><p>Так как ответ может быть довольно большим, выведите его остаток от деления на <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup> + 7)</span>.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке через пробел заданы два целых числа <span class="tex-span"><i>n</i></span> и <span class="tex-span"><i>k</i></span> <span class="tex-span">(1 ≤ <i>k</i> ≤ <i>n</i> ≤ 10<sup class="upper-index">6</sup>)</span>. Во второй строке задана строка <span class="tex-span"><i>s</i></span>. Строка <span class="tex-span"><i>s</i></span> имеет длину <span class="tex-span"><i>n</i></span> и состоит только из символов «<span class="tex-font-style-tt">W</span>», «<span class="tex-font-style-tt">B</span>» и «<span class="tex-font-style-tt">X</span>».</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>В единственной строке выведите целое число — ответ на задачу по модулю <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup> + 7)</span>.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>3 2<br />XXX<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>0<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>4 2<br />XXXX<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>1<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>10 2<br />XXBXXWXXXX<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>166<br /></pre></div></div></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Маленький Слоник и строки</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>3 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Маленький Слоник очень любит строки.</p><p>У него есть массив <span class="tex-span"><i>a</i></span> из <span class="tex-span"><i>n</i></span> строк, состоящих из строчных латинских букв. Пусть элементы массива пронумерованы от 1 до <span class="tex-span"><i>n</i></span>, тогда элемент номер <span class="tex-span"><i>i</i></span> обозначим <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>. Для каждой строки <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span">(1 ≤ <i>i</i> ≤ <i>n</i>)</span> Маленький Слоник хочет найти количество пар целых чисел <span class="tex-span"><i>l</i></span> и <span class="tex-span"><i>r</i></span> <span class="tex-span">(1 ≤ <i>l</i> ≤ <i>r</i> ≤ |<i>a</i><sub class="lower-index"><i>i</i></sub>|)</span> таких, что подстрока <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub>[<i>l</i>... <i>r</i>]</span> является подстрокой как минимум <span class="tex-span"><i>k</i></span> строк из массива <span class="tex-span"><i>a</i></span> (включая <span class="tex-span"><i>i</i></span>-ю строку).</p><p>Помогите Маленькому Слонику решить эту задачу.</p><p>Если вы не знакомы с основными обозначениями в строковых задачах, в примечании приведены соответствующие определения.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке задано два целых числа через пробел — <span class="tex-span"><i>n</i></span> и <span class="tex-span"><i>k</i></span> <span class="tex-span">(1 ≤ <i>n</i>, <i>k</i> ≤ 10<sup class="upper-index">5</sup>)</span>. В следующих <span class="tex-span"><i>n</i></span> строках задан массив <span class="tex-span"><i>a</i></span>. В <span class="tex-span"><i>i</i></span>-ой строке записана непустая строка <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>, состоящая из строчных латинских букв. Суммарная длина всех строк <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> не превосходит <span class="tex-span">10<sup class="upper-index">5</sup></span>.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>В единственной строке выведите <span class="tex-span"><i>n</i></span> целых чисел разделенных единичными пробелами — <span class="tex-span"><i>i</i></span>-е число является ответом для строки <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>.</p><p>Пожалуйста, не используйте спецификатор %lld для чтения или записи 64-битных чисел на С++. Рекомендуется использовать потоки cin, cout или спецификатор %I64d.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>3 1<br />abc<br />a<br />ab<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>6 1 3 <br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>7 4<br />rubik<br />furik<br />abab<br />baba<br />aaabbbababa<br />abababababa<br />zero<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>1 0 9 9 21 30 0 <br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>Пусть задана строка <span class="tex-span"><i>a</i> = <i>a</i><sub class="lower-index">1</sub><i>a</i><sub class="lower-index">2</sub>... <i>a</i><sub class="lower-index">|<i>a</i>|</sub></span>, тогда обозначим через <span class="tex-span">|<i>a</i>|</span> длину строки, а через <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> — <span class="tex-span"><i>i</i></span>-й символ строки.</p><p>Подстрокой <span class="tex-span"><i>a</i>[<i>l</i>... <i>r</i>]</span> <span class="tex-span">(1 ≤ <i>l</i> ≤ <i>r</i> ≤ |<i>a</i>|)</span> строки <span class="tex-span"><i>a</i></span> называется строка <span class="tex-span"><i>a</i><sub class="lower-index"><i>l</i></sub><i>a</i><sub class="lower-index"><i>l</i> + 1</sub>... <i>a</i><sub class="lower-index"><i>r</i></sub></span>.</p><p>Строка <span class="tex-span"><i>a</i></span> является подстрокой строки <span class="tex-span"><i>b</i></span>, если существует такая пара целых чисел <span class="tex-span"><i>l</i></span> и <span class="tex-span"><i>r</i></span> <span class="tex-span">(1 ≤ <i>l</i> ≤ <i>r</i> ≤ |<i>b</i>|)</span>, что <span class="tex-span"><i>b</i>[<i>l</i>... <i>r</i>] = <i>a</i></span>.</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>

    <br style="clear:both;"/>

    <div id="footer">
        <div><a href="http://codeforces.ru/">Codeforces</a> (c) Copyright 2010-2013 Михаил Мирзаянов</div>
        <div>Соревнования по программированию 2.0</div>

    </div>
</div>
</div>
</body>
</html>                                       
