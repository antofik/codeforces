
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="009b417e1aed3agc3bhe83fdgd39de95"/>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="http://worker.codeforces.ru/static/images/codeforces-vk-square-ru.png"/>
    <meta property="og:title" content="Задачи - Codeforces"/>
    <meta property="og:site_name" content="Codeforces"/>
    
    <meta name="cc" content="1v277ikxn9dg4"/>
    
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Задачи - Codeforces</title>
        <meta name="description" content="Codeforces. Соревнования и олимпиады по информатике и программированию, сообщество программистов" />
        <meta name="keywords" content="программирование информатика контест олимпиада алгоритмы c++ java графы vkcup" />
    <meta name="robots" content="index, follow" />

    <link href="http://worker.codeforces.ru/static/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

    <HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--CombineResourcesFilter-->
    
<LINK href="http://worker.codeforces.ru/static/favicon.png" rel="shortcut icon" type="image/png">
    
<LINK href="http://worker.codeforces.ru/static/css/prettify.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/clear.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/style.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/ttypography.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/problem-statement.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/second-level-menu.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/roundbox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/datatable.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/topic.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/table-form.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.jgrowl.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/facebox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.wysiwyg.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/codeforces.datepick.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/colorbox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.drafts.css" rel="stylesheet" type="text/css">
    
<LINK href="http://worker.codeforces.ru/static/markitup/skins/markitup/style.css" rel="stylesheet" type="text/css">
    
<LINK href="http://worker.codeforces.ru/static/markitup/sets/markdown/style.css" rel="stylesheet" type="text/css">

    
<SCRIPT charset="utf-8" src="//yandex.st/share/share.js" type="text/javascript"></SCRIPT>
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/sidebar-menu.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/community.css" rel="stylesheet" type="text/css">

    <!--[if IE]>
        <style>
            #sidebar {
                padding-left: 1em;
                margin: 1em 1em 1em 0;
            }
        </style>
    <![endif]-->
    
    
<SCRIPT src="http://worker.codeforces.ru/static/js/prettify/prettify.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery-1.8.3.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/sockjs-0.2.1.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/vertxbus-1.2.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.easing.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.lavalamp.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.jgrowl.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/facebox.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.wysiwyg.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.colorpicker.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.table.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.image.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.link.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.autocomplete.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.datepick.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.ie6blocker.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.colorbox-min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.ba-bbq.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.drafts.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/codeforces.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/markitup/jquery.markitup.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/markitup/sets/markdown/set.js" type="text/javascript"></SCRIPT>
    <!--/CombineResourcesFilter-->
</HEAD>
</HTML>

        <script type="text/javascript" src="http://worker.codeforces.ru/static/js/jquery.datepick-ru.js"></script>
        <script src="http://vk.com/js/api/openapi.js" type="text/javascript"></script>
</head>
<body><span style='display:none;' class='csrf-token' data-csrf='009b417e1aed3agc3bhe83fdgd39de95'>&nbsp;</span>
<!-- Codeforces javascripts. -->
<script type="text/javascript">
    VK.init({apiId: 1961905});
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>

    <script type="text/javascript">
        $(document).ready(function() {
    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    $(".second-level-menu-list").lavaLamp({
        fx: "backout",
        speed: 1000
    });


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


        });
    </script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<div id="body">
<div style="width: 950px; margin: 0 auto;">
    <div id="header" style="position:relative;">
        <div style="float:left;">
                <a href="/"><img src="http://worker.codeforces.ru/static/images/codeforces-logo-with-upper-beta.png"/></a>
                        <div style="position:absolute;left:97px;top:40px;">
                            <a href="http://vk.com" class="logo-href">При поддержке <img
                                    style="position:relative;top:5px;" src="http://worker.codeforces.ru/static/images/vkontakte-tiny-ru.png"/></a>
                        </div>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="http://worker.codeforces.ru/static/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="http://worker.codeforces.ru/static/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <div style="text-align: center;font-size: 18px;margin-bottom: 0.5em;"
         class="caption">Codeforces Round #144 (Div. 2)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Идеальная перестановка</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p><span class="tex-font-style-it">Перестановкой</span> называется упорядоченный набор чисел <span class="tex-span"><i>p</i><sub class="lower-index">1</sub>, <i>p</i><sub class="lower-index">2</sub>, ..., <i>p</i><sub class="lower-index"><i>n</i></sub></span>, состоящий из <span class="tex-span"><i>n</i></span> различных целых положительных чисел, каждое из которых не больше чем <span class="tex-span"><i>n</i></span>. Обозначим <span class="tex-span"><i>i</i></span>-тый элемент перестановки <span class="tex-span"><i>p</i></span> через <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span>. Число <span class="tex-span"><i>n</i></span> будем называть размером перестановки <span class="tex-span"><i>p</i><sub class="lower-index">1</sub>, <i>p</i><sub class="lower-index">2</sub>, ..., <i>p</i><sub class="lower-index"><i>n</i></sub></span>.</p><p>Николай очень любит перестановки. Некоторые перестановки особенно нравятся Николаю. Их он называет идеальными. <span class="tex-font-style-it">Идеальная</span> перестановка, это такая перестановка <span class="tex-span"><i>p</i></span>, что для любого <span class="tex-span"><i>i</i></span> <span class="tex-span">(1 ≤ <i>i</i> ≤ <i>n</i>)</span> (<span class="tex-span"><i>n</i></span> — размер перестановки) верно, что <span class="tex-span"><i>p</i><sub class="lower-index"><i>p</i><sub class="lower-index"><i>i</i></sub></sub> = <i>i</i></span> и <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub> ≠ <i>i</i></span>. Вас он просит для заданного <span class="tex-span"><i>n</i></span> вывести любую идеальную перестановку размера <span class="tex-span"><i>n</i></span>.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В единственной строке записано единственное целое число <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 100</span>) — размер перестановки.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Если идеальной перестановки размера <span class="tex-span"><i>n</i></span> не существует — выведите единственное число -1. Иначе выведите <span class="tex-span"><i>n</i></span> различных чисел от 1 до <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>p</i><sub class="lower-index">1</sub>, <i>p</i><sub class="lower-index">2</sub>, ..., <i>p</i><sub class="lower-index"><i>n</i></sub></span> — перестановку <span class="tex-span"><i>p</i></span>, являющуюся идеальной. Выведенные числа разделяйте пробельными символами.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>-1<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>2<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2 1 <br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>4<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2 1 4 3 <br /></pre></div></div></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Неквадратное уравнение</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>1 секунда</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Рассмотрим уравнение:</p><p><center class="tex-equation"><span class="tex-span"><i>x</i><sup class="upper-index">2</sup> + <i>s</i>(<i>x</i>)·<i>x</i> - <i>n</i> = 0, </span></center> </p><p>где <span class="tex-span"><i>x</i>, <i>n</i></span> — целые положительные числа, <span class="tex-span"><i>s</i>(<i>x</i>)</span> — функция, равная сумме цифр числа <span class="tex-span"><i>x</i></span> в десятичной системе счисления.</p><p>Вам дано целое число <span class="tex-span"><i>n</i></span>, найдите наименьший целый положительный корень уравнения <span class="tex-span"><i>x</i></span>, или определите, что таких корней нет.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В единственной строке записано целое число <span class="tex-span"><i>n</i></span> <span class="tex-span">(1 ≤ <i>n</i> ≤ 10<sup class="upper-index">18</sup>)</span> — параметр уравнения.</p><p>Пожалуйста, не используйте спецификатор <span class="tex-font-style-tt">%lld</span> для чтения или записи 64-х битовых чисел на С++. Рекомендуется использовать потоки <span class="tex-font-style-tt">cin</span>, <span class="tex-font-style-tt">cout</span> или спецификатор <span class="tex-font-style-tt">%I64d</span>. </p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите -1, если уравнение не имеет целых положительных корней. Иначе выведите такое наименьшее целое <span class="tex-span"><i>x</i></span> <span class="tex-span">(<i>x</i> &gt; 0)</span>, что описанное в условии равенство выполняется.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>2<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>1<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>110<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>10<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>4<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>-1<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом тестовом примере <span class="tex-span"><i>x</i> = 1</span> является наименьшим корнем. Так как <span class="tex-span"><i>s</i>(1) = 1</span> и <span class="tex-span">1<sup class="upper-index">2</sup> + 1·1 - 2 = 0</span>.</p><p>Во втором тестовом примере <span class="tex-span"><i>x</i> = 10</span> является наименьшим корнем. Так как <span class="tex-span"><i>s</i>(10) = 1 + 0 = 1</span> и <span class="tex-span">10<sup class="upper-index">2</sup> + 1·10 - 110 = 0</span>.</p><p>В третьем тестовом примере корней у уравнения нет.</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Циклы</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>1 секунда</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Джон Доу задумался о графах. После раздумья он понял, что хочет нарисовать неориентированный граф, в котором будет ровно <span class="tex-span"><i>k</i></span> циклов длины <span class="tex-span">3</span>. </p><p>Цикл длины <span class="tex-span">3</span> — это неупорядоченная тройка различных вершин графа <span class="tex-span"><i>a</i></span>, <span class="tex-span"><i>b</i></span> и <span class="tex-span"><i>c</i></span>, таких, что каждая пара из них соединена ребром графа. </p><p>Джон долго рисовал, но у него ничего не получилось. Помогите ему найти такой граф. Обратите внимание, чтобы Джон смог без проблем за день нарисовать найденный граф, количество вершин в найденном графе не должно превышать <span class="tex-span">100</span>.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В единственной строке записано целое число <span class="tex-span"><i>k</i></span> (<span class="tex-span">1 ≤ <i>k</i> ≤ 10<sup class="upper-index">5</sup></span>) — количество циклов длины <span class="tex-span">3</span> в искомом графе.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>В первой строке выведите целое число <span class="tex-span"><i>n</i></span> (<span class="tex-span">3 ≤ <i>n</i> ≤ 100</span>) — количество вершин в найденном графе. В следующих <span class="tex-span"><i>n</i></span> строках выведите по <span class="tex-span"><i>n</i></span> символов «<span class="tex-font-style-tt">0</span>» и «<span class="tex-font-style-tt">1</span>»: <span class="tex-span"><i>i</i></span>-тый символ <span class="tex-span"><i>j</i></span>-той из этих строк должен быть равен «<span class="tex-font-style-tt">0</span>», если между вершинами <span class="tex-span"><i>i</i></span> и <span class="tex-span"><i>j</i></span> нет ребра и «<span class="tex-font-style-tt">1</span>» в противном случае. Обратите внимание, так как искомый граф неориентированный, <span class="tex-span"><i>i</i></span>-тый символ <span class="tex-span"><i>j</i></span>-той строки должен быть равен <span class="tex-span"><i>j</i></span>-тому символу <span class="tex-span"><i>i</i></span>-той строки. Граф не должен содержать петель, поэтому <span class="tex-span"><i>i</i></span>-тый символ <span class="tex-span"><i>i</i></span>-той строки должен быть равен «<span class="tex-font-style-tt">0</span>» для всех <span class="tex-span"><i>i</i></span>.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>3<br />011<br />101<br />110<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>10<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>5<br />01111<br />10111<br />11011<br />11101<br />11110<br /></pre></div></div></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Таблица</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>4 seconds</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 megabytes</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>У Джона Доу есть таблица размером <span class="tex-span"><i>n</i> × <i>m</i></span>. Джон Доу может нарисовать в некоторых ячейках таблицы точки, не более одной точки в одной ячейке таблицы. С помощью таких операций Джон Доу хочет добиться того, чтобы в любой квадратной подтаблице размера <span class="tex-span"><i>n</i> × <i>n</i></span> количество точек было в точности равно <span class="tex-span"><i>k</i></span>.</p><p>Джону Доу стало интересно, сколькими различными способами можно заполнить эту таблицу точками так, чтобы описанное условие выполнялось. Поскольку это число может быть очень велико, Джон Доу просит узнать его остаток от деления на <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup> + 7)</span>.</p><p>Считайте, что Джон всегда рисует точку строго в центре некоторой ячейки. Два способа заполнения таблицы точками считаются различными, если существует ячейка таблицы, в которой в одном способе нарисована точка, а в другом — нет.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В единственной строке через пробел записаны целые числа <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>m</i></span>, <span class="tex-span"><i>k</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 100; <i>n</i> ≤ <i>m</i> ≤ 10<sup class="upper-index">18</sup>; 0 ≤ <i>k</i> ≤ <i>n</i><sup class="upper-index">2</sup></span>) — количество строк в таблице, количество столбцов в таблице и количество точек, которое должно быть в каждом квадрате.</p><p>Пожалуйста, не используйте спецификатор <span class="tex-font-style-tt">%lld</span> для чтения или записи 64-х битовых чисел на С++. Рекомендуется использовать потоки <span class="tex-font-style-tt">cin</span>, <span class="tex-font-style-tt">cout</span> или спецификатор <span class="tex-font-style-tt">%I64d</span>. </p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>В единственной строке выведите целое число — остаток от деления описанного количества способов на <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup> + 7)</span>.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>5 6 1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>45</pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>Рассмотрим первый тестовый пример:  <center> <img class="tex-graphics" src="http://codeforces.ru/renderer/3b4e664bc8ecca4cdf8d2b65669d0b1a78220a58.png" />  </center> Серая область принадлежит обоим квадратам <span class="tex-span">5 × 5</span>. Поэтому, если в ней есть одна точка, то больше нигде точек быть не может. Если в одной из белых областей есть точка, то в другой тоже должна быть точка. Таким образом есть <span class="tex-span">20</span> вариантов, в которых точка стоит в серой области и <span class="tex-span">25</span> вариантов в которых в каждой из белых областей стоит по точке. Всего <span class="tex-span">45</span> вариантов.</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Графы Доу</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>3 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Джон Доу решил, что в его честь должен быть назван какой-нибудь математический объект и изобрел графы Доу. Графы Доу — это семейство неориентированных графов, каждый из которых характеризуются единственным целым неотрицательным числом — порядком. </p><p>Граф Доу порядка <span class="tex-span"><i>k</i></span> обозначим за <span class="tex-span"><i>D</i>(<i>k</i>)</span>, за <span class="tex-span">|<i>D</i>(<i>k</i>)|</span> обозначим количество вершин в графе <span class="tex-span"><i>D</i>(<i>k</i>)</span>. Тогда определим графы Доу следующим образом:</p><p><ul> <li> <span class="tex-span"><i>D</i>(0)</span> состоит из единственной вершины, которая имеет номер <span class="tex-span">1</span>. </li><li> <span class="tex-span"><i>D</i>(1)</span> состоит из двух вершин с номерами <span class="tex-span">1</span> и <span class="tex-span">2</span>, соединенных ребром. </li><li> <span class="tex-span"><i>D</i>(<i>n</i>)</span> для <span class="tex-span"><i>n</i> ≥ 2</span> получается из графов <span class="tex-span"><i>D</i>(<i>n</i> - 1)</span> и <span class="tex-span"><i>D</i>(<i>n</i> - 2)</span>. <span class="tex-span"><i>D</i>(<i>n</i> - 1)</span> и <span class="tex-span"><i>D</i>(<i>n</i> - 2)</span> объединяются в один граф, при этом номера всех вершин графа <span class="tex-span"><i>D</i>(<i>n</i> - 2)</span> увеличиваются на <span class="tex-span">|<i>D</i>(<i>n</i> - 1)|</span> (например, вершина номер <span class="tex-span">1</span> графа <span class="tex-span"><i>D</i>(<i>n</i> - 2)</span> становится вершиной номер <span class="tex-span">1 + |<i>D</i>(<i>n</i> - 1)|</span>). После этого в граф добавляются два ребра: первое — между вершинами с номерами <span class="tex-span">|<i>D</i>(<i>n</i> - 1)|</span> и <span class="tex-span">|<i>D</i>(<i>n</i> - 1)| + 1</span>, второе — между вершинами с номерами <span class="tex-span">|<i>D</i>(<i>n</i> - 1)| + 1</span> и <span class="tex-span">1</span>. Обратите внимание, что из определения графа <span class="tex-span"><i>D</i>(<i>n</i>)</span> следует, что <span class="tex-span"><i>D</i>(<i>n</i>)</span> является связным графом, вершины которого пронумерованы от <span class="tex-span">1</span> до <span class="tex-span">|<i>D</i>(<i>n</i>)|</span>. </li></ul></p><p><center> <img class="tex-graphics" src="http://codeforces.ru/renderer/557c7fdbd10bddaf8b8bded368fa62be27adf396.png" /> <span class="tex-font-size-script">На рисунке изображены, слева-направо, графы Доу порядка 1, 2, 3 и 4.</span> </center></p><p>Графы Доу, по мнению Джона, хороши прежде всего тем, что для них существует полиномиальный алгоритм поиска Гамильтонова пути. Однако от Вас требуется отвечать на запросы о нахождении кратчайшего по длине пути между вершинами <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> и <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> в графе <span class="tex-span"><i>D</i>(<i>n</i>)</span>.</p><p>Путь между парой вершин <span class="tex-span"><i>u</i></span> и <span class="tex-span"><i>v</i></span> в графе — это последовательность вершин <span class="tex-span"><i>x</i><sub class="lower-index">1</sub></span>, <span class="tex-span"><i>x</i><sub class="lower-index">2</sub></span>, <span class="tex-span">...</span>, <span class="tex-span"><i>x</i><sub class="lower-index"><i>k</i></sub></span> <span class="tex-span">(<i>k</i> &gt; 1)</span> такая, что <span class="tex-span"><i>x</i><sub class="lower-index">1</sub> = <i>u</i></span>, <span class="tex-span"><i>x</i><sub class="lower-index"><i>k</i></sub> = <i>v</i></span>, и для любого <span class="tex-span"><i>i</i></span> <span class="tex-span">(<i>i</i> &lt; <i>k</i>)</span> вершины <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> и <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i> + 1</sub></span> связаны ребром графа. Длиной пути <span class="tex-span"><i>x</i><sub class="lower-index">1</sub></span>, <span class="tex-span"><i>x</i><sub class="lower-index">2</sub></span>, <span class="tex-span">...</span>, <span class="tex-span"><i>x</i><sub class="lower-index"><i>k</i></sub></span> называется число <span class="tex-span">(<i>k</i> - 1)</span>.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке записаны два целых числа <span class="tex-span"><i>t</i></span> и <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>t</i> ≤ 10<sup class="upper-index">5</sup>; 1 ≤ <i>n</i> ≤ 10<sup class="upper-index">3</sup></span>) — количество запросов и порядок рассматриваемого графа. В <span class="tex-span"><i>i</i></span>-той из следующих <span class="tex-span"><i>t</i></span> строк записано два целых числа <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> и <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">16</sup></span>, <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub> ≠ <i>b</i><sub class="lower-index"><i>i</i></sub></span>) — номера двух вершин в <span class="tex-span"><i>i</i></span>-м запросе. Гарантируется, что <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ |<i>D</i>(<i>n</i>)|</span>.</p><p>Пожалуйста, не используйте спецификатор <span class="tex-font-style-tt">%lld</span> для чтения или записи 64-х битовых чисел на С++. Рекомендуется использовать потоки <span class="tex-font-style-tt">cin</span>, <span class="tex-font-style-tt">cout</span> или спецификатор <span class="tex-font-style-tt">%I64d</span>. </p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Для каждого запроса выведите в отдельной строке единственное целое число — длину кратчайшего пути между вершинами <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> и <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span>. Ответы на запросы выводите в том порядке, в котором запросы заданы во входных данных.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>10 5<br />1 2<br />1 3<br />1 4<br />1 5<br />2 3<br />2 4<br />2 5<br />3 4<br />3 5<br />4 5<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>1<br />1<br />1<br />2<br />1<br />2<br />3<br />1<br />2<br />1<br /></pre></div></div></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>

    <br style="clear:both;"/>

    <div id="footer">
        <div><a href="http://codeforces.ru/">Codeforces</a> (c) Copyright 2010-2013 Михаил Мирзаянов</div>
        <div>Соревнования по программированию 2.0</div>

    </div>
</div>
</div>
</body>
</html>                                       
