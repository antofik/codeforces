
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="2e22fb4h58ehb60ehhbb9b46dc0397h3"/>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="http://worker.codeforces.ru/static/images/codeforces-vk-square-ru.png"/>
    <meta property="og:title" content="Задачи - Codeforces"/>
    <meta property="og:site_name" content="Codeforces"/>
    
    <meta name="cc" content="1esp8wzby77pe"/>
    
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Задачи - Codeforces</title>
        <meta name="description" content="Codeforces. Соревнования и олимпиады по информатике и программированию, сообщество программистов" />
        <meta name="keywords" content="программирование информатика контест олимпиада алгоритмы c++ java графы vkcup" />
    <meta name="robots" content="index, follow" />

    <link href="http://worker.codeforces.ru/static/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

    <HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--CombineResourcesFilter-->
    
<LINK href="http://worker.codeforces.ru/static/favicon.png" rel="shortcut icon" type="image/png">
    
<LINK href="http://worker.codeforces.ru/static/css/prettify.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/clear.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/style.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/ttypography.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/problem-statement.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/second-level-menu.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/roundbox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/datatable.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/topic.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/table-form.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.jgrowl.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/facebox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.wysiwyg.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/codeforces.datepick.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/colorbox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.drafts.css" rel="stylesheet" type="text/css">
    
<LINK href="http://worker.codeforces.ru/static/markitup/skins/markitup/style.css" rel="stylesheet" type="text/css">
    
<LINK href="http://worker.codeforces.ru/static/markitup/sets/markdown/style.css" rel="stylesheet" type="text/css">

    
<SCRIPT charset="utf-8" src="//yandex.st/share/share.js" type="text/javascript"></SCRIPT>
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/sidebar-menu.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/community.css" rel="stylesheet" type="text/css">

    <!--[if IE]>
        <style>
            #sidebar {
                padding-left: 1em;
                margin: 1em 1em 1em 0;
            }
        </style>
    <![endif]-->
    
    
<SCRIPT src="http://worker.codeforces.ru/static/js/prettify/prettify.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery-1.8.3.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/sockjs-0.2.1.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/vertxbus-1.2.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.easing.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.lavalamp.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.jgrowl.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/facebox.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.wysiwyg.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.colorpicker.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.table.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.image.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.link.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.autocomplete.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.datepick.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.ie6blocker.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.colorbox-min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.ba-bbq.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.drafts.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/codeforces.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/markitup/jquery.markitup.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/markitup/sets/markdown/set.js" type="text/javascript"></SCRIPT>
    <!--/CombineResourcesFilter-->
</HEAD>
</HTML>

        <script type="text/javascript" src="http://worker.codeforces.ru/static/js/jquery.datepick-ru.js"></script>
        <script src="http://vk.com/js/api/openapi.js" type="text/javascript"></script>
</head>
<body><span style='display:none;' class='csrf-token' data-csrf='2e22fb4h58ehb60ehhbb9b46dc0397h3'>&nbsp;</span>
<!-- Codeforces javascripts. -->
<script type="text/javascript">
    VK.init({apiId: 1961905});
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>

    <script type="text/javascript">
        $(document).ready(function() {
    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    $(".second-level-menu-list").lavaLamp({
        fx: "backout",
        speed: 1000
    });


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


        });
    </script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<div id="body">
<div style="width: 950px; margin: 0 auto;">
    <div id="header" style="position:relative;">
        <div style="float:left;">
            <div style="padding:1em 0 0 2px;color:#00a651;">
<a href="/croc2012"><img src="/images/custom/croc-ru.png"/></a>
<span style="padding:1.5em;">Открытый чемпионат Москвы и МО по программированию</span>
</div>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="http://worker.codeforces.ru/static/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="http://worker.codeforces.ru/static/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <div style="text-align: center;font-size: 18px;margin-bottom: 0.5em;"
         class="caption">&#1063;&#1077;&#1084;&#1087;&#1080;&#1086;&#1085;&#1072;&#1090; &#1050;&#1056;&#1054;&#1050; 2012 - &#1050;&#1074;&#1072;&#1083;&#1080;&#1092;&#1080;&#1082;&#1072;&#1094;&#1080;&#1086;&#1085;&#1085;&#1099;&#1081; &#1088;&#1072;&#1091;&#1085;&#1076;</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Телефонный код</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>У Поликарпа есть <span class="tex-span"><i>n</i></span> друзей в городе Тарасове. Поликарп знает телефонные номера всех друзей: это строки <span class="tex-span"><i>s</i><sub class="lower-index">1</sub>, <i>s</i><sub class="lower-index">2</sub>, ..., <i>s</i><sub class="lower-index"><i>n</i></sub></span>. Все эти строки состоят только из цифр и имеют одинаковую длину. </p><p>Однажды Поликарпу понадобилось узнать телефонный код города Тарасова. Он предположил, что кодом города является наидлиннейший общий префикс всех телефонных номеров его друзей. Другими словами, это максимальная по длине строка <span class="tex-span"><i>c</i></span>, которая является префиксом (началом) каждой строки <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> для всех <span class="tex-span"><i>i</i></span> (<span class="tex-span">1 ≤ <i>i</i> ≤ <i>n</i></span>). Помогите Поликарпу определить длину кода города. </p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке входных данных записано целое число <span class="tex-span"><i>n</i></span> (<span class="tex-span">2 ≤ <i>n</i> ≤ 3·10<sup class="upper-index">4</sup></span>) — количество друзей Поликарпа. Далее следует <span class="tex-span"><i>n</i></span> строк <span class="tex-span"><i>s</i><sub class="lower-index">1</sub>, <i>s</i><sub class="lower-index">2</sub>, ..., <i>s</i><sub class="lower-index"><i>n</i></sub></span> — номера друзей Поликарпа. Гарантируется, что все строки состоят только из цифр и имеют одинаковую длину от <span class="tex-span">1</span> до <span class="tex-span">20</span>, включительно. Также гарантируется, что все строки различны.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите количество цифр в искомом коде города.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>4<br />00209<br />00219<br />00999<br />00909<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>2<br />1<br />2<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>0<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>3<br />77012345678999999999<br />77012345678901234567<br />77012345678998765432<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>12<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p><span class="tex-font-style-it">Префиксом</span> строки <span class="tex-span"><i>t</i></span> называется строка, полученная удалением нуля или более цифр из конца строки <span class="tex-span"><i>t</i></span>. Например, строка «<span class="tex-font-style-tt">00209</span>» имеет 6 префиксов: «» (пустой префикс), «<span class="tex-font-style-tt">0</span>», «<span class="tex-font-style-tt">00</span>», «<span class="tex-font-style-tt">002</span>», «<span class="tex-font-style-tt">0020</span>», «<span class="tex-font-style-tt">00209</span>».</p><p>В первом примере кодом города является строка «<span class="tex-font-style-tt">00</span>».</p><p>Во втором примере кодом города является пустая строка.</p><p>В третьем примере кодом города является строка «<span class="tex-font-style-tt">770123456789</span>».</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Период псевдослучайной последовательности</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Недавно Поликарп заинтересовался последовательностями псевдослучайных чисел. Он узнал, что во многих языках программирования такие последовательности генерируются одинаковым образом: <img align="middle" class="tex-formula" src="http://codeforces.ru/renderer/1505a2bb013efb7ab20b04ab4c345c19fef97ccb.png" /> (для <span class="tex-span"><i>i</i> ≥ 1</span>). Здесь <span class="tex-span"><i>a</i></span>, <span class="tex-span"><i>b</i></span>, <span class="tex-span"><i>m</i></span> — константы, фиксированные для данной реализации генератора псевдослучайных чисел, <span class="tex-span"><i>r</i><sub class="lower-index">0</sub></span> — так называемый <span class="tex-span"><i>randseed</i></span> (это значение может быть установлено из программы с помощью функций вроде <span class="tex-font-style-tt">RandSeed(r)</span> или <span class="tex-font-style-tt">srand(n)</span>), а <img align="middle" class="tex-formula" src="http://codeforces.ru/renderer/e91a39ad64cd7a33e8f1b67cd60e5b40257de950.png" /> обозначает операцию взятия остатка от деления.</p><p>Например, если <span class="tex-span"><i>a</i> = 2, <i>b</i> = 6, <i>m</i> = 12, <i>r</i><sub class="lower-index">0</sub> = 11</span>, то генерируемая последовательность будет иметь вид: <span class="tex-span">4, 2, 10, 2, 10, 2, 10, 2, 10, 2, 10, ...</span>.</p><p>Поликарп понял, что любая такая последовательность рано или поздно зациклится, но цикл может встретиться не сразу, то есть существует предпериод и период. В примере выше длина предпериода равна 1, а периода — 2.</p><p>Ваша задача — найти период такой последовательности по заданным <span class="tex-span"><i>a</i>, <i>b</i>, <i>m</i></span> и <span class="tex-span"><i>r</i><sub class="lower-index">0</sub></span>. Формально, необходимо найти минимальное натуральное <span class="tex-span"><i>t</i></span>, для которого существует такое натуральное <span class="tex-span"><i>k</i></span>, что для любого <span class="tex-span"><i>i</i> ≥ <i>k</i></span>: <span class="tex-span"><i>r</i><sub class="lower-index"><i>i</i></sub> = <i>r</i><sub class="lower-index"><i>i</i> + <i>t</i></sub></span>.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В единственной строке входных данных записаны через пробел четыре целых числа <span class="tex-span"><i>a</i></span>, <span class="tex-span"><i>b</i></span>, <span class="tex-span"><i>m</i></span> и <span class="tex-span"><i>r</i><sub class="lower-index">0</sub></span> (<span class="tex-span">1 ≤ <i>m</i> ≤ 10<sup class="upper-index">5</sup>, 0 ≤ <i>a</i>, <i>b</i> ≤ 1000, 0 ≤ <i>r</i><sub class="lower-index">0</sub> &lt; <i>m</i></span>).</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите единственное целое число — искомый период последовательности.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>2 6 12 11<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>2 3 5 1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>4<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>3 6 81 9<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>1<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>Первый пример разобран выше.</p><p>Во втором примере последовательность имеет вид (начиная с первого элемента): <span class="tex-span">0, 3, 4, 1, 0, 3, 4, 1, 0, ...</span></p><p>В третьем примере последовательность имеет вид (начиная с первого элемента): <span class="tex-span">33, 24, 78, 78, 78, 78, ...</span></p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Маршрутка</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Рядом с университетом находится остановка маршрутки. Пары закончились, и <span class="tex-span"><i>n</i></span> студентов приходят на остановку. <span class="tex-span"><i>i</i></span>-ый студент появляется на остановке в момент времени <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span> (все <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span> различны).</p><p>Будем считать, что остановка находится в точке координатной прямой <span class="tex-span"><i>x</i> = 0</span>, а маршрутка ходит вдоль луча <span class="tex-span"><i>Ox</i></span>, то есть в сторону положительного направления координатной прямой и обратно. <span class="tex-span"><i>i</i></span>-ому студенту нужно попасть в точку с координатой <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub> &gt; 0</span>).</p><p>Маршрутка перемещается по следующему алгоритму. Изначально она находится в точке 0. Студенты последовательно приходят на остановку и садятся в нее. Как только в маршрутку сядет <span class="tex-span"><i>m</i></span> студентов или сядет последний студент из <span class="tex-span"><i>n</i></span>, она отправится в сторону положительного направления координатной прямой. Маршрутка двигается со скоростью 1 единица расстояния в 1 единицу времени, то есть за время <span class="tex-span"><i>y</i></span> она проезжает расстояние <span class="tex-span"><i>y</i></span>.</p><p>Каждый раз, когда маршрутка проезжает точку, в которой нужно выйти хотя бы одному студенту, она останавливается, и эти студенты выходят. На высадку студентов тратится <span class="tex-span">1 + [<i>k</i> / 2]</span> единиц времени, где <span class="tex-span"><i>k</i></span> — количество студентов, которые выходят в этой точке. Запись <span class="tex-span">[<i>k</i> / 2]</span> обозначает целую часть при делении <span class="tex-span"><i>k</i></span> на <span class="tex-span">2</span>. Как только из маршрутки выходит последний студент, она разворачивается и едет без остановок обратно в точку <span class="tex-span"><i>x</i> = 0</span>. Там она вновь наполняется студентами, и история повторяется.</p><p>Если студенты приходят на остановку, когда маршрутки там нет, они встают в очередь и садятся в маршрутку в том порядке, в котором они пришли. Посадка любого количества студентов и остальные действия происходит мгновенно, а других пассажиров нет.</p><p>Напишите программу, которая определит для каждого студента момент времени, когда он вышел из маршрутки. Моментом выхода студента из маршрутки считайте момент ее остановки в точке выхода студента (несмотря на то, что высадка группы студентов произойдет не мгновенно).</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке записаны через пробел два целых числа <span class="tex-span"><i>n</i>, <i>m</i></span> (<span class="tex-span">1 ≤ <i>n</i>, <i>m</i> ≤ 10<sup class="upper-index">5</sup></span>) — количество студентов и количество мест в маршрутке, соответственно. Далее в <span class="tex-span"><i>n</i></span> строках описаны студенты, по одному в строке. Каждая строка содержит пару целых чисел <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub>, <i>x</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>t</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">5</sup>, 1 ≤ <i>x</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">4</sup></span>). Строки заданы в порядке строгого возрастания <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span>. Значения <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> могут совпадать.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите <span class="tex-span"><i>n</i></span> чисел <span class="tex-span"><i>w</i><sub class="lower-index">1</sub>, <i>w</i><sub class="lower-index">2</sub>, ..., <i>w</i><sub class="lower-index"><i>n</i></sub></span>, <span class="tex-span"><i>w</i><sub class="lower-index"><i>i</i></sub></span> — момент времени, когда <span class="tex-span"><i>i</i></span>-ый студент вышел из маршрутки. Числа выводите в одну строку и разделяйте единичными пробелами.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>1 10<br />3 5<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>8<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>2 1<br />3 5<br />4 5<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>8 19<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>5 4<br />3 5<br />4 5<br />5 5<br />6 5<br />7 1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>11 11 11 11 20<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>20 4<br />28 13<br />31 13<br />35 6<br />36 4<br />52 6<br />53 4<br />83 2<br />84 4<br />87 1<br />93 6<br />108 4<br />113 6<br />116 1<br />125 2<br />130 2<br />136 13<br />162 2<br />166 4<br />184 1<br />192 2<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>51 51 43 40 93 89 86 89 114 121 118 121 137 139 139 152 195 199 193 195<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом примере маршрутка ждет первого студента <span class="tex-span">3</span> единицы времени и отвозит его до места назначения за <span class="tex-span">5</span> единиц времени. То есть студент выходит из маршрутки в момент времени <span class="tex-span">3 + 5 = 8</span>.</p><p>Во втором примере вместимость маршрутки равна <span class="tex-span">1</span>, поэтому сначала она повезет одного первого студента. Этот студент — такой же, как студент в первом примере, то есть маршрутка доезжает до его места назначения в момент времени <span class="tex-span">8</span>, тратит на высадку <span class="tex-span">1 + [1 / 2] = 1</span> единицу времени, и возвращается назад еще за <span class="tex-span">5</span> единиц времени. Таким образом, маршрутка возвращается назад в момент времени <span class="tex-span">14</span>. К этому моменту второй студент уже подошел к остановке, поэтому он садится в маршрутку, <span class="tex-span">5</span> единиц времени едет до места назначения, и приезжает в момент <span class="tex-span">14 + 5 = 19</span>. </p><p>В третьем примере маршрутка ждет четвертого студента <span class="tex-span">6</span> единиц времени, затем едет <span class="tex-span">5</span> единиц времени, затем высаживает студентов за <span class="tex-span">1 + [4 / 2] = 3</span> единиц времени, возвращается за <span class="tex-span">5</span> единиц времени, везет пятого студента <span class="tex-span">1</span> единицу времени.</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Реформа календаря</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>4 seconds</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 megabytes</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>В Берляндии снова реформы! На этот раз парламент обсуждает реформу календаря. Чтобы сделать жизнь граждан Берляндии разнообразнее, решено изменить календарь. Так как все большее количество граждан жалуются, что «годы летят...», решено что с нового года количество дней в году будет неуклонно расти. Так в предстоящем году будет ровно <span class="tex-span"><i>a</i></span> дней, в следующем <span class="tex-span"><i>a</i> + 1</span> день, затем <span class="tex-span"><i>a</i> + 2</span> и так далее. Такой график планируется на ближайшие <span class="tex-span"><i>n</i></span> лет (в <span class="tex-span"><i>n</i></span>-ый год длина года будет составлять <span class="tex-span"><i>a</i> + <i>n</i> - 1</span> день).</p><p>Что станет с месяцами — пока не решено. Депутат Палевный выступил со следующим предложением. <ul> <li> Календарь каждого месяца удобно печатать на квадратном листе бумаге. Предлагается сделать так, что количество дней в каждом месяце должно быть квадратом некоторого натурального числа. Количество дней в месяце должно быть одинаковым для каждого месяца любого года, но может отличаться для разных лет. </li><li> Количество дней в месяце должно делить количество дней в году этого месяца. Это правило гарантирует, что количество месяцев в каждом году — это целое число. </li><li> Количество дней в месяце для каждого года надо подбирать так, чтобы сэкономить максимальное количество бумаги на печати календарей. Иными словами, количество дней в месяце должно быть как можно больше. </li></ul></p><p>Эти правила дают однозначное правило выбора количества дней в каждом месяце года при фиксированной длине года. Например, согласно предложению Палевного, год, состоящий из 108 дней, будет содержать три месяца по 36 дней в каждом, год из 99 дней будет состоять из 11 месяцев по 9 дней, а год из 365 дней — из 365 месяцев по одному дню.</p><p>Предложение вызвало бурное обсуждение в обществе, известный математик Перельманов быстро посчитал, что если предложение будет поддержано, то в период <span class="tex-span"><i>n</i></span> лет, начиная с года в котором <span class="tex-span"><i>a</i></span> дней, будет израсходовано <span class="tex-span"><i>p</i></span> листов бумаги для печати комплекта календарей всех лет. В расчетах Перельманов учитывал, что комплект будет содержать по одному календарю каждого года, а каждый месяц будет напечатан на отдельном листе.</p><p>Повторите достижение Перельманова и выведите искомое число <span class="tex-span"><i>p</i></span> по заданным натуральным <span class="tex-span"><i>a</i></span> и <span class="tex-span"><i>n</i></span>. Перельманов предостерегает вас, что ваша программа не должна работать более четырех секунд на максимальном тесте.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>Единственная строка входных данных содержит пару целых чисел <span class="tex-span"><i>a</i></span>, <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>a</i>, <i>n</i> ≤ 10<sup class="upper-index">7</sup>;</span> <span class="tex-span"><i>a</i> + <i>n</i> - 1 ≤ 10<sup class="upper-index">7</sup></span>).</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите искомое число <span class="tex-span"><i>p</i></span>. </p><p>Пожалуйста, не используйте спецификатор %lld для чтения или записи 64-битных чисел на C++. Рекомендуется использовать потоки cin, cout или спецификатор %I64d.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>25 3<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>30<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>50 5<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>125<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>Пояснение к первому тесту. Год из 25-ти дней будет содержать один месяц из 25-ти дней. Год из 26-ти дней будет содержать 26 месяцев по одному дню каждый. Год из 27-ми дней будет содержать три месяца по 9 дней каждый.</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. BHTML+BCSS</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>8 секунд</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p><span class="tex-font-style-it">В этой задаче речь пойдет о вымышленных языках BHTML и BCSS, которые слегка напоминают HTML и CSS. Внимательно ознакомьтесь с условием задачи, так как схожесть лишь отдаленная, а в задаче используются крайне упрощенные аналоги.</span></p><p>Задан BHTML-документ, который похож на HTML, но значительно проще. Записывается он как последовательность открывающих и закрывающих тегов. Тег вида «<span class="tex-font-style-tt">&lt;имятега&gt;</span>» называется открывающим, а тег вида «<span class="tex-font-style-tt">&lt;/имятега&gt;</span>» — закрывающим. Кроме того, есть самозакрывающиеся теги, которые записываются в виде «<span class="tex-font-style-tt">&lt;имятега/&gt;</span>» и в этой задаче полностью эквивалентны «<span class="tex-font-style-tt">&lt;имятега&gt;&lt;/имятега&gt;</span>». Все имена тегов в этой задаче — строки из строчных латинских букв, имеющие длину от 1 до 10 символов. Некоторые теги могут иметь одинаковые имена.</p><p>Теги в документе образуют правильную скобочную последовательность, то есть из заданной последовательности можно получить пустую с помощью операций: <ul> <li> удалить любой самозакрывающийся тег «<span class="tex-font-style-tt">&lt;имятега/&gt;</span>», </li><li> удалить пару открывающий-закрывающий тег, которые идут подряд (в таком порядке) и имеют одинаковые имена, то есть подстроку «<span class="tex-font-style-tt">&lt;имятега&gt;&lt;/имятега&gt;</span>». </li></ul></p><p>Например, вам может быть задан документ «<span class="tex-font-style-tt">&lt;header&gt;&lt;p&gt;&lt;a/&gt;&lt;b&gt;&lt;/b&gt;&lt;/p&gt;&lt;/header&gt;&lt;footer&gt;&lt;/footer&gt;</span>», но не могут быть заданы документы «<span class="tex-font-style-tt">&lt;a&gt;</span>», «<span class="tex-font-style-tt">&lt;a&gt;&lt;/b&gt;</span>», «<span class="tex-font-style-tt">&lt;/a&gt;&lt;a&gt;</span>» или «<span class="tex-font-style-tt">&lt;a&gt;&lt;b&gt;&lt;/a&gt;&lt;/b&gt;</span>».</p><p>Очевидно, для каждого открывающего тега существует единственный парный закрывающий — каждая такая пара называется <span class="tex-font-style-it">элементом</span>. Самозакрывающийся тег — тоже элемент. Говорят, что один элемент вложен в другой, если теги первого находятся между тегами второго. Считается, что никакой элемент не вложен сам в себя. Например, в примере выше элемент «<span class="tex-font-style-tt">b</span>» вложен в «<span class="tex-font-style-tt">header</span>» и в «<span class="tex-font-style-tt">p</span>», но не вложен в «<span class="tex-font-style-tt">a</span>» и «<span class="tex-font-style-tt">footer</span>», а также не вложен в самого себя («b»). Элемент «<span class="tex-font-style-tt">header</span>» имеет три вложенных в него элемента, а «<span class="tex-font-style-tt">footer</span>» — ноль.</p><p>Правила BCSS нужны для назначения стилей при выводе элементов документов BHTML. Каждое правило записывается в виде последовательностей слов «<span class="tex-font-style-tt"><span class="tex-span"><i>x</i><sub class="lower-index">1</sub></span> <span class="tex-span"><i>x</i><sub class="lower-index">2</sub></span> ... <span class="tex-span"><i>x</i><sub class="lower-index"><i>n</i></sub></span></span>». Под это правило попадают все такие элементы <span class="tex-span"><i>t</i></span>, которые удовлетворяют пунктам из списка:</p><p><ul> <li> существует последовательность вложенных элементов с именами тегов «<span class="tex-font-style-tt"><span class="tex-span"><i>x</i><sub class="lower-index">1</sub></span></span>», «<span class="tex-font-style-tt"><span class="tex-span"><i>x</i><sub class="lower-index">2</sub></span></span>», ..., «<span class="tex-font-style-tt"><span class="tex-span"><i>x</i><sub class="lower-index"><i>n</i></sub></span></span>» (то есть второй элемент вложен в первый, третий во второй и так далее), </li><li> эта последовательность заканчивается элементом <span class="tex-span"><i>t</i></span>. </li></ul></p><p>Например, правилу «<span class="tex-font-style-tt">a b</span>» удовлетворяют все такие элементы «<span class="tex-font-style-tt">b</span>» для которых существует элемент «<span class="tex-font-style-tt">a</span>», в который они вложены. Правилу «<span class="tex-font-style-tt">a b b c</span>» удовлетворяют все такие элементы «<span class="tex-font-style-tt">c</span>» для которых существует три элемента «<span class="tex-font-style-tt">a</span>», «<span class="tex-font-style-tt">b</span>», «<span class="tex-font-style-tt">b</span>», что в цепочке «<span class="tex-font-style-tt">a</span>»-«<span class="tex-font-style-tt">b</span>»-«<span class="tex-font-style-tt">b</span>»-«<span class="tex-font-style-tt">c</span>» каждый очередной элемент вложен в предыдущий.</p><p>Напишите программу, которая по заданному BHTML-документу и набору BCSS-правил определяет количество элементов, которые удовлетворяют каждому из правил.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке входных данных записан BHTML-документ. Документ имеет длину от <span class="tex-span">4</span> до <span class="tex-span">10<sup class="upper-index">6</sup></span> символов. Документ имеет правильную структуру, не содержит пробелов или каких-либо других лишних символов. Имена тегов состоят из строчных латинских букв, их длины — от 1 до 10 символов.</p><p>Вторая строка содержит целое число <span class="tex-span"><i>m</i></span> (<span class="tex-span">1 ≤ <i>m</i> ≤ 200</span>) — количество запросов. Далее в <span class="tex-span"><i>m</i></span> строках записаны сами запросы по одному в строке. Каждый запрос — это последовательность <span class="tex-span"><i>x</i><sub class="lower-index">1</sub>, <i>x</i><sub class="lower-index">2</sub>, ..., <i>x</i><sub class="lower-index"><i>n</i></sub></span>, где <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> — <span class="tex-span"><i>i</i></span>-ый элемент запроса, а <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 200</span>) — количество элементов в запросе. Элементы записаны через единичные пробелы, запись правила не начинается и не заканчивается пробелом. Каждый элемент запроса — последовательность строчных латинских букв длины от 1 до 10.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите <span class="tex-span"><i>m</i></span> строк, <span class="tex-span"><i>j</i></span>-ая строка должна содержать количество элементов документа, которые соответствуют <span class="tex-span"><i>j</i></span>-ому BCSS-правилу. Если таких элементов вообще нет, то выведите в строку <span class="tex-font-style-tt">0</span>.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>&lt;a&gt;&lt;b&gt;&lt;b&gt;&lt;/b&gt;&lt;/b&gt;&lt;/a&gt;&lt;a&gt;&lt;b&gt;&lt;/b&gt;&lt;b&gt;&lt;v/&gt;&lt;/b&gt;&lt;/a&gt;&lt;b&gt;&lt;/b&gt;<br />4<br />a<br />a b b<br />a b<br />b a<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2<br />1<br />4<br />0<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>&lt;b&gt;&lt;aa/&gt;&lt;/b&gt;&lt;aa&gt;&lt;b/&gt;&lt;b/&gt;&lt;/aa&gt;<br />5<br />aa b<br />b<br />aa<br />b aa<br />a<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2<br />3<br />2<br />1<br />0<br /></pre></div></div></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>

    <br style="clear:both;"/>

    <div id="footer">
        <div><a href="http://codeforces.ru/">Codeforces</a> (c) Copyright 2010-2013 Михаил Мирзаянов</div>
        <div>Соревнования по программированию 2.0</div>

    </div>
</div>
</div>
</body>
</html>                                       
