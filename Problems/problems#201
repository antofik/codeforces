
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="5fe40a51f191f83d787f6ehe903119c2"/>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="http://worker.codeforces.ru/static/images/codeforces-vk-square-ru.png"/>
    <meta property="og:title" content="Задачи - Codeforces"/>
    <meta property="og:site_name" content="Codeforces"/>
    
    <meta name="cc" content="cqtevr44dvut"/>
    
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Задачи - Codeforces</title>
        <meta name="description" content="Codeforces. Соревнования и олимпиады по информатике и программированию, сообщество программистов" />
        <meta name="keywords" content="программирование информатика контест олимпиада алгоритмы c++ java графы vkcup" />
    <meta name="robots" content="index, follow" />

    <link href="http://worker.codeforces.ru/static/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

    <HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--CombineResourcesFilter-->
    
<LINK href="http://worker.codeforces.ru/static/favicon.png" rel="shortcut icon" type="image/png">
    
<LINK href="http://worker.codeforces.ru/static/css/prettify.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/clear.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/style.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/ttypography.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/problem-statement.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/second-level-menu.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/roundbox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/datatable.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/topic.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/table-form.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.jgrowl.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/facebox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.wysiwyg.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/codeforces.datepick.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/colorbox.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/jquery.drafts.css" rel="stylesheet" type="text/css">
    
<LINK href="http://worker.codeforces.ru/static/markitup/skins/markitup/style.css" rel="stylesheet" type="text/css">
    
<LINK href="http://worker.codeforces.ru/static/markitup/sets/markdown/style.css" rel="stylesheet" type="text/css">

    
<SCRIPT charset="utf-8" src="//yandex.st/share/share.js" type="text/javascript"></SCRIPT>
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/sidebar-menu.css" rel="stylesheet" type="text/css">
    
<LINK charset="utf-8" href="http://worker.codeforces.ru/static/css/community.css" rel="stylesheet" type="text/css">

    <!--[if IE]>
        <style>
            #sidebar {
                padding-left: 1em;
                margin: 1em 1em 1em 0;
            }
        </style>
    <![endif]-->
    
    
<SCRIPT src="http://worker.codeforces.ru/static/js/prettify/prettify.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery-1.8.3.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/sockjs-0.2.1.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/vertxbus-1.2.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.easing.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.lavalamp.min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.jgrowl.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/facebox.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.wysiwyg.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.colorpicker.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.table.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.image.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/controls/wysiwyg.link.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.autocomplete.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.datepick.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.ie6blocker.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.colorbox-min.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.ba-bbq.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/jquery.drafts.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/js/codeforces.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/markitup/jquery.markitup.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://worker.codeforces.ru/static/markitup/sets/markdown/set.js" type="text/javascript"></SCRIPT>
    <!--/CombineResourcesFilter-->
</HEAD>
</HTML>

        <script type="text/javascript" src="http://worker.codeforces.ru/static/js/jquery.datepick-ru.js"></script>
        <script src="http://vk.com/js/api/openapi.js" type="text/javascript"></script>
</head>
<body><span style='display:none;' class='csrf-token' data-csrf='5fe40a51f191f83d787f6ehe903119c2'>&nbsp;</span>
<!-- Codeforces javascripts. -->
<script type="text/javascript">
    VK.init({apiId: 1961905});
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>

    <script type="text/javascript">
        $(document).ready(function() {
    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    $(".second-level-menu-list").lavaLamp({
        fx: "backout",
        speed: 1000
    });


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


        });
    </script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<div id="body">
<div style="width: 950px; margin: 0 auto;">
    <div id="header" style="position:relative;">
        <div style="float:left;">
                <a href="/"><img src="http://worker.codeforces.ru/static/images/codeforces-logo-with-upper-beta.png"/></a>
                        <div style="position:absolute;left:97px;top:40px;">
                            <a href="http://vk.com" class="logo-href">При поддержке <img
                                    style="position:relative;top:5px;" src="http://worker.codeforces.ru/static/images/vkontakte-tiny-ru.png"/></a>
                        </div>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="http://worker.codeforces.ru/static/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="http://worker.codeforces.ru/static/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <div style="text-align: center;font-size: 18px;margin-bottom: 0.5em;"
         class="caption">Codeforces Round #127 (Div. 1)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Четкая симметрия</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Рассмотрим некоторую квадратную матрицу <span class="tex-span"><i>A</i></span> со стороной <span class="tex-span"><i>n</i></span>, состоящую из нулей и единиц. Пронумеруем ее строки от <span class="tex-span">1</span> до <span class="tex-span"><i>n</i></span> сверху вниз и столбцы от <span class="tex-span">1</span> до <span class="tex-span"><i>n</i></span> слева направо. Элемент матрицы, находящийся на пересечении <span class="tex-span"><i>i</i></span>-ой строки и <span class="tex-span"><i>j</i></span>-го столбца, будем обозначать <span class="tex-span"><i>A</i><sub class="lower-index"><i>i</i>, <i>j</i></sub></span>.</p><p>Назовем матрицу <span class="tex-span"><i>A</i></span> <span class="tex-font-style-it">четкой</span>, если никакие две клетки, в которых стоят единицы, не имеют общей стороны.</p><p>Назовем матрицу <span class="tex-span"><i>A</i></span> <span class="tex-font-style-it">симметричной</span>, если она в точности совпадает с матрицами, образованными из нее горизонтальным и/или вертикальным отражением. Формально, для любой пары <span class="tex-span">(<i>i</i>, <i>j</i>)</span> <span class="tex-span">(1 ≤ <i>i</i>, <i>j</i> ≤ <i>n</i>)</span> оба следующих условия должны быть выполнены: <span class="tex-span"><i>A</i><sub class="lower-index"><i>i</i>, <i>j</i></sub> = <i>A</i><sub class="lower-index"><i>n</i> - <i>i</i> + 1, <i>j</i></sub></span> и <span class="tex-span"><i>A</i><sub class="lower-index"><i>i</i>, <i>j</i></sub> = <i>A</i><sub class="lower-index"><i>i</i>, <i>n</i> - <i>j</i> + 1</sub></span>.</p><p><span class="tex-font-style-it">Остротой</span> матрицы <span class="tex-span"><i>A</i></span> назовем количество единиц в ней.</p><p>Ваша задача — по заданному числу <span class="tex-span"><i>x</i></span> найти минимальное натуральное число <span class="tex-span"><i>n</i></span> такое, что существует четкая симметричная матрица <span class="tex-span"><i>A</i></span> со стороной <span class="tex-span"><i>n</i></span> и остротой <span class="tex-span"><i>x</i></span>.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В единственной строке записано целое число <span class="tex-span"><i>x</i></span> (<span class="tex-span">1 ≤ <i>x</i> ≤ 100</span>) — требуемая острота матрицы.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите единственное число — искомое значение <span class="tex-span"><i>n</i></span>.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>4<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>3<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>9<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>5<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>Соответствующие примерам матрицы приведены на рисунке:</p><p><center> <img class="tex-graphics" src="http://codeforces.ru/renderer/150c63ada44000050efaba7352577cbdd89312ec.png" /> </center></p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Угадай автомобиль!</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Широко известный в узких кругах белорусский олимпиадник Юра владеет громадным количеством информации об автомобилях. В связи с этим его пригласили поучаствовать в ток-шоу «Угадай автомобиль!».</p><p>Место проведения ток-шоу представляет собой гигантскую автомобильную стоянку протяженностью <span class="tex-span">4<i>n</i></span> метров с севера на юг и <span class="tex-span">4<i>m</i></span> метров с запада на восток. На стоянке начерчены <span class="tex-span"><i>n</i> + 1</span> разделительных полос, проходящих с запада на восток и <span class="tex-span"><i>m</i> + 1</span> разделительных полос, проходящих с севера на юг, которые разделяют стоянку на <span class="tex-span"><i>n</i>·<i>m</i></span> квадратов размером <span class="tex-span">4</span> на <span class="tex-span">4</span> метра. Строго внутри каждого квадрата припаркован автомобиль. Разделительные полосы пронумерованы от <span class="tex-span">0</span> до <span class="tex-span"><i>n</i></span> с севера на юг и от <span class="tex-span">0</span> до <span class="tex-span"><i>m</i></span> с запада на восток. Каждый квадрат имеет координаты <span class="tex-span">(<i>i</i>, <i>j</i>)</span> таким образом, что квадрат в северо-западном углу имеет координаты <span class="tex-span">(1, 1)</span>, а квадрат в юго-восточном — координаты <span class="tex-span">(<i>n</i>, <i>m</i>)</span>. Смотрите рисунок в примечаниях для уточнения.</p><p>Перед началом ток-шоу организаторы предлагают Юре занять любую из <span class="tex-span">(<i>n</i> + 1)·(<i>m</i> + 1)</span> точек пересечения разделительных полос, после чего он приступит к угадыванию. После выбора точки Юре будет запрещено перемещаться по стоянке до окончания ток-шоу. Поскольку Юра является автомобильным гуру, то он все равно угадает все предложенные автомобили, это всего лишь вопрос времени. По себе Юра знает, что на угадывание каждой машины ему нужно потратить время, равное квадрату евклидова расстояния между точкой, где он находится, и центром квадрата, в котором находится эта машина, умноженному на некоторый коэффициент, характеризующий «необычность» машины (более редкие машины сложнее угадывать). Более формально, на угадывание автомобиля, имеющего «необычность» <span class="tex-span"><i>c</i></span> и находящегося в квадрате, от центра которого до Юры <span class="tex-span"><i>d</i></span> метров, он потратит <span class="tex-span"><i>c</i>·<i>d</i><sup class="upper-index">2</sup></span> секунд. Временем, которое Юра тратит на повороты головы, можно пренебречь.</p><p>Так уж вышло, что Юра заранее знает «необычность» каждого автомобиля, находящегося на стоянке. Помогите ему выбрать точку для угадывания таким образом, чтобы суммарное время угадывания всех автомобилей было как можно меньше.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке заданы числа <span class="tex-span"><i>n</i></span> и <span class="tex-span"><i>m</i></span> <span class="tex-span">(1 ≤ <i>n</i>, <i>m</i> ≤ 1000)</span> — размеры автомобильной стоянки. Следующие <span class="tex-span"><i>n</i></span> строк содержат по <span class="tex-span"><i>m</i></span> чисел каждая: <span class="tex-span"><i>j</i></span>-е число в <span class="tex-span"><i>i</i></span>-й строке характеризует «необычность» <span class="tex-span"><i>c</i><sub class="lower-index"><i>ij</i></sub></span> (<span class="tex-span">0 ≤ <i>c</i><sub class="lower-index"><i>ij</i></sub> ≤ 100000</span>) автомобиля, находящегося в квадрате с координатами <span class="tex-span">(<i>i</i>, <i>j</i>)</span>.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>В первой строке выведите минимальное суммарное время, за которое Юра угадает все предложенные автомобили. Во второй строке выведите два числа <span class="tex-span"><i>l</i><sub class="lower-index"><i>i</i></sub></span> и <span class="tex-span"><i>l</i><sub class="lower-index"><i>j</i></sub></span> (<span class="tex-span">0 ≤ <i>l</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>, 0 ≤ <i>l</i><sub class="lower-index"><i>j</i></sub> ≤ <i>m</i></span>) — номера разделительных полос, на пересечении которых Юра должен начинать ток-шоу. В случае, если существует несколько оптимальных стартовых точек, выведите точку с меньшим <span class="tex-span"><i>l</i><sub class="lower-index"><i>i</i></sub></span>. Если и таких точек несколько, выведите точку с меньшим <span class="tex-span"><i>l</i><sub class="lower-index"><i>j</i></sub></span>.</p><p>Пожалуйста, не используйте спецификатор <span class="tex-font-style-tt">%lld</span> для чтения или записи 64-битных чисел на С++. Рекомендуется использовать потоки <span class="tex-font-style-tt">cin</span>, <span class="tex-font-style-tt">cout</span> или спецификатор <span class="tex-font-style-tt">%I64d</span>.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>2 3<br />3 4 5<br />3 9 1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>392<br />1 1<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>3 4<br />1 0 0 0<br />0 0 3 0<br />0 0 5 5<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>240<br />2 3<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом тесте суммарное время вычисляется как <span class="tex-span">3·8 + 3·8 + 4·8 + 9·8 + 5·40 + 1·40 = 392</span> </p><p>Система координат на поле: <center> <img class="tex-graphics" src="http://codeforces.ru/renderer/2414f5382c8742f1d7b1161abbc5e03078ffe53b.png" /> </center></p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Хрупкие мосты</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Вы играете в компьютерную игру и только что дошли до бонусного уровня, единственная возможная цель которого — набрать как можно больше очков. Будучи максималистом, вы решили, что не уйдете с этого уровня, не набрав максимально возможное количество очков на нем.</p><p>Бонусный уровень состоит из <span class="tex-span"><i>n</i></span> небольших платформ, расположенных в ряд и пронумерованных слева направо от <span class="tex-span">1</span> до <span class="tex-span"><i>n</i></span>, и <span class="tex-span">(<i>n</i> - 1)</span> мостов, соединяющих каждую пару соседних платформ. Мосты между платформами весьма хрупкие, и для каждого моста заранее известно количество раз, которое можно пройти по этому мосту от одного конца до другого перед тем, как этот мост рухнет навсегда.</p><p>Действия игрока заключаются в следующем. Сначала он выбирает одну из платформ, на которой и располагает своего героя. После этого игрок может свободно перемещать своего героя между платформами, двигаясь по еще не разрушенным мостам. Как только оказывается, что от платформы, на которой находится герой, не отходит ни одного нерухнувшего моста, уровень автоматически заканчивается. Количество очков, набранное игроком, по окончании уровня вычисляется как количество переходов, сделанных героем между платформами. Учтите, что если герой начал движение по некоторому мосту, то он обязан его продолжить в том же направлении, пока не окажется на платформе.</p><p>Определите, какое количество очков вам нужно набрать, чтобы быть уверенным, что ваш рекорд никто не побьет, и со спокойной душой перейти к следующему уровню.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке содержится целое число <span class="tex-span"><i>n</i></span> (<span class="tex-span">2 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup></span>) — количество платформ на бонусном уровне. Вторая строка содержит (<span class="tex-span"><i>n</i> - 1</span>) целых чисел <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>, <span class="tex-span">1 ≤ <i>i</i> &lt; <i>n</i></span>) — количество переходов от одного конца до другого, которое может выдержать мост между платформами <span class="tex-span"><i>i</i></span> и <span class="tex-span"><i>i</i> + 1</span>.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите единственное число — максимальное количество очков, которое можно набрать на бонусном уровне.</p><p>Пожалуйста, не используйте спецификатор <span class="tex-font-style-tt">%lld</span> для чтения или записи 64-битных чисел на С++. Рекомендуется использовать потоки <span class="tex-font-style-tt">cin</span>, <span class="tex-font-style-tt">cout</span> или спецификатор <span class="tex-font-style-tt">%I64d</span>.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>5<br />2 1 2 1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>5<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>Один из вариантов получить <span class="tex-span">5</span> очков в примере — начав с платформы <span class="tex-span">3</span>, последовательно переходить на платформы <span class="tex-span">4</span>, <span class="tex-span">3</span>, <span class="tex-span">2</span>, <span class="tex-span">1</span> и <span class="tex-span">2</span>. После этого единственным нерухнувшим мостом останется мост между платформами <span class="tex-span">4</span> и <span class="tex-span">5</span>, однако этот мост слишком далек от платформы <span class="tex-span">2</span>, на которой расположен герой.</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 4em;page-break-after: always;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Инновационно новая задача</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>5 секунд</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Широко известный в узких кругах белорусский олимпиадник Леша решил немного подзаработать, чтобы купить себе квартиру площадью на один квадратный метр больше. Для этого он хочет составить и провести Super Rated Match (SRM) на сайте Torcoder.com. Но вот беда — суровый торкодерский координатор Иван не принимает ни одной Лешиной задачи, называя каждую обидным словом «боян». И вот после очередной предложенной задачи дело чуть не дошло до взаимной обиды. </p><p>Вам предлагается выступить в роли справедливого судьи и определить, действительно ли задача является настолько <span class="tex-font-style-it">инновационно новой</span>, как уверен в этом Леша, или все-таки Иван прав, и похожая задача уже встречалась в прошедших SRM.</p><p>Вам даны описания Лешиной задачи и задач из архива сайта Torcoder.com. Описание каждой задачи представляет собой последовательность слов. При этом гарантируется, что слова в Лешиной задаче не повторяются, в то время как описание задачи из архива может содержать произвольное количество повторяющихся слов.</p><p>«Похожесть» Лешиной задачи на некоторую задачу из архива определим следующим образом. Среди всех перестановок слов предлагаемой задачи выберем ту, которая встречается в задаче из архива в качестве подпоследовательности. Если таких перестановок несколько, выберем ту, число инверсий в которой минимально. Тогда «похожесть» задачи можно записать в виде <img align="middle" class="tex-formula" src="http://codeforces.ru/renderer/e030ac55efb4d1b310573b6c32117d80ccefc0fd.png" />, где <span class="tex-span"><i>n</i></span> — количество слов в задаче Леши, а <span class="tex-span"><i>x</i></span> — количество инверсий в выбранной перестановке. Обратите внимание, что «похожесть» <span class="tex-span"><i>p</i></span> — положительное число.</p><p>Задачу назовем <span class="tex-font-style-it">инновационно новой</span>, если среди задач из архива Ивана не найдется ни одной задачи, которая содержит в себе в качестве подпоследовательности некоторую перестановку слов Лешиной задачи.</p><p>Рассудите ребят, определив, является ли предлагаемая задача новой, либо указав задачу из архива, которая больше всего напоминает Лешину задачу.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>Первая строка содержит число <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 15</span>) — количество слов в Лешиной задаче. Во второй строке находятся <span class="tex-span"><i>n</i></span> слов, разделенных пробелом — краткое описание задачи.</p><p>Третья строка содержит число <span class="tex-span"><i>m</i></span> (<span class="tex-span">1 ≤ <i>m</i> ≤ 10</span>) — количество задач в архиве Torcoder.com. Следующие <span class="tex-span"><i>m</i></span> строк содержат описания задач в формате «<span class="tex-span"><i>k</i></span> <span class="tex-span"><i>s</i><sub class="lower-index">1</sub></span> <span class="tex-span"><i>s</i><sub class="lower-index">2</sub></span> <span class="tex-span">...</span> <span class="tex-span"><i>s</i><sub class="lower-index"><i>k</i></sub></span>», где <span class="tex-span"><i>k</i></span> (<span class="tex-span">1 ≤ <i>k</i> ≤ 500000</span>) — количество слов в задаче, а <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> — слово задачи.</p><p>Слова из описаний всех задач содержат не более 10 строчных латинских букв. Гарантируется, что суммарная длина слов в описаниях всех задач не превышает 500015.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>В случае, если Лешина задача является <span class="tex-font-style-it">инновационно новой</span>, выведите строку «<span class="tex-font-style-tt">Brand new problem!</span>» (без кавычек). </p><p>В противном случае в первой строке выведите номер задачи из архива, наиболее похожей на Лешину задачу. Если таких задач несколько, выведите ту, номер которой минимальный. Во второй строке выведите строку из символов <span class="tex-font-style-tt">[:</span>, символа <span class="tex-font-style-tt">|</span>, повторенного <span class="tex-span"><i>p</i></span> раз, и символов <span class="tex-font-style-tt">:]</span>, где <span class="tex-span"><i>p</i></span> — «похожесть» этой задачи на Лешину. Задачи нумеруются начиная с единицы в том порядке, в котором они заданы во входных данных. </p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>4<br />find the next palindrome<br />1<br />10 find the previous palindrome or print better luck next time<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>1<br />[:||||||:]<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>3<br />add two numbers<br />3<br />1 add<br />2 two two<br />3 numbers numbers numbers<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>Brand new problem!<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>4<br />these papers are formulas<br />3<br />6 what are these formulas and papers<br />5 papers are driving me crazy<br />4 crazy into the night<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>1<br />[:||||:]<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>3<br />add two decimals<br />5<br />4 please two decimals add<br />5 decimals want to be added<br />4 two add decimals add<br />4 add one two three<br />7 one plus two plus three equals six<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>3<br />[:|||:]<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>Напомним, что количество инверсий — это количество пар слов, которые в перестановке идут не в том порядке, в котором они шли в исходной задаче. Так, например, если исходная задача была «add two numbers», то перестановка «numbers add two» содержит две инверсии — пары слов «numbers» и «add», а также «numbers» и «two». </p><p>Последовательность <span class="tex-span"><i>b</i><sub class="lower-index">1</sub>,  <i>b</i><sub class="lower-index">2</sub>,  ...,  <i>b</i><sub class="lower-index"><i>k</i></sub></span> называется подпоследовательностью последовательности <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>,  ...,  <i>a</i><sub class="lower-index"><i>n</i></sub></span>, если найдется такой набор индексов <span class="tex-span">1 ≤ <i>i</i><sub class="lower-index">1</sub> &lt;  <i>i</i><sub class="lower-index">2</sub> &lt; ...   &lt; <i>i</i><sub class="lower-index"><i>k</i></sub> ≤ <i>n</i></span>, что <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i><sub class="lower-index"><i>j</i></sub></sub>  =  <i>b</i><sub class="lower-index"><i>j</i></sub></span>. Иными словами, последовательность <span class="tex-span"><i>b</i></span> может быть получена из <span class="tex-span"><i>a</i></span> путем вычеркивания некоторых элементов.</p><p>В первом тесте первая задача содержит в качестве подпоследовательности перестановку «find the palindrome next», в которой количество инверсий равно 1 (слова «palindrome» и «next»).</p><p>Во втором тесте ни одна из задач не содержит в себе в качестве подпоследовательности перестановку слов задачи, предлагаемой Лешей.</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Насквозь бюрократическая организация</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>На прием в недавно открывшуюся, но уже насквозь бюрократическую организацию (сокращенно НБО) одновременно записались <span class="tex-span"><i>n</i></span> человек. Поскольку организация насквозь бюрократическая, в каждый день она способна принять и обслужить ровно одного человека. Как следствие, каждому из <span class="tex-span"><i>n</i></span> человек был назначен прием в один из последующих <span class="tex-span"><i>n</i></span> дней, причем ни у каких двух людей день приема не совпадает.</p><p>Однако работники организации подходят к работе весьма безответственно, поэтому ни одному из записавшихся людей не была сказана дата приема. Единственный способ узнать, в какие дни нужно приходить определенной группе людей — писать заявления-запросы в НБО. </p><p>Бланк одного заявления-запроса состоит из <span class="tex-span"><i>m</i></span> пустых строчек, в каждую из которых можно вписать имя некоторого человека из записавшихся на прием (а можно оставить пустой). При этом нельзя записывать одного и того же человека на одном заявлении дважды, иначе такой запрос игнорируется. На такие запросы в письменном виде НБО всегда отвечает очень быстро, зато некачественно — а именно, в ответ приходят верные даты приема указанных на бланке людей, однако в совершенно случайном порядке. При этом ответы на все поданные заявления-запросы приходят одновременно в конце дня (на каждом ответе указано, на какое именно заявление это ответ).</p><p>К счастью, вы не входите в группу этих <span class="tex-span"><i>n</i></span> счастливчиков. Ваша задача как стороннего наблюдателя — по заданным <span class="tex-span"><i>n</i></span> и <span class="tex-span"><i>m</i></span> определить, какое минимальное количество заявлений нужно подать в НБО, чтобы однозначно определить дату приема каждого человека.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке содержится целое число <span class="tex-span"><i>t</i></span> (<span class="tex-span">1 ≤ <i>t</i> ≤ 1000</span>) — количество тестовых случаев. В каждой из следующих <span class="tex-span"><i>t</i></span> строк содержатся два числа <span class="tex-span"><i>n</i></span> и <span class="tex-span"><i>m</i></span> (<span class="tex-span">1 ≤ <i>n</i>, <i>m</i> ≤ 10<sup class="upper-index">9</sup></span>) — количество людей, записавшихся на прием в НБО, и количество пустых строчек в заявлении-запросе, соответственно.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите <span class="tex-span"><i>t</i></span> строк, в каждой из которых расположен ответ на соответствующий тестовый случай (в порядке ввода) — минимальное количество заявлений, которое необходимо подать в НБО.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>5<br />4 1<br />4 2<br />7 3<br />1 1<br />42 7<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>3<br />2<br />3<br />0<br />11<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом примере нужно сделать три запроса в НБО, указав в них трех разных людей. Узнав их даты приема, методом исключения можно узнать дату приема четвертого человека, поэтому четвертый запрос не нужен.</p><p>Во втором примере достаточно двух заявлений. Пронумеруем людей от <span class="tex-span">1</span> до <span class="tex-span">4</span> и в первом укажем людей <span class="tex-span">1</span> и <span class="tex-span">2</span>, а во втором — людей <span class="tex-span">1</span> и <span class="tex-span">3</span>. Несложно убедиться, что дату приема каждого человека теперь можно однозначно определить независимо от того, какие ответы получены из НБО.</p><p>В четвертом примере на прием записался всего один человек. Никаких заявлений ему подавать не надо — он записан на завтра.</p></div></div></div>

<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }
    });
</script>
        </div>

    <br style="clear:both;"/>

    <div id="footer">
        <div><a href="http://codeforces.ru/">Codeforces</a> (c) Copyright 2010-2013 Михаил Мирзаянов</div>
        <div>Соревнования по программированию 2.0</div>

    </div>
</div>
</div>
</body>
</html>                                       
