<div class="problem-statement"><div class="header"><div class="title">D. Обувной магазин</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>На складе вашего магазина находятся <span class="tex-span"><i>n</i></span> пар обуви, каждая пара характеризуется двумя целыми числами: ценой <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> и размером <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span>. Известно, что именно в этот день все числа <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> различны, то есть каждого размера имеется не более одной пары.</p><p>В магазин зашли одновременно <span class="tex-span"><i>m</i></span> покупателей, у покупателя номер <span class="tex-span"><i>i</i></span> при себе <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span> денег, а размер его ноги равен <span class="tex-span"><i>l</i><sub class="lower-index"><i>i</i></sub></span>. Покупатель номер <span class="tex-span"><i>i</i></span> может купить себе пару номер <span class="tex-span"><i>j</i></span>, если <span class="tex-span"><i>c</i><sub class="lower-index"><i>j</i></sub> ≤ <i>d</i><sub class="lower-index"><i>i</i></sub></span>, а также если <span class="tex-span"><i>l</i><sub class="lower-index"><i>i</i></sub> = <i>s</i><sub class="lower-index"><i>j</i></sub></span> или <span class="tex-span"><i>l</i><sub class="lower-index"><i>i</i></sub> = <i>s</i><sub class="lower-index"><i>j</i></sub> - 1</span>; то есть необходимо, чтобы у него было достаточно денег чтобы заплатить, а также размер ноги был в точности равен или на <span class="tex-span">1</span> меньше, чем размер выбранной пары.</p><p>Ваша задача — продать некоторым покупателям по паре обуви так, чтобы максимизировать сумму <span class="tex-span"><i>c</i><sub class="lower-index"><i>j</i></sub></span> проданных пар, то есть прибыль. Гарантируется, что каждый покупатель возьмет не более одной пары, а каждую пару, разумеется, купит не более одного покупателя.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке входных данных записано единственное целое число <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup></span>) — количество пар обуви на складе. Далее в <span class="tex-span"><i>n</i></span> строках записаны описания пар обуви — два целых числа <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> и <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>c</i><sub class="lower-index"><i>i</i></sub>, <i>s</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>), числа разделены пробелом. Гарантируется, что все числа <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> различны.</p><p>В следующей строке записано целое число <span class="tex-span"><i>m</i></span> (<span class="tex-span">1 ≤ <i>m</i> ≤ 10<sup class="upper-index">5</sup></span>) — количество находящихся в магазине покупателей. Далее в <span class="tex-span"><i>m</i></span> строках записаны описания покупателей — два целых числа <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span> и <span class="tex-span"><i>l</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>d</i><sub class="lower-index"><i>i</i></sub>, <i>l</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>), числа разделены пробелом.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>В первой строке выведите единственное целое число — максимальную прибыль, которую вы сможете получить от продажи. Во второй строке выведите целое число <span class="tex-span"><i>k</i></span> — количество пар обуви, которые вы продадите. Далее в <span class="tex-span"><i>k</i></span> строках выведите описания проданных пар — два целых числа через пробел, где первое число означает номер покупателя, а второе — номер обуви, которую этот покупатель приобретет.</p><p>Пары чисел «номер покупателя и номер обуви» можно выводить в любом порядке, покупатели и обувь нумеруются с <span class="tex-span">1</span> в том порядке, в котором они заданы во входных данных. Если существует несколько оптимальных ответов, то разрешается вывести любой.</p><p>Пожалуйста, не используйте спецификатор <span class="tex-font-style-tt">%lld</span> для чтения или записи 64-х битовых чисел на С++, вместо него рекомендуется использовать потоки <span class="tex-font-style-tt">cin</span>, <span class="tex-font-style-tt">cout</span>, а также спецификатор <span class="tex-font-style-tt">%I64d</span>.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>3<br />10 1<br />30 2<br />20 3<br />2<br />20 1<br />20 2<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>30<br />2<br />2 3<br />1 1<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>3<br />10 4<br />20 5<br />30 6<br />2<br />70 4<br />50 5<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>50<br />2<br />2 3<br />1 2<br /></pre></div></div></div></div></div>

