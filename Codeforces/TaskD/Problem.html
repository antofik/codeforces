<div class="problem-statement"><div class="header"><div class="title">D. Дима и бактерии</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Дима стал заниматься биологией бактерий, в результате своих опытов он вывел <span class="tex-span"><i>k</i></span> видов бактерий. Всего сейчас в его лаборатории содержится <span class="tex-span"><i>n</i></span> бактерий, причем количество бактерий вида <span class="tex-span"><i>i</i></span> равно <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span>. Для удобства будем считать, что все бактерии пронумерованы от <span class="tex-span">1</span> до <span class="tex-span"><i>n</i></span>. При этом бактерии вида <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> имеют номера от <img align="middle" class="tex-formula" src="http://espresso.codeforces.com/76151508b8f4173d9b84c7308d62a0980e461b01.png" /> до <img align="middle" class="tex-formula" src="http://espresso.codeforces.com/b968fbc5bc105c2d664950e55bf79e48eb85ff96.png" />.</p><p>С помощью специального оборудования Дима может передавать энергию между некоторыми бактериями. Конечно, пользование таким оборудованием не бесплатно. Дима знает <span class="tex-span"><i>m</i></span> способов передачи энергии с помощью оборудования. Способ с номером <span class="tex-span"><i>i</i></span> характеризуется тремя целыми числами <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub>, <i>u</i><sub class="lower-index"><i>i</i></sub>, <i>x</i><sub class="lower-index"><i>i</i></sub></span> и позволяет за <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> долларов передавать энергию от бактерии с номером <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span> к бактерии с номером <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span> или наоборот.</p><p>Начальник Димы (Инна) считает, что распределение на виды устроено <span class="tex-font-style-it">правильным образом</span>, если существует способ (возможно, использовав оборудование несколько раз) передать энергию от любой бактерии определенного вида другой бактерии этого же вида бесплатно (для любых двух бактерий одного и того же вида). </p><p>Поскольку в таком случае стоимость передачи энергии от любой бактерии к любой другой зависит лишь только от видов этих двух бактерий, помогите Инне определить: образуют ли выведенные Димой бактерии устроенное правильным образом распределение на виды? И если образуют, выведите матрицу <span class="tex-span"><i>d</i></span> размера <span class="tex-span"><i>k</i> × <i>k</i></span>. Ячейка <span class="tex-span"><i>d</i>[<i>i</i>][<i>j</i>]</span> этой матрицы должна обозначать стоимость передачи энергии от бактерии вида <span class="tex-span"><i>i</i></span> к бактерии вида <span class="tex-span"><i>j</i></span>.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке записаны три целых числа <span class="tex-span"><i>n</i>, <i>m</i>, <i>k</i></span> <span class="tex-span">(1 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup>; 0 ≤ <i>m</i> ≤ 10<sup class="upper-index">5</sup>; 1 ≤ <i>k</i> ≤ 500)</span>. В следующей строке записаны <span class="tex-span"><i>k</i></span> целых чисел <span class="tex-span"><i>c</i><sub class="lower-index">1</sub>, <i>c</i><sub class="lower-index">2</sub>, ..., <i>c</i><sub class="lower-index"><i>k</i></sub></span> <span class="tex-span">(1 ≤ <i>c</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>)</span>. В каждой из следующих <span class="tex-span"><i>m</i></span> строк записано три целых числа <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub>, <i>v</i><sub class="lower-index"><i>i</i></sub>, <i>x</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span">(1 ≤ <i>u</i><sub class="lower-index"><i>i</i></sub>, <i>v</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>; 0 ≤ <i>x</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">4</sup>; <i>u</i><sub class="lower-index"><i>i</i></sub> ≠ <i>v</i><sub class="lower-index"><i>i</i></sub>)</span>. Гарантируется, что <img align="middle" class="tex-formula" src="http://espresso.codeforces.com/9753043f470f43c4e33a88332dbad7e115615ad3.png" />.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Если распределение Димы устроено правильным образом, выведите строку «<span class="tex-font-style-tt">Yes</span>», а затем <span class="tex-span"><i>k</i></span> строк: в <span class="tex-span"><i>i</i></span>-й строке выведите целые числа <span class="tex-span"><i>d</i>[<i>i</i>][1], <i>d</i>[<i>i</i>][2], ..., <i>d</i>[<i>i</i>][<i>k</i>]</span> <span class="tex-span">(<i>d</i>[<i>i</i>][<i>i</i>] = 0)</span>. Если нельзя передать энергию бактерии типа <span class="tex-span"><i>j</i></span> от бактерии типа <span class="tex-span"><i>i</i></span> соответствующее значение <span class="tex-span"><i>d</i>[<i>i</i>][<i>j</i>]</span> должно быть равно -1. Если распределение Димы устроено неправильным образом, выведите «<span class="tex-font-style-tt">No</span>».</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>4 4 2<br />1 3<br />2 3 0<br />3 4 0<br />2 4 1<br />2 1 2<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>Yes<br />0 2<br />2 0<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>3 1 2<br />2 1<br />1 2 0<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>Yes<br />0 -1<br />-1 0<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>3 2 2<br />2 1<br />1 2 0<br />2 3 1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>Yes<br />0 1<br />1 0<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>3 0 2<br />1 2<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>No<br /></pre></div></div></div></div></div>
</div>


