<div class="problem-statement"><div class="header"><div class="title">D. Сапер 1D</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>512 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Игра «Сапер 1D» проходит на клетчатой полоске высотой в 1 клетку и шириной в <span class="tex-span"><i>n</i></span> клеток. В некоторых из этих клеток находятся бомбы. Если в клетке бомбы нет, то в ней записано число от 0 до 2 — суммарное количество бомб в соседних клетках.</p><p>Например, корректное поле для игры может выглядеть так: <span class="tex-font-style-tt">001*2***101*</span>. Клетки, которые помечены символом «<span class="tex-font-style-tt">*</span>», содержат бомбы. Обратите внимание, что на корректном поле числа обозначают количество бомб в соседних клетках. Например, поле <span class="tex-font-style-tt">2*</span> — некорректное, потому что у клетки с числом 2 должно быть две соседние клетки с бомбой.</p><p>Валера хочет создать корректное поле для игры в «Сапер 1D». Он уже нарисовал клетчатую полоску шириной в <span class="tex-span"><i>n</i></span> клеток, разместил на поле несколько бомб и записал числа в некоторые клетки. Теперь его интересует, сколько существует способов так заполнить оставшиеся клетки бомбами или числами, чтобы получилось корректное поле.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке записана последовательность символов без пробелов <span class="tex-span"><i>s</i><sub class="lower-index">1</sub><i>s</i><sub class="lower-index">2</sub>... <i>s</i><sub class="lower-index"><i>n</i></sub></span> <span class="tex-span">(1 ≤ <i>n</i> ≤ 10<sup class="upper-index">6</sup>)</span>, содержащая только символы «<span class="tex-font-style-tt">*</span>», «<span class="tex-font-style-tt">?</span>» и цифры «<span class="tex-font-style-tt">0</span>», «<span class="tex-font-style-tt">1</span>» или «<span class="tex-font-style-tt">2</span>». Если символ <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> равен «<span class="tex-font-style-tt">*</span>», то <span class="tex-span"><i>i</i></span>-я клетка поля содержит бомбу. Если символ <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> равен «<span class="tex-font-style-tt">?</span>», значит Валера еще не решил, что будет находиться в <span class="tex-span"><i>i</i></span>-й клетке. Символ <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span>, являющийся цифрой, обозначает цифру, записанную в <span class="tex-span"><i>i</i></span>-й клетке.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите одно число — количество способов, которыми Валера может заполнить свободные клетки, получив при этом корректное поле.</p><p>Так как ответ может быть очень большим, выведите его по модулю <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup> + 7)</span>.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>?01???<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>4<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>?<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>**12<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>0<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>0<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом тестовом примере можно получить следующие корректные поля: <span class="tex-font-style-tt">001**1</span>, <span class="tex-font-style-tt">001***</span>, <span class="tex-font-style-tt">001*2*</span>, <span class="tex-font-style-tt">001*10</span>.</p></div></div></div>
</div>


