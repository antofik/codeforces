<div class="problem-statement"><div class="header"><div class="title">D. Длинный путь</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>1 секунда</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Однажды мальчик Вася оказался в лабиринте, состоящем из <span class="tex-span">(<i>n</i> + 1)</span> комнат, пронумерованных от <span class="tex-span">1</span> до <span class="tex-span">(<i>n</i> + 1)</span>. Первоначально Вася находится в первой комнате, а чтобы выйти из лабиринта, нужно попасть в <span class="tex-span">(<i>n</i> + 1)</span>-ю.</p><p>Лабиринт устроен следующим образом. В каждой комнате лабиринта есть два односторонних портала. Рассмотрим комнату с номером <span class="tex-span"><i>i</i></span> <span class="tex-span">(1 ≤ <i>i</i> ≤ <i>n</i>)</span>, с помощью первого портала можно перейти из нее в комнату с номером <span class="tex-span">(<i>i</i> + 1)</span>, с помощью второго можно перейти из нее в комнату с номером <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span>, где <span class="tex-span">1 ≤ <i>p</i><sub class="lower-index"><i>i</i></sub> ≤ <i>i</i></span>.</p><p>Чтобы не заблудиться Вася решил действовать следующим образом. </p><ul> <li> Каждый раз когда Вася приходит в какую-то комнату он рисует на ее потолке крестик. Изначально, Вася рисует крестик на потолке комнаты <span class="tex-span">1</span>. </li><li> Пусть Вася находится в комнате <span class="tex-span"><i>i</i></span> и уже нарисовал крестик на ее потолке. Тогда, если сейчас на потолке нарисовано нечетное количество крестиков, Вася будет пользоваться вторым порталом (он ведет в комнату <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span>), иначе Вася будет пользоваться первым порталом. </li></ul><p>Помогите Васе определить, сколько раз ему придется воспользоваться порталами, чтобы попасть в комнату <span class="tex-span">(<i>n</i> + 1)</span> в конечном итоге.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке записано целое число <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">3</sup></span>) — число комнат. Во второй строке записаны <span class="tex-span"><i>n</i></span> целых чисел <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>p</i><sub class="lower-index"><i>i</i></sub> ≤ <i>i</i></span>) — номера комнат, в которые можно попасть из <span class="tex-span"><i>i</i></span>-й комнаты, если пользоваться вторым порталом.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите одно число — количество перемещений, за которое мальчик выберется из лабиринта. Поскольку это число может быть достаточно большим, выведите его по модулю <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup> + 7)</span>.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>2<br />1 2<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>4<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>4<br />1 1 2 3<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>20<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>5<br />1 1 1 1 1<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>62<br /></pre></div></div></div></div></div>
</div>


