<div class="problem-statement"><div class="header"><div class="title">D. Улучшаем массив</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>1 секунда</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>У вас есть массив целых положительных чисел <span class="tex-span"><i>a</i>[1], <i>a</i>[2], ..., <i>a</i>[<i>n</i>]</span>, а также множество <span class="tex-font-style-it">плохих</span> простых чисел <span class="tex-span"><i>b</i><sub class="lower-index">1</sub>, <i>b</i><sub class="lower-index">2</sub>, ..., <i>b</i><sub class="lower-index"><i>m</i></sub></span>. Простые числа, которые не встречаются в множестве <span class="tex-span"><i>b</i></span> считаются <span class="tex-font-style-it">хорошими</span>. <span class="tex-font-style-it">Красотой</span> массива <span class="tex-span"><i>a</i></span> назовем сумму <img align="middle" class="tex-formula" src="http://espresso.codeforces.com/3ec4eb3a18f082a748790ff23ddfd407dc47c7b5.png" />, где функция <span class="tex-span"><i>f</i>(<i>s</i>)</span> определяется следующим образом:</p><ul> <li> <span class="tex-span"><i>f</i>(1) = 0</span>; </li><li> Пусть <span class="tex-span"><i>p</i></span> — минимальный простой делитель числа <span class="tex-span"><i>s</i></span>. Если <span class="tex-span"><i>p</i></span> — хорошее простое число, то <img align="middle" class="tex-formula" src="http://espresso.codeforces.com/7383602a27559366ac7e835d8ea9438606181bc1.png" />, иначе <img align="middle" class="tex-formula" src="http://espresso.codeforces.com/df821fc52071527088ffb5f43a78ce80484653b1.png" />. </li></ul><p>Вам разрешено последовательно провести произвольное (возможно, ноль) количество операций улучшения массива <span class="tex-span"><i>a</i></span>. <span class="tex-font-style-it">Операцией улучшения</span> назовем следующую последовательность действий:</p><ul> <li> Выбрать некоторое число <span class="tex-span"><i>r</i></span> (<span class="tex-span">1 ≤ <i>r</i> ≤ <i>n</i></span>) и подсчитать значение <span class="tex-span"><i>g</i></span> = НОД(<span class="tex-span"><i>a</i>[1], <i>a</i>[2], ..., <i>a</i>[<i>r</i>]</span>). </li><li> Выполнить присвоения: <img align="middle" class="tex-formula" src="http://espresso.codeforces.com/ef75456792db1b98467dc44dec6265e29293d33f.png" />, <img align="middle" class="tex-formula" src="http://espresso.codeforces.com/c17f8b4c611a4c28030b31b22768d0797951ed21.png" />, <span class="tex-span">...</span>, <img align="middle" class="tex-formula" src="http://espresso.codeforces.com/27eb58c5668d24bcb101f0277b28137ad226f917.png" />. </li></ul><p>Какую максимальную красоту массива вы сможете получить? </p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке заданы два целых числа <span class="tex-span"><i>n</i></span> и <span class="tex-span"><i>m</i></span> (<span class="tex-span">1 ≤ <i>n</i>, <i>m</i> ≤ 5000</span>) — количество чисел в массиве <span class="tex-span"><i>a</i></span> и количество плохих простых чисел.</p><p>Во второй строке заданы <span class="tex-span"><i>n</i></span> целых чисел через пробел <span class="tex-span"><i>a</i>[1], <i>a</i>[2], ..., <i>a</i>[<i>n</i>]</span> (<span class="tex-span">1 ≤ <i>a</i>[<i>i</i>] ≤ 10<sup class="upper-index">9</sup></span>) — массив <span class="tex-span"><i>a</i></span>. В третьей строке заданы <span class="tex-span"><i>m</i></span> целых чисел через пробел <span class="tex-span"><i>b</i><sub class="lower-index">1</sub>, <i>b</i><sub class="lower-index">2</sub>, ..., <i>b</i><sub class="lower-index"><i>m</i></sub></span> (<span class="tex-span">2 ≤ <i>b</i><sub class="lower-index">1</sub> &lt; <i>b</i><sub class="lower-index">2</sub> &lt; ... &lt; <i>b</i><sub class="lower-index"><i>m</i></sub> ≤ 10<sup class="upper-index">9</sup></span>) — множество плохих простых чисел.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите единственное целое число — ответ на задачу.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>5 2<br />4 20 34 10 10<br />2 5<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>-2<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>4 5<br />2 4 8 16<br />3 5 7 11 17<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>10<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>Обратите внимание, что ответ на задачу может быть отрицательным числом.</p><p>НОД(<span class="tex-span"><i>x</i><sub class="lower-index">1</sub></span>, <span class="tex-span"><i>x</i><sub class="lower-index">2</sub></span>, ..., <span class="tex-span"><i>x</i><sub class="lower-index"><i>k</i></sub></span>) обозначает наибольшее целое положительное число, которое делит каждое <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> без остатка.</p></div></div></div>
</div>


