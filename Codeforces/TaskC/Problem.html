<div class="problem-statement"><div class="header"><div class="title">C. Абракадабра</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>3 seconds</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 megabytes</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Поликарп исследует строку, которую он называет <span class="tex-font-style-it">абракадабра</span>. Эта строка строится по следующему алгоритму: </p><ul> <li> На первом шаге строка состоит из одного символа «<span class="tex-font-style-tt">a</span>». </li><li> На <span class="tex-span"><i>k</i></span>-oм шаге Поликарп соединяет две копии строки, полученной на <span class="tex-span"><i>k</i> - 1</span> шаге, а между ними вставляет <span class="tex-span"><i>k</i></span>-й символ алфавита. Поликарп использует алфавит, состоящий из строчных латинских букв и цифр (всего 36 символов). Символы алфавита нумеруются следующим образом: 1-й символ — «<span class="tex-font-style-tt">a</span>», 2-й — «<span class="tex-font-style-tt">b</span>», ..., 26-й — «<span class="tex-font-style-tt">z</span>», 27-й — «<span class="tex-font-style-tt">0</span>», 28-й — «<span class="tex-font-style-tt">1</span>», ..., 36-й — «<span class="tex-font-style-tt">9</span>». </li></ul><p>Рассмотрим алгоритм подробнее. На втором шаге Поликарп соединит две строки «<span class="tex-font-style-tt">a</span>», вставив посередине символ «<span class="tex-font-style-tt">b</span>», и получит строку «<span class="tex-font-style-tt">aba</span>». На третьем шаге получится строка «<span class="tex-font-style-tt">abacaba</span>», а на четвертом — «<span class="tex-font-style-tt">abacabadabacaba</span>». Таким образом, строка, полученная на <span class="tex-span"><i>k</i></span>-ом шаге, будет состоять из <span class="tex-span">2<sup class="upper-index"><i>k</i></sup> - 1</span> символов. </p><p>Поликарп записал строку, полученную после 30 шагов данного алгоритма, и выбрал из нее две непустые подстроки. Ваша задача состоит в том, чтобы найти длину наибольшей общей подстроки двух подстрок, выбранных Поликарпом.</p><p>Подстрокой <span class="tex-span"><i>s</i>[<i>i</i>... <i>j</i>]</span> (<span class="tex-span">1 ≤ <i>i</i> ≤ <i>j</i> ≤ |<i>s</i>|</span>) строки <span class="tex-span"><i>s</i></span> = <span class="tex-span"><i>s</i><sub class="lower-index">1</sub><i>s</i><sub class="lower-index">2</sub>... <i>s</i><sub class="lower-index">|<i>s</i>|</sub></span> называется строка, равная <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub><i>s</i><sub class="lower-index"><i>i</i> + 1</sub>... <i>s</i><sub class="lower-index"><i>j</i></sub></span>. Например, подстрока <span class="tex-span"><i>s</i>[2...4]</span> строки <span class="tex-span"><i>s</i></span> = «<span class="tex-font-style-tt">abacaba</span>» равна «<span class="tex-font-style-tt">bac</span>». Сама строка является своей подстрокой.</p><p>Наибольшей общей подстрокой двух строк <span class="tex-span"><i>s</i></span> и <span class="tex-span"><i>t</i></span> называется самая длинная строка, которая является подстрокой как <span class="tex-span"><i>s</i></span>, так и <span class="tex-span"><i>t</i></span>. Например, наибольшей общей подстрокой «<span class="tex-font-style-tt">contest</span>» и «<span class="tex-font-style-tt">systemtesting</span>» является строка «<span class="tex-font-style-tt">test</span>». Общих подстрок наибольшей длины может существовать несколько.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>Входные данные состоят из одной строки, которая содержит четыре целых числа <span class="tex-span"><i>l</i><sub class="lower-index">1</sub></span>, <span class="tex-span"><i>r</i><sub class="lower-index">1</sub></span>, <span class="tex-span"><i>l</i><sub class="lower-index">2</sub></span>, <span class="tex-span"><i>r</i><sub class="lower-index">2</sub></span> (<span class="tex-span">1 ≤ <i>l</i><sub class="lower-index"><i>i</i></sub> ≤ <i>r</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>, <span class="tex-span"><i>i</i> = 1, 2</span>). Числа разделены единичными пробелами. Значения <span class="tex-span"><i>l</i><sub class="lower-index"><i>i</i></sub></span> и <span class="tex-span"><i>r</i><sub class="lower-index"><i>i</i></sub></span> задают индексы первого и последнего символов <span class="tex-span"><i>i</i></span>-ой выбранной подстроки, соответственно (<span class="tex-span"><i>i</i> = 1, 2</span>). Символы строки <span class="tex-font-style-it">абракадабра</span> нумеруются с <span class="tex-span">1</span>.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите единственное число — длину наибольшей общей подстроки заданных подстрок. Если общих подстрок нет, выведите 0.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>3 6 1 4<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2<br /></pre></div><div class="input"><div class="title">Входные данные</div><pre>1 1 4 4<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>0<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом тесте первая подстрока равна «<span class="tex-font-style-tt">acab</span>», вторая — «<span class="tex-font-style-tt">abac</span>». У этих двух подстрок есть две наибольшие общие подстроки «<span class="tex-font-style-tt">ac</span>» и «<span class="tex-font-style-tt">ab</span>», нас же интересует только их длина — 2.</p><p>Во втором тесте первая подстрока равна «<span class="tex-font-style-tt">a</span>», вторая — «<span class="tex-font-style-tt">c</span>». У этих двух подстрок нет ни одного общего символа, поэтому длина наибольшей общей подстроки — 0.</p></div></div></div>
</div>


