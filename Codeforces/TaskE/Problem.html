<div class="problem-statement"><div class="header"><div class="title">E. О меняющемся дереве</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Дано корневое дерево, состоящее из <span class="tex-span"><i>n</i></span> вершин, пронумерованных от <span class="tex-span">1</span> до <span class="tex-span"><i>n</i></span>. Корень дерева находится в вершине с номером <span class="tex-span">1</span>.</p><p>Изначально во всех вершинах записано число <span class="tex-span">0</span>. Далее приходят <span class="tex-span"><i>q</i></span> запросов, каждый из которых имеет один из следующих двух видов:</p><ul> <li> Формат запроса: <span class="tex-span">1</span> <span class="tex-span"><i>v</i></span> <span class="tex-span"><i>x</i></span> <span class="tex-span"><i>k</i></span>. В ответ на запрос нужно к числу, записанному в вершине <span class="tex-span"><i>v</i></span>, добавить <span class="tex-span"><i>x</i></span>; к числам, записанным в потомках вершины <span class="tex-span"><i>v</i></span> на расстоянии <span class="tex-span">1</span>, добавить <span class="tex-span"><i>x</i> - <i>k</i></span>; и так далее, к числам, записанным в <span class="tex-font-style-bf">потомках</span> на расстоянии <span class="tex-span"><i>i</i></span>, нужно добавить <span class="tex-span"><i>x</i> - (<i>i</i>·<i>k</i>)</span>. Расстоянием между двумя вершинами считается длина кратчайшего по количеству ребер пути между этими вершинами. </li><li> Формат запроса: <span class="tex-span">2</span> <span class="tex-span"><i>v</i></span>. В ответ на запрос требуется вывести, какое число сейчас записано в вершине <span class="tex-span"><i>v</i></span> по модулю <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup> + 7)</span>. </li></ul><p>Выполните заданные во входных данных запросы.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке задано целое число <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 3·10<sup class="upper-index">5</sup></span>) — количество вершин в дереве. Во второй строке задано <span class="tex-span"><i>n</i> - 1</span> целое число <span class="tex-span"><i>p</i><sub class="lower-index">2</sub>, <i>p</i><sub class="lower-index">3</sub>, ... <i>p</i><sub class="lower-index"><i>n</i></sub></span> (<span class="tex-span">1 ≤ <i>p</i><sub class="lower-index"><i>i</i></sub> &lt; <i>i</i></span>), где <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span> — это номер вершины, являющейся предком вершины <span class="tex-span"><i>i</i></span> в дереве.</p><p>В третьей строке записано целое число <span class="tex-span"><i>q</i></span> (<span class="tex-span">1 ≤ <i>q</i> ≤ 3·10<sup class="upper-index">5</sup></span>) — количество запросов. В следующих <span class="tex-span"><i>q</i></span> строках заданы запросы, по одному на строке. Первое число в строке <span class="tex-span"><i>type</i></span> означает тип запроса. Если <span class="tex-span"><i>type</i> = 1</span>, то далее заданы целые числа <span class="tex-span"><i>v</i>, <i>x</i>, <i>k</i></span> (<span class="tex-span">1 ≤ <i>v</i> ≤ <i>n</i></span>; <span class="tex-span">0 ≤ <i>x</i> &lt; 10<sup class="upper-index">9</sup> + 7</span>; <span class="tex-span">0 ≤ <i>k</i> &lt; 10<sup class="upper-index">9</sup> + 7</span>) через пробел. Если <span class="tex-span"><i>type</i> = 2</span>, то далее задано целое число <span class="tex-span"><i>v</i></span> (<span class="tex-span">1 ≤ <i>v</i> ≤ <i>n</i></span>) — вершина, в которой нужно узнать значение числа.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Для каждого запроса второго типа на отдельной строке выведите число, записанное в вершине, обозначенной в запросе, по модулю <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup> + 7)</span>.</p></div><div class="sample-tests"><div class="section-title">Примеры тестов</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>3<br />1 1<br />3<br />1 1 2 1<br />2 1<br />2 2<br /></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2<br />1<br /></pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>О корневом дереве можно прочитать здесь: <span class="tex-font-style-tt">http://ru.wikipedia.org/wiki/Дерево_(теория_графов)</span>.</p></div></div></div>
</div>


